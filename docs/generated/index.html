<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="LexOrbital Core Team" />
  <title>LexOrbital Core Guide</title>
  <style>
  </style>
  <style>
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="docs/templates/pandoc.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>

<div class="lexorbital-header">
  <div class="logo">
    <svg width="40" height="40" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
      <!-- Meta-Kernel (centre) -->
      <circle cx="50" cy="50" r="8" fill="#2563eb" />
      <!-- Anneau 1 -->
      <circle cx="50" cy="50" r="20" fill="none" stroke="#3b82f6" stroke-width="1" opacity="0.5" />
      <!-- Anneau 2 -->
      <circle cx="50" cy="50" r="32" fill="none" stroke="#3b82f6" stroke-width="1" opacity="0.4" />
      <!-- Anneau 3 -->
      <circle cx="50" cy="50" r="44" fill="none" stroke="#3b82f6" stroke-width="1" opacity="0.3" />
      <!-- Modules (points sur les anneaux) -->
      <circle cx="50" cy="30" r="3" fill="#10b981" />
      <circle cx="70" cy="50" r="3" fill="#10b981" />
      <circle cx="50" cy="70" r="3" fill="#10b981" />
      <circle cx="30" cy="50" r="3" fill="#10b981" />
    </svg>
  </div>
  <div class="title-block">
        <h1 class="title">LexOrbital Core Guide</h1>
            <p class="subtitle">Complete guide for module
development</p>
            <p class="author">
      LexOrbital Core Team
    </p>
            <p class="date">23 novembre 2025</p>
      </div>
</div>

<nav id="TOC" role="doc-toc" class="toc">
<ul>
<li><a href="#guide-lexorbital" id="toc-guide-lexorbital">Guide
LexOrbital</a>
<ul>
<li><a href="#table-des-matiÃ¨res" id="toc-table-des-matiÃ¨res">Table des
matiÃ¨res</a></li>
<li><a href="#prÃ©sentation" id="toc-prÃ©sentation">PrÃ©sentation</a></li>
<li><a href="#organisation-de-la-documentation"
id="toc-organisation-de-la-documentation">Organisation de la
documentation</a></li>
<li><a href="#usage-avec-pandoc" id="toc-usage-avec-pandoc">Usage avec
Pandoc</a></li>
<li><a href="#contribuer-Ã -la-documentation"
id="toc-contribuer-Ã -la-documentation">Contribuer Ã  la
documentation</a></li>
<li><a href="#ressources-externes"
id="toc-ressources-externes">Ressources externes</a></li>
<li><a href="#licence" id="toc-licence">Licence</a></li>
<li><a href="#support" id="toc-support">Support</a></li>
</ul></li>
<li><a href="#sommaire-de-la-documentation-lexorbital"
id="toc-sommaire-de-la-documentation-lexorbital">ğŸ“š Sommaire de la
Documentation LexOrbital</a>
<ul>
<li><a href="#vue-densemble" id="toc-vue-densemble">ğŸ¯ Vue
dâ€™ensemble</a></li>
<li><a href="#fiches-techniques" id="toc-fiches-techniques">ğŸ“– Fiches
techniques</a></li>
<li><a href="#organisation-du-dÃ©pÃ´t-docs"
id="toc-organisation-du-dÃ©pÃ´t-docs">ğŸ—‚ï¸ Organisation du dÃ©pÃ´t
<code>docs/</code></a></li>
<li><a href="#thÃ¨me-visuel" id="toc-thÃ¨me-visuel">ğŸ¨ ThÃ¨me
visuel</a></li>
<li><a href="#mÃ©triques" id="toc-mÃ©triques">ğŸ“Š MÃ©triques</a></li>
<li><a href="#parcours-de-lecture-recommandÃ©s"
id="toc-parcours-de-lecture-recommandÃ©s">ğŸ”— Parcours de lecture
recommandÃ©s</a></li>
<li><a href="#commandes-rapides" id="toc-commandes-rapides">ğŸš€ Commandes
rapides</a></li>
<li><a href="#ressources-complÃ©mentaires"
id="toc-ressources-complÃ©mentaires">ğŸ“š Ressources
complÃ©mentaires</a></li>
<li><a href="#checklist-de-lecture" id="toc-checklist-de-lecture">âœ…
Checklist de lecture</a></li>
</ul></li>
<li><a href="#fiche-0-lexorbital-vue-densemble"
id="toc-fiche-0-lexorbital-vue-densemble">Fiche nÂ°0 : LexOrbital â€“ Vue
dâ€™ensemble</a>
<ul>
<li><a href="#objectif-de-la-fiche" id="toc-objectif-de-la-fiche">1.
Objectif de la fiche</a></li>
<li><a href="#contexte-et-origine" id="toc-contexte-et-origine">2.
Contexte et origine</a></li>
<li><a href="#points-clÃ©s" id="toc-points-clÃ©s">3. Points clÃ©s</a></li>
<li><a href="#roadmap" id="toc-roadmap">4. Roadmap</a></li>
<li><a href="#Ã -retenir-checklist" id="toc-Ã -retenir-checklist">5. Ã€
retenir / Checklist</a></li>
<li><a href="#liens-connexes" id="toc-liens-connexes">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-1-architecture-orbitale"
id="toc-fiche-1-architecture-orbitale">Fiche nÂ°1 : Architecture orbitale
(Meta-Kernel, anneaux, modules)</a>
<ul>
<li><a href="#objectif-de-la-fiche-1" id="toc-objectif-de-la-fiche-1">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s"
id="toc-concepts-et-dÃ©cisions-clÃ©s">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques"
id="toc-implications-techniques">3. Implications techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre"
id="toc-checklist-de-mise-en-Å“uvre">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#liens-connexes-1" id="toc-liens-connexes-1">5. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-2-microservices-vs-modules"
id="toc-fiche-2-microservices-vs-modules">Fiche nÂ°2 : Microservices vs
modules plugâ€™nâ€™play</a>
<ul>
<li><a href="#objectif-de-la-fiche-2" id="toc-objectif-de-la-fiche-2">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-1"
id="toc-concepts-et-dÃ©cisions-clÃ©s-1">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques-1"
id="toc-implications-techniques-1">3. Implications techniques</a></li>
<li><a href="#checklist-de-dÃ©cision" id="toc-checklist-de-dÃ©cision">4.
Checklist de dÃ©cision</a></li>
<li><a href="#Ã -retenir" id="toc-Ã -retenir">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-2" id="toc-liens-connexes-2">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-3-documentation-et-diagrammes-vivants"
id="toc-fiche-3-documentation-et-diagrammes-vivants">Fiche nÂ°3 :
Documentation &amp; diagrammes vivants</a>
<ul>
<li><a href="#objectif-de-la-fiche-3" id="toc-objectif-de-la-fiche-3">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-2"
id="toc-concepts-et-dÃ©cisions-clÃ©s-2">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques-2"
id="toc-implications-techniques-2">3. Implications techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-1"
id="toc-checklist-de-mise-en-Å“uvre-1">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-1" id="toc-Ã -retenir-1">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-3" id="toc-liens-connexes-3">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-4-manifestes-lexorbital"
id="toc-fiche-4-manifestes-lexorbital">Fiche nÂ°4 : Manifestes LexOrbital
(module.json, rgpd-manifest.json)</a>
<ul>
<li><a href="#objectif-de-la-fiche-4" id="toc-objectif-de-la-fiche-4">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-3"
id="toc-concepts-et-dÃ©cisions-clÃ©s-3">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques-3"
id="toc-implications-techniques-3">3. Implications techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-2"
id="toc-checklist-de-mise-en-Å“uvre-2">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-2" id="toc-Ã -retenir-2">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-4" id="toc-liens-connexes-4">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-5-rgpd-by-design"
id="toc-fiche-5-rgpd-by-design">Fiche nÂ°5 : RGPD by design â€“ patterns
techniques</a>
<ul>
<li><a href="#objectif-de-la-fiche-5" id="toc-objectif-de-la-fiche-5">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-4"
id="toc-concepts-et-dÃ©cisions-clÃ©s-4">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#patterns-techniques" id="toc-patterns-techniques">3.
Patterns techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-3"
id="toc-checklist-de-mise-en-Å“uvre-3">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-3" id="toc-Ã -retenir-3">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-5" id="toc-liens-connexes-5">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-6-template-module"
id="toc-fiche-6-template-module">Fiche nÂ°6 : Template module (Husky,
commits, SemVer)</a>
<ul>
<li><a href="#objectif-de-la-fiche-6" id="toc-objectif-de-la-fiche-6">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-5"
id="toc-concepts-et-dÃ©cisions-clÃ©s-5">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques-4"
id="toc-implications-techniques-4">3. Implications techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-4"
id="toc-checklist-de-mise-en-Å“uvre-4">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-4" id="toc-Ã -retenir-4">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-6" id="toc-liens-connexes-6">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-7-workflow-subtree"
id="toc-fiche-7-workflow-subtree">Fiche nÂ°7 : Workflow git subtree &amp;
scripts dâ€™amarrage</a>
<ul>
<li><a href="#objectif-de-la-fiche-7" id="toc-objectif-de-la-fiche-7">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-6"
id="toc-concepts-et-dÃ©cisions-clÃ©s-6">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques-5"
id="toc-implications-techniques-5">3. Implications techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-5"
id="toc-checklist-de-mise-en-Å“uvre-5">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-5" id="toc-Ã -retenir-5">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-7" id="toc-liens-connexes-7">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-8-modules-types"
id="toc-fiche-8-modules-types">Fiche nÂ°8 : Modules types (auth, audit,
CI, infraâ€¦)</a>
<ul>
<li><a href="#objectif-de-la-fiche-8" id="toc-objectif-de-la-fiche-8">1.
Objectif de la fiche</a></li>
<li><a href="#modules-par-anneau-orbital"
id="toc-modules-par-anneau-orbital">2. Modules par anneau
orbital</a></li>
<li><a href="#matrice-de-dÃ©pendances" id="toc-matrice-de-dÃ©pendances">3.
Matrice de dÃ©pendances</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-6"
id="toc-checklist-de-mise-en-Å“uvre-6">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-6" id="toc-Ã -retenir-6">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-8" id="toc-liens-connexes-8">6. Liens
connexes</a></li>
</ul></li>
<li><a href="#fiche-9-console-de-controle"
id="toc-fiche-9-console-de-controle">Fiche nÂ°9 : Console de contrÃ´le
&amp; design diÃ©gÃ©tique</a>
<ul>
<li><a href="#objectif-de-la-fiche-9" id="toc-objectif-de-la-fiche-9">1.
Objectif de la fiche</a></li>
<li><a href="#concepts-et-dÃ©cisions-clÃ©s-7"
id="toc-concepts-et-dÃ©cisions-clÃ©s-7">2. Concepts et dÃ©cisions
clÃ©s</a></li>
<li><a href="#implications-techniques-6"
id="toc-implications-techniques-6">3. Implications techniques</a></li>
<li><a href="#checklist-de-mise-en-Å“uvre-7"
id="toc-checklist-de-mise-en-Å“uvre-7">4. Checklist de mise en
Å“uvre</a></li>
<li><a href="#Ã -retenir-7" id="toc-Ã -retenir-7">5. Ã€ retenir</a></li>
<li><a href="#liens-connexes-9" id="toc-liens-connexes-9">6. Liens
connexes</a></li>
</ul></li>
</ul>
</nav>

<main class="content">
<h1 id="guide-lexorbital">Guide LexOrbital</h1>
<blockquote>
<p>Guide dâ€™architecture de la station orbitale LexOrbital : Meta-Kernel,
anneaux, modules, conformitÃ© RGPD et outillage.</p>
</blockquote>
<h2 id="table-des-matiÃ¨res">Table des matiÃ¨res</h2>
<ol start="0" type="1">
<li><a href="#fiche-0-lexorbital-vue-densemble">LexOrbital â€“ Vue
dâ€™ensemble</a></li>
<li><a href="#fiche-1-architecture-orbitale">Architecture orbitale
(Meta-Kernel, anneaux, modules)</a></li>
<li><a href="#fiche-2-microservices-vs-modules">Microservices vs modules
plugâ€™nâ€™play</a></li>
<li><a href="#fiche-3-documentation-et-diagrammes-vivants">Documentation
&amp; diagrammes vivants</a></li>
<li><a href="#fiche-4-manifestes-lexorbital">Manifestes LexOrbital
(module.json, rgpd-manifest.json)</a></li>
<li><a href="#fiche-5-rgpd-by-design">RGPD by design â€“ patterns
techniques</a></li>
<li><a href="#fiche-6-template-module">Template module (Husky, commits,
SemVer)</a></li>
<li><a href="#fiche-7-workflow-subtree">Workflow git subtree &amp;
scripts dâ€™amarrage</a></li>
<li><a href="#fiche-8-modules-types">Modules types (auth, audit, CI,
infraâ€¦)</a></li>
<li><a href="#fiche-9-console-de-controle">Console de contrÃ´le &amp;
design diÃ©gÃ©tique</a></li>
</ol>
<hr />
<h2 id="prÃ©sentation">PrÃ©sentation</h2>
<p><strong>LexOrbital</strong> est une station orbitale dâ€™architecture
logicielle modulaire conÃ§ue pour orchestrer des systÃ¨mes juridiques et
mÃ©tiers complexes. PlutÃ´t que de multiplier les microservices autonomes,
LexOrbital propose une architecture en <strong>anneaux orbitaux</strong>
:</p>
<ul>
<li>ğŸŒ <strong>Anneau 0 (Meta-Kernel)</strong> : Orchestration centrale,
configuration, health checks</li>
<li>ğŸ” <strong>Anneau 1 (Core Services)</strong> : Auth, Audit, Logs,
Notifications (services transverses)</li>
<li>ğŸ’¼ <strong>Anneau 2 (Business Logic)</strong> : Dossiers, Documents,
Workflow, Facturation (mÃ©tier)</li>
<li>ğŸ”Œ <strong>Anneau 3 (IntÃ©grations)</strong> : API Gateway, Webhooks,
Export, Search (externe)</li>
</ul>
<p>Chaque module sâ€™amarre dynamiquement Ã  la station via des manifestes
dÃ©claratifs (<code>lexorbital.module.json</code> +
<code>rgpd-manifest.json</code>), permettant une conformitÃ© RGPD native
et une traÃ§abilitÃ© complÃ¨te.</p>
<hr />
<h2 id="organisation-de-la-documentation">Organisation de la
documentation</h2>
<h3 id="fiches-techniques-0009">Fiches techniques (00â€“09)</h3>
<p>Les <strong>10 fiches numÃ©rotÃ©es</strong> constituent le cÅ“ur de la
documentation technique :</p>
<table>
<colgroup>
<col style="width: 30%" />
<col style="width: 30%" />
<col style="width: 39%" />
</colgroup>
<thead>
<tr>
<th>Fiche</th>
<th>Titre</th>
<th>Contenu</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>00</strong></td>
<td>Vue dâ€™ensemble</td>
<td>Vision, contexte, roadmap LexOrbital</td>
</tr>
<tr>
<td><strong>01</strong></td>
<td>Architecture orbitale</td>
<td>Meta-Kernel, anneaux, communication inter-modules</td>
</tr>
<tr>
<td><strong>02</strong></td>
<td>Microservices vs modules</td>
<td>Comparaison architecturale, choix techniques</td>
</tr>
<tr>
<td><strong>03</strong></td>
<td>Documentation vivante</td>
<td>GÃ©nÃ©ration automatique (Pandoc, Mermaid, Swagger)</td>
</tr>
<tr>
<td><strong>04</strong></td>
<td>Manifestes LexOrbital</td>
<td>Format JSON des manifestes techniques et RGPD</td>
</tr>
<tr>
<td><strong>05</strong></td>
<td>RGPD by design</td>
<td>Patterns techniques (audit, anonymisation, DSAR)</td>
</tr>
<tr>
<td><strong>06</strong></td>
<td>Template module</td>
<td>Structure standard, Husky, Conventional Commits</td>
</tr>
<tr>
<td><strong>07</strong></td>
<td>Workflow subtree</td>
<td>Git subtree pour amarrage de modules externes</td>
</tr>
<tr>
<td><strong>08</strong></td>
<td>Modules types</td>
<td>Catalogue des modules par anneau</td>
</tr>
<tr>
<td><strong>09</strong></td>
<td>Console de contrÃ´le</td>
<td>Design diÃ©gÃ©tique, interface 3D (Three.js)</td>
</tr>
</tbody>
</table>
<h3 id="guides-pratiques-guides">Guides pratiques
(<code>guides/</code>)</h3>
<ul>
<li><strong>Getting Started</strong> : Installation et premier
lancement</li>
<li><strong>GÃ©nÃ©rer la documentation</strong> : Utilisation de Pandoc et
des scripts</li>
<li><strong>CrÃ©er un module</strong> : Step-by-step avec le
template</li>
</ul>
<h3 id="rÃ©fÃ©rences-lÃ©gales-legal">RÃ©fÃ©rences lÃ©gales
(<code>legal/</code>)</h3>
<ul>
<li><strong>Sources RGPD</strong> : Articles du RGPD citÃ©s dans le
projet</li>
<li><strong>Licences</strong> : Licences des dÃ©pendances tierces</li>
</ul>
<hr />
<h2 id="usage-avec-pandoc">Usage avec Pandoc</h2>
<h3 id="gÃ©nÃ©rer-un-fichier-docx">GÃ©nÃ©rer un fichier DOCX</h3>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> docs</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="at">--toc-depth</span><span class="op">=</span>2 <span class="dt">\</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> LexOrbital_Guide.docx <span class="dt">\</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span></code></pre></div>
<h3 id="gÃ©nÃ©rer-un-fichier-html">GÃ©nÃ©rer un fichier HTML</h3>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> docs</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="at">--toc-depth</span><span class="op">=</span>2 <span class="dt">\</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">--template</span><span class="op">=</span><span class="st">&quot;templates/lexorbital.html&quot;</span> <span class="dt">\</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">--css</span><span class="op">=</span><span class="st">&quot;templates/pandoc.css&quot;</span> <span class="dt">\</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> LexOrbital_Guide.html <span class="dt">\</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  README.md <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span></code></pre></div>
<h3 id="gÃ©nÃ©rer-un-fichier-pdf-via-latex">GÃ©nÃ©rer un fichier PDF (via
LaTeX)</h3>
<div class="sourceCode" id="cb3"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> docs</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="at">--toc-depth</span><span class="op">=</span>2 <span class="dt">\</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">--pdf-engine</span><span class="op">=</span>xelatex <span class="dt">\</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">-V</span> geometry:margin=1in <span class="dt">\</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">-V</span> documentclass=report <span class="dt">\</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">-V</span> colorlinks=true <span class="dt">\</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> LexOrbital_Guide.pdf <span class="dt">\</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span></code></pre></div>
<blockquote>
<p><strong>Note</strong> : NÃ©cessite une installation LaTeX (TeX Live,
MiKTeX, etc.)</p>
</blockquote>
<h3 id="gÃ©nÃ©rer-tous-les-formats-script-automatique">GÃ©nÃ©rer tous les
formats (script automatique)</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> scripts</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./generate-docs.sh</span></span></code></pre></div>
<p>GÃ©nÃ¨re automatiquement : -
<code>docs/generated/LexOrbital_Guide.html</code> -
<code>docs/generated/LexOrbital_Guide.pdf</code> -
<code>docs/generated/LexOrbital_Guide.docx</code> - Diagrammes Mermaid
(SVG) - Registre RGPD (JSON + PDF)</p>
<hr />
<h2 id="contribuer-Ã -la-documentation">Contribuer Ã  la
documentation</h2>
<h3 id="ajouter-une-nouvelle-fiche">Ajouter une nouvelle fiche</h3>
<ol type="1">
<li>CrÃ©er un fichier <code>docs/NN_titre-fiche.md</code> (NN = numÃ©ro Ã 
2 chiffres)</li>
<li>Utiliser le template dâ€™en-tÃªte :</li>
</ol>
<div class="sourceCode" id="cb5"><pre
class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Fiche nÂ°N : Titre de la fiche {#fiche-N-titre}</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; RÃ©sumÃ© en 2-3 phrases.</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1. Objectif de la fiche</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Concepts et dÃ©cisions clÃ©s</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Implications techniques</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Checklist de mise en Å“uvre</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Ã€ retenir</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Liens connexes</span></span></code></pre></div>
<ol start="3" type="1">
<li>Ajouter une entrÃ©e dans la table des matiÃ¨res du
<code>README.md</code></li>
<li>RÃ©gÃ©nÃ©rer la doc : <code>./scripts/generate-docs.sh</code></li>
</ol>
<h3 id="mettre-Ã -jour-une-fiche-existante">Mettre Ã  jour une fiche
existante</h3>
<ol type="1">
<li>Ã‰diter le fichier <code>docs/NN_*.md</code> concernÃ©</li>
<li>Respecter la structure (sections numÃ©rotÃ©es, IDs explicites)</li>
<li>Commit avec Conventional Commits :
<code>docs(fiche-N): description</code></li>
<li>RÃ©gÃ©nÃ©rer la doc automatiquement (CI/CD GitHub Actions)</li>
</ol>
<h3 id="conventions-dÃ©criture">Conventions dâ€™Ã©criture</h3>
<ul>
<li><strong>IDs explicites</strong> : <code>{#fiche-N-titre}</code> pour
ancres stables</li>
<li><strong>Liens internes</strong> : <code>[[NN_autre-fiche]]</code>
(format Obsidian)</li>
<li><strong>Code blocks</strong> : utiliser les triple backticks avec
langage (```typescript)</li>
<li><strong>Diagrammes</strong> : utiliser Mermaid ou D2 (gÃ©nÃ©ration
automatique)</li>
<li><strong>Emphase</strong> : <code>**gras**</code> pour concepts
importants, <code>*italique*</code> pour nuances</li>
</ul>
<hr />
<h2 id="ressources-externes">Ressources externes</h2>
<ul>
<li><a href="https://docs.nestjs.com/">Documentation NestJS</a> -
Framework backend</li>
<li><a href="https://docs.pmnd.rs/react-three-fiber/">React Three
Fiber</a> - Rendu 3D de la console</li>
<li><a href="https://pandoc.org/MANUAL.html">Pandoc Manual</a> -
GÃ©nÃ©ration de documentation</li>
<li><a href="https://eur-lex.europa.eu/eli/reg/2016/679/oj">RGPD (texte
intÃ©gral)</a> - RÃ©fÃ©rence lÃ©gale</li>
<li><a href="https://www.conventionalcommits.org/">Conventional
Commits</a> - Standard de commits</li>
</ul>
<hr />
<h2 id="licence">Licence</h2>
<p>Ce projet est sous licence <strong>MIT</strong>. Voir le fichier <a
href="../LICENSE">LICENSE</a> Ã  la racine du projet.</p>
<hr />
<h2 id="support">Support</h2>
<p>Pour toute question ou contribution, consultez :</p>
<ul>
<li><a href="../CONTRIBUTING.md">CONTRIBUTING.md</a> - Guide de
contribution</li>
<li><a href="../CODE_OF_CONDUCT.md">CODE_OF_CONDUCT.md</a> - Code de
conduite</li>
<li><a
href="https://github.com/lexorbital/lexorbital-core/issues">GitHub
Issues</a> - Signaler un bug ou proposer une fonctionnalitÃ©</li>
</ul>
<hr />
<p><strong>Version du guide</strong> : 1.0.0<br />
<strong>DerniÃ¨re mise Ã  jour</strong> : 22 novembre 2025</p>
<h1 id="sommaire-de-la-documentation-lexorbital">ğŸ“š Sommaire de la
Documentation LexOrbital</h1>
<blockquote>
<p>Navigation rapide vers toutes les fiches techniques de la station
orbitale.</p>
</blockquote>
<hr />
<h2 id="vue-densemble">ğŸ¯ Vue dâ€™ensemble</h2>
<p>Ce guide complet couvre lâ€™architecture, les modules, la conformitÃ©
RGPD et lâ€™outillage de <strong>LexOrbital</strong>, la station orbitale
dâ€™architecture logicielle.</p>
<p><strong>Nombre total de fiches</strong> : 10<br />
<strong>Lignes de documentation</strong> : ~2,600<br />
<strong>Format</strong> : Markdown â†’ HTML/PDF/DOCX via Pandoc</p>
<hr />
<h2 id="fiches-techniques">ğŸ“– Fiches techniques</h2>
<h3 id="fondations-fiches-00-02">ğŸ›°ï¸ Fondations (Fiches 00-02)</h3>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 30%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>#</th>
<th>Titre</th>
<th>RÃ©sumÃ©</th>
<th>Lignes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><a href="00_lexorbital-intro.md">00</a></strong></td>
<td><strong>Vue dâ€™ensemble</strong></td>
<td>Vision, origine, roadmap LexOrbital</td>
<td>92</td>
</tr>
<tr>
<td><strong><a href="01_architecture-orbitale.md">01</a></strong></td>
<td><strong>Architecture orbitale</strong></td>
<td>Meta-Kernel, anneaux (0-3), modules</td>
<td>154</td>
</tr>
<tr>
<td><strong><a
href="02_microservices-vs-modules.md">02</a></strong></td>
<td><strong>Microservices vs modules</strong></td>
<td>Comparaison, choix architectural</td>
<td>129</td>
</tr>
</tbody>
</table>
<h3 id="documentation-conformitÃ©-fiches-03-05">ğŸ“ Documentation &amp;
ConformitÃ© (Fiches 03-05)</h3>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 30%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>#</th>
<th>Titre</th>
<th>RÃ©sumÃ©</th>
<th>Lignes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><a
href="03_documentation-et-diagrammes-vivants.md">03</a></strong></td>
<td><strong>Documentation vivante</strong></td>
<td>GÃ©nÃ©ration auto (Pandoc, Mermaid, Swagger)</td>
<td>239</td>
</tr>
<tr>
<td><strong><a href="04_manifestes-lexorbital.md">04</a></strong></td>
<td><strong>Manifestes</strong></td>
<td><code>lexorbital.module.json</code> +
<code>rgpd-manifest.json</code></td>
<td>288</td>
</tr>
<tr>
<td><strong><a href="05_rgpd-by-design.md">05</a></strong></td>
<td><strong>RGPD by design</strong></td>
<td>Audit immutable, DSAR, anonymisation</td>
<td>329</td>
</tr>
</tbody>
</table>
<h3 id="outillage-workflow-fiches-06-07">ğŸ”§ Outillage &amp; Workflow
(Fiches 06-07)</h3>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 30%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>#</th>
<th>Titre</th>
<th>RÃ©sumÃ©</th>
<th>Lignes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><a href="06_template-module.md">06</a></strong></td>
<td><strong>Template module</strong></td>
<td>Husky, Commitlint, tests, SemVer</td>
<td>387</td>
</tr>
<tr>
<td><strong><a href="07_workflow-subtree.md">07</a></strong></td>
<td><strong>Workflow subtree</strong></td>
<td>Git subtree, amarrage de modules</td>
<td>254</td>
</tr>
</tbody>
</table>
<h3 id="Ã©cosystÃ¨me-fiches-08-09">ğŸš€ Ã‰cosystÃ¨me (Fiches 08-09)</h3>
<table>
<colgroup>
<col style="width: 11%" />
<col style="width: 26%" />
<col style="width: 30%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>#</th>
<th>Titre</th>
<th>RÃ©sumÃ©</th>
<th>Lignes</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><a href="08_modules-types.md">08</a></strong></td>
<td><strong>Modules types</strong></td>
<td>Catalogue (auth, audit, dossiers, etc.)</td>
<td>307</td>
</tr>
<tr>
<td><strong><a href="09_console-de-controle.md">09</a></strong></td>
<td><strong>Console de contrÃ´le</strong></td>
<td>Design diÃ©gÃ©tique, Three.js, WebSocket</td>
<td>402</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="organisation-du-dÃ©pÃ´t-docs">ğŸ—‚ï¸ Organisation du dÃ©pÃ´t
<code>docs/</code></h2>
<pre><code>docs/
â”œâ”€â”€ 00_lexorbital-intro.md              # Fiche 0 : Vue d&#39;ensemble
â”œâ”€â”€ 01_architecture-orbitale.md         # Fiche 1 : Architecture
â”œâ”€â”€ 02_microservices-vs-modules.md      # Fiche 2 : Comparaison
â”œâ”€â”€ 03_documentation-et-diagrammes-vivants.md  # Fiche 3 : Doc vivante
â”œâ”€â”€ 04_manifestes-lexorbital.md         # Fiche 4 : Manifestes
â”œâ”€â”€ 05_rgpd-by-design.md                # Fiche 5 : RGPD
â”œâ”€â”€ 06_template-module.md               # Fiche 6 : Template
â”œâ”€â”€ 07_workflow-subtree.md              # Fiche 7 : Git subtree
â”œâ”€â”€ 08_modules-types.md                 # Fiche 8 : Catalogue
â”œâ”€â”€ 09_console-de-controle.md           # Fiche 9 : Console
â”œâ”€â”€ README.md                           # Index principal
â”œâ”€â”€ QUICKSTART.md                       # Guide de dÃ©marrage rapide
â”œâ”€â”€ templates/
â”‚   â”œâ”€â”€ lexorbital.html                 # Template HTML Pandoc
â”‚   â””â”€â”€ pandoc.css                      # Styles CSS (thÃ¨me spatial)
â”œâ”€â”€ generated/                          # Documentation gÃ©nÃ©rÃ©e (HTML/PDF/DOCX)
â””â”€â”€ scripts/
    â””â”€â”€ generate-docs.sh                # Script de gÃ©nÃ©ration</code></pre>
<hr />
<h2 id="thÃ¨me-visuel">ğŸ¨ ThÃ¨me visuel</h2>
<p>Le thÃ¨me LexOrbital utilise une palette <strong>spatiale</strong>
:</p>
<ul>
<li><strong>Couleur primaire</strong> : Bleu profond (#2563eb)</li>
<li><strong>Accent</strong> : Cyan/Turquoise (#06b6d4)</li>
<li><strong>Fond</strong> : DÃ©gradÃ© sombre (#0f172a â†’ #1e293b)</li>
<li><strong>Police monospace</strong> : Fira Code, Monaco</li>
<li><strong>Bordures</strong> : Style holographique (cyan +
transparence)</li>
</ul>
<hr />
<h2 id="mÃ©triques">ğŸ“Š MÃ©triques</h2>
<table>
<thead>
<tr>
<th>MÃ©trique</th>
<th>Valeur</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Fiches techniques</strong></td>
<td>10</td>
</tr>
<tr>
<td><strong>Lignes totales</strong></td>
<td>~2,600</td>
</tr>
<tr>
<td><strong>Mots</strong></td>
<td>~18,000</td>
</tr>
<tr>
<td><strong>Temps de lecture estimÃ©</strong></td>
<td>~90 minutes</td>
</tr>
<tr>
<td><strong>Diagrammes Mermaid</strong></td>
<td>5+</td>
</tr>
<tr>
<td><strong>Exemples de code</strong></td>
<td>40+</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="parcours-de-lecture-recommandÃ©s">ğŸ”— Parcours de lecture
recommandÃ©s</h2>
<h3 id="pour-les-architectes">Pour les architectes</h3>
<ol type="1">
<li><a href="00_lexorbital-intro.md">00 - Vue dâ€™ensemble</a></li>
<li><a href="01_architecture-orbitale.md">01 - Architecture
orbitale</a></li>
<li><a href="02_microservices-vs-modules.md">02 - Microservices vs
modules</a></li>
<li><a href="08_modules-types.md">08 - Modules types</a></li>
</ol>
<h3 id="pour-les-dÃ©veloppeurs">Pour les dÃ©veloppeurs</h3>
<ol type="1">
<li><a href="06_template-module.md">06 - Template module</a></li>
<li><a href="04_manifestes-lexorbital.md">04 - Manifestes</a></li>
<li><a href="07_workflow-subtree.md">07 - Workflow subtree</a></li>
<li><a href="03_documentation-et-diagrammes-vivants.md">03 -
Documentation vivante</a></li>
</ol>
<h3 id="pour-les-dpo-conformitÃ©">Pour les DPO / ConformitÃ©</h3>
<ol type="1">
<li><a href="05_rgpd-by-design.md">05 - RGPD by design</a></li>
<li><a href="04_manifestes-lexorbital.md">04 - Manifestes RGPD</a></li>
<li><a href="03_documentation-et-diagrammes-vivants.md">03 -
Documentation automatique</a></li>
</ol>
<h3 id="pour-les-product-owners">Pour les Product Owners</h3>
<ol type="1">
<li><a href="00_lexorbital-intro.md">00 - Vue dâ€™ensemble</a></li>
<li><a href="09_console-de-controle.md">09 - Console de
contrÃ´le</a></li>
<li><a href="08_modules-types.md">08 - Modules types</a></li>
</ol>
<hr />
<h2 id="commandes-rapides">ğŸš€ Commandes rapides</h2>
<h3 id="lire-la-doc">Lire la doc</h3>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ouvrir dans Obsidian (recommandÃ©)</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">open</span> <span class="at">-a</span> Obsidian docs/</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Lire avec VS Code</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">code</span> docs/README.md</span></code></pre></div>
<h3 id="gÃ©nÃ©rer-la-doc">GÃ©nÃ©rer la doc</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tout gÃ©nÃ©rer</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/generate-docs.sh</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># HTML uniquement</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> docs <span class="kw">&amp;&amp;</span> <span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="dt">\</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">--template</span><span class="op">=</span>templates/lexorbital.html <span class="dt">\</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">--css</span><span class="op">=</span>templates/pandoc.css <span class="dt">\</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> generated/guide.html <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># PDF uniquement (LaTeX requis)</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> docs <span class="kw">&amp;&amp;</span> <span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="dt">\</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">--pdf-engine</span><span class="op">=</span>xelatex <span class="dt">\</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">-o</span> generated/guide.pdf <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span></code></pre></div>
<h3 id="ouvrir-la-doc-gÃ©nÃ©rÃ©e">Ouvrir la doc gÃ©nÃ©rÃ©e</h3>
<div class="sourceCode" id="cb9"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="ex">open</span> docs/generated/index.html</span></code></pre></div>
<hr />
<h2 id="ressources-complÃ©mentaires">ğŸ“š Ressources complÃ©mentaires</h2>
<h3 id="documentation-existante">Documentation existante</h3>
<ul>
<li><a href="architecture.md">Architecture technique</a></li>
<li><a href="Introduction/lexorbital-origin.md">Origine de
LexOrbital</a></li>
<li><a href="guides/generating-documentation.md">GÃ©nÃ©rer la
documentation</a></li>
<li><a href="legal/sources.md">Sources lÃ©gales</a></li>
</ul>
<h3 id="liens-externes">Liens externes</h3>
<ul>
<li><a href="https://docs.nestjs.com/">NestJS Documentation</a></li>
<li><a href="https://docs.pmnd.rs/react-three-fiber/">React Three
Fiber</a></li>
<li><a href="https://eur-lex.europa.eu/eli/reg/2016/679/oj">RGPD - Texte
intÃ©gral</a></li>
<li><a href="https://pandoc.org/MANUAL.html">Pandoc Manual</a></li>
</ul>
<hr />
<h2 id="checklist-de-lecture">âœ… Checklist de lecture</h2>
<p>Cochez au fur et Ã  mesure de votre lecture :</p>
<ul class="task-list">
<li><label><input type="checkbox" />00 - Vue dâ€™ensemble</label></li>
<li><label><input type="checkbox" />01 - Architecture
orbitale</label></li>
<li><label><input type="checkbox" />02 - Microservices vs
modules</label></li>
<li><label><input type="checkbox" />03 - Documentation
vivante</label></li>
<li><label><input type="checkbox" />04 - Manifestes</label></li>
<li><label><input type="checkbox" />05 - RGPD by design</label></li>
<li><label><input type="checkbox" />06 - Template module</label></li>
<li><label><input type="checkbox" />07 - Workflow subtree</label></li>
<li><label><input type="checkbox" />08 - Modules types</label></li>
<li><label><input type="checkbox" />09 - Console de
contrÃ´le</label></li>
</ul>
<hr />
<p><strong>Version</strong> : 1.0.0<br />
<strong>DerniÃ¨re mise Ã  jour</strong> : 22 novembre 2025<br />
<strong>Auteur</strong> : LexOrbital Core Team</p>
<p>ğŸ›°ï¸ <strong>Bon voyage dans la station orbitale LexOrbital
!</strong></p>
<h1 id="fiche-0-lexorbital-vue-densemble">Fiche nÂ°0 : LexOrbital â€“ Vue
dâ€™ensemble</h1>
<blockquote>
<p><strong>LexOrbital</strong> est une station orbitale dâ€™architecture
logicielle modulaire, conÃ§ue pour orchestrer des systÃ¨mes juridiques et
mÃ©tiers complexes avec conformitÃ© RGPD intÃ©grÃ©e et traÃ§abilitÃ©
complÃ¨te.</p>
</blockquote>
<h2 id="objectif-de-la-fiche">1. Objectif de la fiche</h2>
<p>Cette fiche prÃ©sente la vision globale de LexOrbital : son origine,
sa philosophie architecturale et sa roadmap. Elle sert de point dâ€™entrÃ©e
pour comprendre pourquoi et comment LexOrbital se positionne comme
alternative aux architectures monolithiques et microservices
traditionnelles.</p>
<h2 id="contexte-et-origine">2. Contexte et origine</h2>
<p>LexOrbital naÃ®t dâ€™un constat : - Les <strong>monolithes</strong>
deviennent ingÃ©rables Ã  grande Ã©chelle - Les
<strong>microservices</strong> imposent une complexitÃ© opÃ©rationnelle
importante (orchestration, communication rÃ©seau, observabilitÃ©) - Les
exigences <strong>RGPD</strong> nÃ©cessitent une traÃ§abilitÃ© fine et
native, difficile Ã  retrofitter</p>
<h3 id="vision-la-station-orbitale">Vision : la station orbitale</h3>
<p>PlutÃ´t que de multiplier les services autonomes, LexOrbital propose
une <strong>architecture orbitale</strong> : - Un
<strong>Meta-Kernel</strong> central (noyau de coordination) - Des
<strong>anneaux fonctionnels</strong> (couches mÃ©tier : auth, audit,
data, etc.) - Des <strong>modules plugâ€™nâ€™play</strong> qui sâ€™amarrent
dynamiquement Ã  la station</p>
<p>Cette mÃ©taphore spatiale permet de visualiser lâ€™architecture comme un
systÃ¨me gravitationnel oÃ¹ chaque module occupe une orbite dÃ©finie, avec
des responsabilitÃ©s claires et une communication orchestrÃ©e.</p>
<h2 id="points-clÃ©s">3. Points clÃ©s</h2>
<h3 id="architecture-modulaire-par-anneaux">3.1. Architecture modulaire
par anneaux</h3>
<ul>
<li><strong>Anneau 0 (Meta-Kernel)</strong> : Orchestration,
configuration, health checks</li>
<li><strong>Anneau 1 (Core Services)</strong> : Auth, RBAC, Audit,
Logging</li>
<li><strong>Anneau 2 (Business Logic)</strong> : Modules mÃ©tier
(dossiers, documents, workflow)</li>
<li><strong>Anneau 3 (IntÃ©grations)</strong> : APIs externes, webhooks,
notifications</li>
</ul>
<h3 id="manifestes-dÃ©claratifs">3.2. Manifestes dÃ©claratifs</h3>
<p>Chaque module expose un <code>lexorbital.module.json</code> dÃ©crivant
: - Ses dÃ©pendances - Ses points dâ€™entrÃ©e (API, Ã©vÃ©nements) - Sa
conformitÃ© RGPD (<code>rgpd-manifest.json</code>)</p>
<h3 id="console-de-contrÃ´le-diÃ©gÃ©tique">3.3. Console de contrÃ´le
diÃ©gÃ©tique</h3>
<p>Interface inspirÃ©e des consoles de station spatiale pour : -
Visualiser lâ€™Ã©tat des modules (statut, santÃ©, orbite) - GÃ©rer les
amarrages/dÃ©samarrages - Auditer les flux de donnÃ©es et Ã©vÃ©nements</p>
<h3 id="rgpd-by-design">3.4. RGPD by design</h3>
<ul>
<li>TraÃ§abilitÃ© native (qui accÃ¨de Ã  quoi, quand, pourquoi)</li>
<li>DurÃ©es de rÃ©tention configurables par module</li>
<li>Export/suppression GDPR automatisÃ©s</li>
</ul>
<h2 id="roadmap">4. Roadmap</h2>
<h3 id="phase-1-fondations-q1-2025">Phase 1 : Fondations (Q1 2025)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Meta-Kernel (NestJS) avec systÃ¨me de
plugins</label></li>
<li><label><input type="checkbox" />Template de module
standard</label></li>
<li><label><input type="checkbox" />Module Auth (JWT +
RBAC)</label></li>
<li><label><input type="checkbox" />Module Audit (event
sourcing)</label></li>
</ul>
<h3 id="phase-2-modules-mÃ©tier-q2-2025">Phase 2 : Modules mÃ©tier (Q2
2025)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Module Dossiers
juridiques</label></li>
<li><label><input type="checkbox" />Module Documents (versionning,
signatures)</label></li>
<li><label><input type="checkbox" />Console de contrÃ´le (React +
Three.js pour visualisation 3D)</label></li>
</ul>
<h3 id="phase-3-conformitÃ©-avancÃ©e-q3-2025">Phase 3 : ConformitÃ© avancÃ©e
(Q3 2025)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Manifeste RGPD
automatisÃ©</label></li>
<li><label><input type="checkbox" />Tableaux de flux de
donnÃ©es</label></li>
<li><label><input type="checkbox" />Exports conformitÃ© (PDF,
JSON)</label></li>
</ul>
<h3 id="phase-4-Ã©cosystÃ¨me-q4-2025">Phase 4 : Ã‰cosystÃ¨me (Q4 2025)</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Marketplace de modules</label></li>
<li><label><input type="checkbox" />CLI dâ€™amarrage de modules
tiers</label></li>
<li><label><input type="checkbox" />Documentation
interactive</label></li>
</ul>
<h2 id="Ã -retenir-checklist">5. Ã€ retenir / Checklist</h2>
<ul class="task-list">
<li><label><input type="checkbox" />LexOrbital = <strong>station
orbitale</strong> (Meta-Kernel + anneaux + modules)</label></li>
<li><label><input type="checkbox" /><strong>Plugâ€™nâ€™play</strong> :
modules sâ€™amarrent/dÃ©samarrent sans redÃ©ploiement complet</label></li>
<li><label><input type="checkbox" /><strong>RGPD native</strong> :
conformitÃ© intÃ©grÃ©e dÃ¨s la conception</label></li>
<li><label><input type="checkbox" /><strong>Console diÃ©gÃ©tique</strong>
: UX inspirÃ©e des stations spatiales</label></li>
<li><label><input type="checkbox" /><strong>Manifestes
dÃ©claratifs</strong> : <code>lexorbital.module.json</code> pour chaque
module</label></li>
</ul>
<h2 id="liens-connexes">6. Liens connexes</h2>
<ul>
<li>[[01_architecture-orbitale]] : DÃ©tails techniques du Meta-Kernel et
des anneaux</li>
<li>[[04_manifestes-lexorbital]] : SpÃ©cifications des fichiers de
manifeste</li>
<li>[[09_console-de-controle]] : Design et UX de la console de
contrÃ´le</li>
<li>[[06_template-module]] : Comment crÃ©er un nouveau module
LexOrbital</li>
</ul>
<h1 id="fiche-1-architecture-orbitale">Fiche nÂ°1 : Architecture orbitale
(Meta-Kernel, anneaux, modules)</h1>
<blockquote>
<p>Lâ€™architecture orbitale de LexOrbital organise les composants en
<strong>anneaux concentriques</strong> autour dâ€™un
<strong>Meta-Kernel</strong> central, permettant une orchestration
cohÃ©rente tout en garantissant lâ€™isolation et la modularitÃ©.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-1">1. Objectif de la fiche</h2>
<p>DÃ©crire en dÃ©tail lâ€™organisation en couches (anneaux) de LexOrbital,
le rÃ´le du Meta-Kernel et les principes de communication entre modules.
Cette fiche est la rÃ©fÃ©rence technique pour comprendre comment les
modules sâ€™intÃ¨grent Ã  la station.</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="le-meta-kernel-cerveau-de-la-station">2.1. Le Meta-Kernel :
cerveau de la station</h3>
<p>Le <strong>Meta-Kernel</strong> est le noyau central de LexOrbital.
Il assure :</p>
<h4 id="orchestration-des-modules">Orchestration des modules</h4>
<ul>
<li>DÃ©couverte automatique des modules (via manifestes)</li>
<li>Gestion du cycle de vie : initialisation, health checks, graceful
shutdown</li>
<li>Injection de dÃ©pendances inter-modules</li>
</ul>
<h4 id="configuration-centralisÃ©e">Configuration centralisÃ©e</h4>
<ul>
<li>Variables dâ€™environnement par anneau/module</li>
<li>Secrets management (intÃ©gration Vault/K8s secrets)</li>
<li>Feature flags et configuration dynamique</li>
</ul>
<h4 id="routage-et-communication">Routage et communication</h4>
<ul>
<li>Event bus (Ã©vÃ©nements inter-modules)</li>
<li>API Gateway interne (routage HTTP)</li>
<li>Gestion des droits dâ€™accÃ¨s (ACL par module)</li>
</ul>
<h3 id="les-anneaux-fonctionnels">2.2. Les anneaux fonctionnels</h3>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Anneau 3 : IntÃ©grations         â”‚  â† APIs externes, webhooks
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚      Anneau 2 : Business Logic          â”‚  â† Modules mÃ©tier
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Anneau 1 : Core Services           â”‚  â† Auth, Audit, Logs
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚       Anneau 0 : Meta-Kernel             â”‚  â† Orchestration
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<h4 id="anneau-0-meta-kernel">Anneau 0 : Meta-Kernel</h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Orchestration, configuration,
health</li>
<li><strong>Technologies</strong> : NestJS, TypeORM, Bull (queues)</li>
<li><strong>Modules</strong> : <code>core-kernel</code>,
<code>config-manager</code>, <code>module-loader</code></li>
</ul>
<h4 id="anneau-1-core-services">Anneau 1 : Core Services</h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Services transverses
critiques</li>
<li><strong>Modules</strong> :
<ul>
<li><code>auth-module</code> : JWT, OAuth2, RBAC</li>
<li><code>audit-module</code> : Event sourcing, logs immutables</li>
<li><code>logger-module</code> : Logs structurÃ©s (Winston/Pino)</li>
<li><code>notification-module</code> : Emails, push, webhooks</li>
</ul></li>
</ul>
<h4 id="anneau-2-business-logic">Anneau 2 : Business Logic</h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Logique mÃ©tier spÃ©cifique</li>
<li><strong>Modules</strong> :
<ul>
<li><code>dossiers-module</code> : Gestion des dossiers juridiques</li>
<li><code>documents-module</code> : Versionning, signatures
Ã©lectroniques</li>
<li><code>workflow-module</code> : Processus mÃ©tier (BPMN)</li>
<li><code>facturation-module</code> : Calculs, exports comptables</li>
</ul></li>
</ul>
<h4 id="anneau-3-intÃ©grations">Anneau 3 : IntÃ©grations</h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Communication avec
lâ€™extÃ©rieur</li>
<li><strong>Modules</strong> :
<ul>
<li><code>api-gateway-module</code> : Exposition REST/GraphQL</li>
<li><code>webhooks-module</code> : IntÃ©grations tierces (Stripe,
Twilio)</li>
<li><code>export-module</code> : GÃ©nÃ©ration de documents (PDF,
Excel)</li>
</ul></li>
</ul>
<h3 id="principes-de-communication">2.3. Principes de communication</h3>
<h4 id="communication-synchrone-httprpc">Communication synchrone
(HTTP/RPC)</h4>
<div class="sourceCode" id="cb11"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Module A appelle Module B via le Meta-Kernel</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="at">metaKernel</span><span class="op">.</span><span class="fu">invoke</span>(<span class="st">&#39;module-b&#39;</span><span class="op">,</span> <span class="st">&#39;methodName&#39;</span><span class="op">,</span> params)<span class="op">;</span></span></code></pre></div>
<h4 id="communication-asynchrone-event-bus">Communication asynchrone
(Event Bus)</h4>
<div class="sourceCode" id="cb12"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Module A Ã©met un Ã©vÃ©nement</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">this</span><span class="op">.</span><span class="at">eventBus</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;dossier.created&#39;</span><span class="op">,</span> { dossierId<span class="op">:</span> <span class="st">&#39;123&#39;</span> })<span class="op">;</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Module B Ã©coute l&#39;Ã©vÃ©nement</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>@<span class="fu">OnEvent</span>(<span class="st">&#39;dossier.created&#39;</span>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="fu">handleDossierCreated</span>(payload<span class="op">:</span> { dossierId<span class="op">:</span> <span class="dt">string</span> }) {</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Logique de rÃ©action</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="isolation-et-sandbox">Isolation et sandbox</h4>
<ul>
<li>Chaque module tourne dans son propre contexte (DI isolÃ©)</li>
<li>Les modules ne se chargent <strong>jamais</strong> directement entre
eux</li>
<li>Toutes les communications passent par le Meta-Kernel</li>
</ul>
<h2 id="implications-techniques">3. Implications techniques</h2>
<h3 id="stack-technique">3.1. Stack technique</h3>
<table>
<thead>
<tr>
<th>Composant</th>
<th>Technologie principale</th>
<th>Alternative</th>
</tr>
</thead>
<tbody>
<tr>
<td>Meta-Kernel</td>
<td>NestJS (Node.js)</td>
<td>Moleculer</td>
</tr>
<tr>
<td>Base de donnÃ©es</td>
<td>PostgreSQL + TypeORM</td>
<td>Prisma</td>
</tr>
<tr>
<td>Event Bus</td>
<td>Bull + Redis</td>
<td>RabbitMQ</td>
</tr>
<tr>
<td>Cache</td>
<td>Redis</td>
<td>Memcached</td>
</tr>
<tr>
<td>Monitoring</td>
<td>Prometheus + Grafana</td>
<td>Datadog</td>
</tr>
<tr>
<td>Logs</td>
<td>Winston + Loki</td>
<td>ELK Stack</td>
</tr>
</tbody>
</table>
<h3 id="structure-du-meta-kernel">3.2. Structure du Meta-Kernel</h3>
<pre><code>meta-kernel/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ core/
â”‚   â”‚   â”œâ”€â”€ module-loader.service.ts      # Chargement dynamique des modules
â”‚   â”‚   â”œâ”€â”€ event-bus.service.ts          # Pub/Sub inter-modules
â”‚   â”‚   â”œâ”€â”€ config.service.ts             # Configuration centralisÃ©e
â”‚   â”‚   â””â”€â”€ health.controller.ts          # Health checks
â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â””â”€â”€ [modules amarrÃ©s dynamiquement]
â”‚   â””â”€â”€ main.ts
â”œâ”€â”€ manifests/                             # Manifestes des modules chargÃ©s
â””â”€â”€ package.json</code></pre>
<h3 id="cycle-de-vie-dun-module">3.3. Cycle de vie dâ€™un module</h3>
<ol type="1">
<li><strong>DÃ©couverte</strong> : Le Meta-Kernel scanne
<code>manifests/</code> au dÃ©marrage</li>
<li><strong>Validation</strong> : VÃ©rification du manifeste
(<code>lexorbital.module.json</code>)</li>
<li><strong>Chargement</strong> : Import dynamique du module (ESM)</li>
<li><strong>Injection</strong> : Fourniture des services du kernel
(eventBus, config, etc.)</li>
<li><strong>Initialisation</strong> : Appel du hook
<code>onModuleInit()</code></li>
<li><strong>SantÃ©</strong> : Polling du endpoint <code>/health</code> du
module</li>
<li><strong>ArrÃªt</strong> : Appel du hook
<code>onModuleDestroy()</code> lors du shutdown</li>
</ol>
<h2 id="checklist-de-mise-en-Å“uvre">4. Checklist de mise en Å“uvre</h2>
<ul class="task-list">
<li><label><input type="checkbox" />ImplÃ©menter le
<code>ModuleLoader</code> avec support ESM dynamique</label></li>
<li><label><input type="checkbox" />Configurer lâ€™event bus (Bull +
Redis) avec retry policy</label></li>
<li><label><input type="checkbox" />CrÃ©er le systÃ¨me de configuration
centralisÃ©e (env + Vault)</label></li>
<li><label><input type="checkbox" />ImplÃ©menter les hooks de cycle de
vie (<code>onModuleInit</code>,
<code>onModuleDestroy</code>)</label></li>
<li><label><input type="checkbox" />Mettre en place le health check
aggregator (tous modules)</label></li>
<li><label><input type="checkbox" />Configurer Prometheus pour exposer
les mÃ©triques du kernel</label></li>
<li><label><input type="checkbox" />Documenter lâ€™API du Meta-Kernel pour
les dÃ©veloppeurs de modules</label></li>
</ul>
<h2 id="liens-connexes-1">5. Liens connexes</h2>
<ul>
<li>[[00_lexorbital-intro]] : Vue dâ€™ensemble de LexOrbital</li>
<li>[[04_manifestes-lexorbital]] : Format des manifestes de modules</li>
<li>[[06_template-module]] : Comment crÃ©er un module compatible</li>
<li>[[08_modules-types]] : Catalogue des modules par anneau</li>
</ul>
<h1 id="fiche-2-microservices-vs-modules">Fiche nÂ°2 : Microservices vs
modules plugâ€™nâ€™play</h1>
<blockquote>
<p>LexOrbital adopte une approche <strong>modulaire
monolithique</strong> (modules plugâ€™nâ€™play dans un seul runtime) plutÃ´t
quâ€™une architecture microservices distribuÃ©e, pour rÃ©duire la complexitÃ©
opÃ©rationnelle tout en conservant la modularitÃ©.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-2">1. Objectif de la fiche</h2>
<p>Clarifier les diffÃ©rences entre lâ€™approche microservices classique et
lâ€™architecture modulaire de LexOrbital, justifier ce choix architectural
et identifier les cas oÃ¹ chaque approche est pertinente.</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-1">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="architecture-microservices-forces-et-limites">2.1. Architecture
microservices : forces et limites</h3>
<h4 id="forces">Forces</h4>
<ul>
<li><strong>Isolation forte</strong> : chaque service a son propre
runtime, base de donnÃ©es, cycle de dÃ©ploiement</li>
<li><strong>ScalabilitÃ© indÃ©pendante</strong> : on peut scaler
uniquement les services sous charge</li>
<li><strong>RÃ©silience</strong> : la panne dâ€™un service nâ€™affecte pas
les autres (en thÃ©orie)</li>
<li><strong>Polyglot</strong> : chaque service peut utiliser une stack
diffÃ©rente</li>
</ul>
<h4 id="limites-qui-motivent-lexorbital">Limites (qui motivent
LexOrbital)</h4>
<ul>
<li><strong>ComplexitÃ© opÃ©rationnelle</strong> : orchestration
(Kubernetes), service mesh (Istio), observabilitÃ© distribuÃ©e</li>
<li><strong>Latence rÃ©seau</strong> : chaque appel inter-service passe
par le rÃ©seau (sÃ©rialisation, dÃ©sÃ©rialisation)</li>
<li><strong>Transactions distribuÃ©es</strong> : gestion complexe de la
cohÃ©rence (Saga pattern, eventual consistency)</li>
<li><strong>Overhead infrastructure</strong> : chaque service a besoin
de son propre conteneur, monitoring, logs</li>
<li><strong>DÃ©ploiement</strong> : coordination des versions, rolling
updates, rollback multi-services</li>
</ul>
<h3 id="modules-plugnplay-lexorbital-principes">2.2. Modules plugâ€™nâ€™play
LexOrbital : principes</h3>
<h4 id="un-seul-runtime-plusieurs-modules">Un seul runtime, plusieurs
modules</h4>
<ul>
<li>Tous les modules tournent dans <strong>le mÃªme process
Node.js</strong> (NestJS)</li>
<li>Communication <strong>in-memory</strong> (appels de fonctions
directs ou event bus local)</li>
<li><strong>Pas de sÃ©rialisation rÃ©seau</strong> pour les appels
inter-modules</li>
</ul>
<h4 id="isolation-logique-pas-physique">Isolation logique, pas
physique</h4>
<ul>
<li>Chaque module a son propre <strong>contexte DI</strong> (Dependency
Injection)</li>
<li>Les modules ne sâ€™importent <strong>jamais</strong> directement :
tout passe par le Meta-Kernel</li>
<li>Sandboxing possible via <strong>VM contexts</strong> ou
<strong>Worker Threads</strong> pour les modules non-trustÃ©s</li>
</ul>
<h4 id="dÃ©ploiement-simplifiÃ©">DÃ©ploiement simplifiÃ©</h4>
<ul>
<li><strong>Un seul dÃ©ploiement</strong> pour lâ€™ensemble de la
station</li>
<li>Ajout/retrait de modules sans redÃ©marrage (hot reload)</li>
<li>Git subtree pour gÃ©rer les sources de modules externes</li>
</ul>
<h3 id="tableau-comparatif">2.3. Tableau comparatif</h3>
<table>
<colgroup>
<col style="width: 34%" />
<col style="width: 32%" />
<col style="width: 32%" />
</colgroup>
<thead>
<tr>
<th>CritÃ¨re</th>
<th>Microservices</th>
<th>Modules LexOrbital</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Isolation</strong></td>
<td>Processus sÃ©parÃ©s</td>
<td>Contextes DI isolÃ©s</td>
</tr>
<tr>
<td><strong>Communication</strong></td>
<td>HTTP/gRPC (rÃ©seau)</td>
<td>Appels in-memory</td>
</tr>
<tr>
<td><strong>Transactions</strong></td>
<td>Saga / 2PC</td>
<td>ACID natif (mÃªme DB)</td>
</tr>
<tr>
<td><strong>Latence inter-modules</strong></td>
<td>~5-50ms (rÃ©seau)</td>
<td>&lt;1ms (mÃ©moire)</td>
</tr>
<tr>
<td><strong>ScalabilitÃ©</strong></td>
<td>IndÃ©pendante par service</td>
<td>Verticale (toute la station)</td>
</tr>
<tr>
<td><strong>ComplexitÃ© ops</strong></td>
<td>Ã‰levÃ©e (K8s, mesh, etc.)</td>
<td>Faible (monolithe)</td>
</tr>
<tr>
<td><strong>DÃ©ploiement</strong></td>
<td>Multi-pipelines</td>
<td>Pipeline unique</td>
</tr>
<tr>
<td><strong>Debugging</strong></td>
<td>DistribuÃ© (tracing)</td>
<td>Local (stack trace simple)</td>
</tr>
<tr>
<td><strong>Polyglot</strong></td>
<td>Oui</td>
<td>Non (JavaScript/TypeScript)</td>
</tr>
<tr>
<td><strong>RÃ©silience</strong></td>
<td>IndÃ©pendance des pannes</td>
<td>RedÃ©marrage global</td>
</tr>
</tbody>
</table>
<h2 id="implications-techniques-1">3. Implications techniques</h2>
<h3 id="quand-choisir-lexorbital-modules">3.1. Quand choisir LexOrbital
(modules)</h3>
<p>âœ… <strong>Cas dâ€™usage adaptÃ©s</strong> : - Applications
<strong>monomÃ©tier</strong> ou <strong>mono-tenant</strong> avec forte
cohÃ©sion fonctionnelle - Ã‰quipes de <strong>petite Ã  moyenne
taille</strong> (pas de silos organisationnels) - Besoins de
<strong>transactions complexes</strong> entre modules (cohÃ©rence forte)
- Infrastructure <strong>limitÃ©e</strong> (pas de K8s, pas dâ€™Ã©quipe
DevOps dÃ©diÃ©e) - <strong>Latence critique</strong> (finance, temps rÃ©el)
oÃ¹ chaque milliseconde compte</p>
<h3 id="quand-privilÃ©gier-les-microservices">3.2. Quand privilÃ©gier les
microservices</h3>
<p>âœ… <strong>Cas dâ€™usage adaptÃ©s</strong> : - <strong>TrÃ¨s grande
Ã©chelle</strong> (centaines de dÃ©veloppeurs, dizaines de services) -
Besoins de <strong>scalabilitÃ© hÃ©tÃ©rogÃ¨ne</strong> (certains services
x100, dâ€™autres x1) - <strong>Multi-tenant</strong> avec isolation forte
par client - Ã‰quipes <strong>autonomes</strong> avec ownership fort
(chacun son service, son dÃ©ploiement) - Stack <strong>polyglot</strong>
nÃ©cessaire (Python pour ML, Go pour perf, etc.)</p>
<h3 id="approche-hybride-future-Ã©volution-lexorbital">3.3. Approche
hybride (future Ã©volution LexOrbital)</h3>
<p>LexOrbital pourrait Ã©voluer vers un <strong>modÃ¨le hybride</strong>
:</p>
<pre><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Station LexOrbital (Meta-Kernel)    â”‚  â† Core + modules mÃ©tier (in-memory)
â”‚   â”œâ”€â”€ Auth Module                     â”‚
â”‚   â”œâ”€â”€ Audit Module                    â”‚
â”‚   â”œâ”€â”€ Dossiers Module                 â”‚
â”‚   â””â”€â”€ Documents Module                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â†“ HTTP/gRPC
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Microservices externes (optionnels) â”‚  â† Services haute performance
â”‚   â”œâ”€â”€ OCR Service (Python + Tesseract)â”‚
â”‚   â”œâ”€â”€ ML Service (TensorFlow)         â”‚
â”‚   â””â”€â”€ Search Service (Elasticsearch)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜</code></pre>
<p><strong>Principe</strong> : garder le cÅ“ur mÃ©tier en modules (faible
latence, transactions), externaliser les services spÃ©cialisÃ©s (ML,
recherche, traitement lourd).</p>
<h2 id="checklist-de-dÃ©cision">4. Checklist de dÃ©cision</h2>
<h3 id="avant-de-crÃ©er-un-nouveau-module">Avant de crÃ©er un nouveau
module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Est-ce que ce composant nÃ©cessite
une <strong>scalabilitÃ© indÃ©pendante</strong> ? â†’
Microservice</label></li>
<li><label><input type="checkbox" />Est-ce quâ€™il interagit
<strong>frÃ©quemment</strong> avec dâ€™autres modules ? â†’ Module
in-memory</label></li>
<li><label><input type="checkbox" />Est-ce quâ€™il utilise une
<strong>stack diffÃ©rente</strong> (Python, Go) ? â†’
Microservice</label></li>
<li><label><input type="checkbox" />Est-ce quâ€™il gÃ¨re des
<strong>donnÃ©es sensibles isolÃ©es</strong> ? â†’ Ã‰valuer isolation
forte</label></li>
<li><label><input type="checkbox" />Est-ce quâ€™il peut <strong>tomber
sans impacter le core</strong> ? â†’ Microservice optionnel</label></li>
</ul>
<h3 id="avant-dexternaliser-un-module-en-microservice">Avant
dâ€™externaliser un module en microservice</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Le gain en
<strong>scalabilitÃ©</strong> justifie-t-il la complexitÃ© ajoutÃ©e
?</label></li>
<li><label><input type="checkbox" />Peut-on accepter la <strong>latence
rÃ©seau</strong> (5-50ms par appel) ?</label></li>
<li><label><input type="checkbox" />A-t-on les <strong>compÃ©tences
DevOps</strong> pour gÃ©rer le service ?</label></li>
<li><label><input type="checkbox" />Le service est-il
<strong>stateless</strong> ou peut-il lâ€™Ãªtre facilement ?</label></li>
</ul>
<h2 id="Ã -retenir">5. Ã€ retenir</h2>
<ul>
<li>LexOrbital privilÃ©gie les <strong>modules in-memory</strong> pour la
simplicitÃ© et les performances</li>
<li>Les microservices restent pertinents pour les <strong>services
spÃ©cialisÃ©s</strong> (ML, OCR, etc.)</li>
<li>Lâ€™approche modulaire rÃ©duit drastiquement la <strong>complexitÃ©
opÃ©rationnelle</strong></li>
<li>Possible dâ€™Ã©voluer vers un <strong>modÃ¨le hybride</strong> si besoin
futur de scalabilitÃ© hÃ©tÃ©rogÃ¨ne</li>
</ul>
<h2 id="liens-connexes-2">6. Liens connexes</h2>
<ul>
<li>[[01_architecture-orbitale]] : DÃ©tails techniques de lâ€™architecture
modulaire</li>
<li>[[08_modules-types]] : Catalogue des modules et leur pÃ©rimÃ¨tre</li>
<li>[[03_documentation-et-diagrammes-vivants]] : Comment documenter les
dÃ©pendances entre modules</li>
</ul>
<h1 id="fiche-3-documentation-et-diagrammes-vivants">Fiche nÂ°3 :
Documentation &amp; diagrammes vivants</h1>
<blockquote>
<p>La documentation de LexOrbital est <strong>vivante et gÃ©nÃ©rÃ©e
automatiquement</strong> Ã  partir du code, des manifestes et des
Ã©vÃ©nements rÃ©els du systÃ¨me. ZÃ©ro doc obsolÃ¨te, zÃ©ro diagramme manuel Ã 
maintenir.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-3">1. Objectif de la fiche</h2>
<p>PrÃ©senter les principes et outils de documentation automatique de
LexOrbital, avec focus sur les diagrammes vivants (architecture, flux de
donnÃ©es, dÃ©pendances) et la gÃ©nÃ©ration de guides conformitÃ© RGPD.</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-2">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="documentation-traditionnelle-vs-documentation-vivante">2.1.
Documentation traditionnelle vs documentation vivante</h3>
<h4 id="problÃ¨mes-de-la-doc-traditionnelle">ProblÃ¨mes de la doc
traditionnelle</h4>
<ul>
<li>ğŸ“‰ <strong>Obsolescence rapide</strong> : la doc est Ã  jour le jour
de sa rÃ©daction, puis diverge du code</li>
<li>ğŸ¤· <strong>ResponsabilitÃ© floue</strong> : personne nâ€™aime maintenir
la doc</li>
<li>ğŸ” <strong>Recherche difficile</strong> : PDF/Word non indexÃ©s, pas
de liens hypertextes</li>
<li>ğŸ¨ <strong>Diagrammes manuels</strong> : Visio/Draw.io
dÃ©synchronisÃ©s du code</li>
</ul>
<h4 id="principes-de-la-doc-vivante-lexorbital">Principes de la doc
vivante LexOrbital</h4>
<ul>
<li>âœ… <strong>Single source of truth</strong> : le code ET les
manifestes gÃ©nÃ¨rent la doc</li>
<li>âœ… <strong>Diagrammes automatiques</strong> : graphe de dÃ©pendances,
flux RGPD, architecture</li>
<li>âœ… <strong>Mise Ã  jour en CI</strong> : chaque commit rÃ©gÃ©nÃ¨re la
doc</li>
<li>âœ… <strong>Navigation hypertexte</strong> : liens entre modules,
Ã©vÃ©nements, APIs</li>
</ul>
<h3 id="sources-de-vÃ©ritÃ©">2.2. Sources de vÃ©ritÃ©</h3>
<h4 id="manifestes-de-modules-lexorbital.module.json">Manifestes de
modules (<code>lexorbital.module.json</code>)</h4>
<div class="sourceCode" id="cb15"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;auth-module&quot;</span><span class="fu">,</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.2.0&quot;</span><span class="fu">,</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;orbit&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dependencies&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;config-module&quot;</span><span class="ot">,</span> <span class="st">&quot;logger-module&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;provides&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;services&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;AuthService&quot;</span><span class="ot">,</span> <span class="st">&quot;TokenService&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;events&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;user.login&quot;</span><span class="ot">,</span> <span class="st">&quot;user.logout&quot;</span><span class="ot">]</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;consumes&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;events&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;user.created&quot;</span><span class="ot">]</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>â†’ GÃ©nÃ¨re automatiquement : - Graphe de dÃ©pendances (Mermaid/D2) -
Matrice de communication inter-modules - Liste des Ã©vÃ©nements
pub/sub</p>
<h4 id="annotations-typescript-jsdoctsdoc">Annotations TypeScript
(JSDoc/TSDoc)</h4>
<div class="sourceCode" id="cb16"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">/**</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co"> * Authentifie un utilisateur par email/password.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">email</span><span class="co"> - Email de l&#39;utilisateur</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@param</span><span class="co"> </span><span class="cv">password</span><span class="co"> - Mot de passe en clair (sera hashÃ©)</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@returns</span><span class="co"> Token JWT + refresh token</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@throws</span><span class="co"> </span><span class="cv">UnauthorizedException</span><span class="co"> si credentials invalides</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"> * </span><span class="an">@gdpr</span><span class="co"> CrÃ©e un log d&#39;audit avec IP et timestamp</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co"> */</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">login</span>(email<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> password<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> <span class="bu">Promise</span><span class="op">&lt;</span>AuthTokens<span class="op">&gt;</span> {</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// ...</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>â†’ GÃ©nÃ¨re automatiquement : - Documentation API (Swagger/OpenAPI) -
Annotations RGPD (quel endpoint traite quelles donnÃ©es)</p>
<h4 id="Ã©vÃ©nements-runtime-audit-logs">Ã‰vÃ©nements runtime (Audit
logs)</h4>
<div class="sourceCode" id="cb17"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;event&quot;</span><span class="fu">:</span> <span class="st">&quot;document.downloaded&quot;</span><span class="fu">,</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;timestamp&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-11-22T10:30:00Z&quot;</span><span class="fu">,</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;user&quot;</span><span class="fu">:</span> <span class="st">&quot;user-123&quot;</span><span class="fu">,</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;module&quot;</span><span class="fu">:</span> <span class="st">&quot;documents-module&quot;</span><span class="fu">,</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;data&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;documentId&quot;</span><span class="fu">:</span> <span class="st">&quot;doc-456&quot;</span> <span class="fu">},</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;gdpr&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;legalBasis&quot;</span><span class="fu">:</span> <span class="st">&quot;contract&quot;</span><span class="fu">,</span> <span class="dt">&quot;dataSubject&quot;</span><span class="fu">:</span> <span class="st">&quot;user-123&quot;</span> <span class="fu">}</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p>â†’ GÃ©nÃ¨re automatiquement : - Registre des activitÃ©s de traitement
(GDPR Art. 30) - Diagrammes de flux de donnÃ©es rÃ©els</p>
<h3 id="outils-de-gÃ©nÃ©ration">2.3. Outils de gÃ©nÃ©ration</h3>
<table>
<colgroup>
<col style="width: 35%" />
<col style="width: 34%" />
<col style="width: 30%" />
</colgroup>
<thead>
<tr>
<th>Type de doc</th>
<th>Outil principal</th>
<th>Format sortie</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>API REST</strong></td>
<td>Swagger/OpenAPI</td>
<td>HTML interactif</td>
</tr>
<tr>
<td><strong>Graphe de dÃ©pendances</strong></td>
<td>Mermaid / D2</td>
<td>SVG, PNG</td>
</tr>
<tr>
<td><strong>Architecture</strong></td>
<td>C4 Model (Structurizr)</td>
<td>HTML + diagrammes</td>
</tr>
<tr>
<td><strong>Registre RGPD</strong></td>
<td>Custom (TypeScript)</td>
<td>PDF, JSON, HTML</td>
</tr>
<tr>
<td><strong>Guides</strong></td>
<td>Pandoc (Markdown â†’ X)</td>
<td>PDF, DOCX, HTML</td>
</tr>
<tr>
<td><strong>Changelog</strong></td>
<td>Conventional Commits</td>
<td>Markdown (auto)</td>
</tr>
</tbody>
</table>
<h2 id="implications-techniques-2">3. Implications techniques</h2>
<h3 id="pipeline-de-gÃ©nÃ©ration-cicd">3.1. Pipeline de gÃ©nÃ©ration
(CI/CD)</h3>
<pre class="mermaid"><code>graph LR
    A[Commit] --&gt; B[Pre-commit hooks]
    B --&gt; C[Lint + Tests]
    C --&gt; D[Build]
    D --&gt; E[GÃ©nÃ©ration doc]
    E --&gt; F[Deploy docs/]
    
    E --&gt; E1[Swagger API]
    E --&gt; E2[Diagrammes Mermaid]
    E --&gt; E3[Registre RGPD]
    E --&gt; E4[Pandoc HTML/PDF]</code></pre>
<h4 id="script-de-gÃ©nÃ©ration-scriptsgenerate-docs.sh">Script de
gÃ©nÃ©ration (<code>scripts/generate-docs.sh</code>)</h4>
<div class="sourceCode" id="cb19"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. GÃ©nÃ©ration API REST (Swagger)</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run swagger:generate</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Graphe de dÃ©pendances (Mermaid)</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> scripts/generate-dependency-graph.js <span class="op">&gt;</span> docs/generated/dependencies.mmd</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="ex">mmdc</span> <span class="at">-i</span> docs/generated/dependencies.mmd <span class="at">-o</span> docs/generated/dependencies.svg</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. Registre RGPD</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="ex">node</span> scripts/generate-gdpr-register.js <span class="op">&gt;</span> docs/generated/rgpd-register.json</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 4. Guides Pandoc</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> docs</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="at">-o</span> generated/guide.html <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="ex">pandoc</span> <span class="at">-s</span> <span class="at">--toc</span> <span class="at">-o</span> generated/guide.pdf <span class="pp">[</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">][</span><span class="ss">0</span><span class="pp">-</span><span class="ss">9</span><span class="pp">]</span>_<span class="pp">*</span>.md</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;âœ… Documentation gÃ©nÃ©rÃ©e dans docs/generated/&quot;</span></span></code></pre></div>
<h3 id="diagrammes-vivants">3.2. Diagrammes vivants</h3>
<h4 id="graphe-de-dÃ©pendances-mermaid">Graphe de dÃ©pendances
(Mermaid)</h4>
<p>GÃ©nÃ©rÃ© automatiquement depuis les <code>dependencies</code> des
manifestes :</p>
<pre class="mermaid"><code>graph TD
    MetaKernel[Meta-Kernel]
    Auth[auth-module]
    Audit[audit-module]
    Dossiers[dossiers-module]
    Docs[documents-module]
    
    Auth --&gt; MetaKernel
    Audit --&gt; MetaKernel
    Dossiers --&gt; Auth
    Dossiers --&gt; Audit
    Docs --&gt; Auth
    Docs --&gt; Audit
    Docs --&gt; Dossiers</code></pre>
<h4 id="architecture-c4-context-containers-components-code">Architecture
C4 (Context, Containers, Components, Code)</h4>
<p>Utilisation de <strong>Structurizr DSL</strong> pour gÃ©nÃ©rer les 4
niveaux :</p>
<div class="sourceCode" id="cb21"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">// c4/workspace.dsl</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>workspace {</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  model {</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>    user <span class="op">=</span> person <span class="st">&quot;Utilisateur&quot;</span> <span class="st">&quot;Avocat, juriste, assistant&quot;</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    lexorbital <span class="op">=</span> softwareSystem <span class="st">&quot;LexOrbital&quot;</span> {</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>      metaKernel <span class="op">=</span> container <span class="st">&quot;Meta-Kernel&quot;</span> <span class="st">&quot;NestJS&quot;</span> <span class="st">&quot;Orchestration&quot;</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>      authModule <span class="op">=</span> container <span class="st">&quot;Auth Module&quot;</span> <span class="st">&quot;NestJS&quot;</span> <span class="st">&quot;Authentification&quot;</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>      <span class="co">// ...</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    user <span class="op">-&gt;</span> lexorbital <span class="st">&quot;Utilise&quot;</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  views {</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    systemContext lexorbital {</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>      include <span class="op">*</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>    container lexorbital {</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>      include <span class="op">*</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>â†’ GÃ©nÃ¨re des diagrammes interactifs avec Structurizr Cloud ou
local.</p>
<h3 id="registre-rgpd-automatique">3.3. Registre RGPD automatique</h3>
<p>Ã€ partir des manifestes <code>rgpd-manifest.json</code> de chaque
module :</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">// scripts/generate-gdpr-register.ts</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { readdirSync<span class="op">,</span> readFileSync } <span class="im">from</span> <span class="st">&#39;fs&#39;</span><span class="op">;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> modules <span class="op">=</span> <span class="fu">readdirSync</span>(<span class="st">&#39;modules/&#39;</span>)<span class="op">;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> register <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (<span class="kw">const</span> <span class="im">module</span> <span class="dt">of</span> <span class="dt">modules</span>) {</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> manifest <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readFileSync</span>(<span class="vs">`modules/</span><span class="sc">${</span><span class="im">module</span>}/<span class="dt">rgpd</span>-<span class="dt">manifest</span>.<span class="dt">json</span><span class="vs">`, &#39;utf-8&#39;)</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="vs">  );</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="vs">  register.push({</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="vs">    module: module,</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="vs">    dataProcessed: manifest.dataProcessed,</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="vs">    legalBasis: manifest.legalBasis,</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a><span class="vs">    retention: manifest.retention,</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="vs">    // ...</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a><span class="vs">  });</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a><span class="vs">}</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="vs">console.log(JSON.stringify(register, null, 2));</span></span></code></pre></div>
<p>â†’ Sortie : fichier JSON utilisable pour audit CNIL ou export PDF.</p>
<h2 id="checklist-de-mise-en-Å“uvre-1">4. Checklist de mise en Å“uvre</h2>
<ul class="task-list">
<li><label><input type="checkbox" />Configurer <strong>Swagger</strong>
pour gÃ©nÃ©rer lâ€™API REST automatiquement</label></li>
<li><label><input type="checkbox" />CrÃ©er le script
<code>generate-dependency-graph.js</code> (parse les
manifestes)</label></li>
<li><label><input type="checkbox" />Installer <strong>Mermaid
CLI</strong> (<code>mmdc</code>) pour gÃ©nÃ©rer les SVG</label></li>
<li><label><input type="checkbox" />Configurer <strong>Pandoc</strong>
avec templates custom (HTML, PDF)</label></li>
<li><label><input type="checkbox" />CrÃ©er le script
<code>generate-gdpr-register.ts</code> (agrÃ¨ge les manifestes
RGPD)</label></li>
<li><label><input type="checkbox" />Configurer
<strong>Structurizr</strong> pour les diagrammes C4
(optionnel)</label></li>
<li><label><input type="checkbox" />Ajouter un job <strong>GitHub
Actions</strong> pour rÃ©gÃ©nÃ©rer la doc Ã  chaque push</label></li>
<li><label><input type="checkbox" />HÃ©berger la doc sur <strong>GitHub
Pages</strong> ou <strong>Vercel</strong></label></li>
</ul>
<h2 id="Ã -retenir-1">5. Ã€ retenir</h2>
<ul>
<li>La doc LexOrbital est <strong>gÃ©nÃ©rÃ©e</strong>, pas Ã©crite
manuellement</li>
<li>Les <strong>manifestes</strong> sont la source de vÃ©ritÃ©
(dÃ©pendances, RGPD, APIs)</li>
<li>Les <strong>diagrammes</strong> se mettent Ã  jour automatiquement
(Mermaid, C4)</li>
<li>Le <strong>registre RGPD</strong> est produit depuis les
<code>rgpd-manifest.json</code></li>
<li>La <strong>CI/CD</strong> gÃ©nÃ¨re et dÃ©ploie la doc Ã  chaque
commit</li>
</ul>
<h2 id="liens-connexes-3">6. Liens connexes</h2>
<ul>
<li>[[04_manifestes-lexorbital]] : Format des manifestes modules et
RGPD</li>
<li>[[05_rgpd-by-design]] : Patterns techniques pour la conformitÃ©
RGPD</li>
<li>[[06_template-module]] : Structure dâ€™un module
(incl.Â manifestes)</li>
</ul>
<h1 id="fiche-4-manifestes-lexorbital">Fiche nÂ°4 : Manifestes LexOrbital
(module.json, rgpd-manifest.json)</h1>
<blockquote>
<p>Chaque module LexOrbital expose deux manifestes JSON :
<strong><code>lexorbital.module.json</code></strong> (mÃ©tadonnÃ©es
techniques) et <strong><code>rgpd-manifest.json</code></strong>
(dÃ©claration RGPD). Ces fichiers sont la source de vÃ©ritÃ© pour
lâ€™orchestration et la conformitÃ©.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-4">1. Objectif de la fiche</h2>
<p>SpÃ©cifier le format exact des deux manifestes requis pour chaque
module LexOrbital, leur rÃ´le dans lâ€™Ã©cosystÃ¨me et les validations
effectuÃ©es par le Meta-Kernel au chargement.</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-3">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="lexorbital.module.json-carte-didentitÃ©-technique">2.1.
<code>lexorbital.module.json</code> : carte dâ€™identitÃ© technique</h3>
<p>Ce manifeste dÃ©crit <strong>ce que fait le module</strong> et
<strong>comment il sâ€™intÃ¨gre</strong> Ã  la station.</p>
<h4 id="structure-complÃ¨te-avec-annotations">Structure complÃ¨te (avec
annotations)</h4>
<div class="sourceCode" id="cb23"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;$schema&quot;</span><span class="fu">:</span> <span class="st">&quot;https://lexorbital.dev/schemas/module-manifest.v1.json&quot;</span><span class="fu">,</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;auth-module&quot;</span><span class="fu">,</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.2.0&quot;</span><span class="fu">,</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Authentification JWT + RBAC avec support OAuth2&quot;</span><span class="fu">,</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;author&quot;</span><span class="fu">:</span> <span class="st">&quot;LexOrbital Core Team &lt;core@lexorbital.dev&gt;&quot;</span><span class="fu">,</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;license&quot;</span><span class="fu">:</span> <span class="st">&quot;MIT&quot;</span><span class="fu">,</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;orbit&quot;</span><span class="fu">:</span> <span class="dv">1</span><span class="fu">,</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dependencies&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;required&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;config-module&quot;</span><span class="ot">,</span> <span class="st">&quot;logger-module&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;optional&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;notification-module&quot;</span><span class="ot">]</span></span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;provides&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;services&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;AuthService&quot;</span><span class="fu">,</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Service principal d&#39;authentification&quot;</span><span class="fu">,</span></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;methods&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;login&quot;</span><span class="ot">,</span> <span class="st">&quot;logout&quot;</span><span class="ot">,</span> <span class="st">&quot;verifyToken&quot;</span><span class="ot">,</span> <span class="st">&quot;refreshToken&quot;</span><span class="ot">]</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;RBACService&quot;</span><span class="fu">,</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Gestion des rÃ´les et permissions&quot;</span><span class="fu">,</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;methods&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;checkPermission&quot;</span><span class="ot">,</span> <span class="st">&quot;assignRole&quot;</span><span class="ot">]</span></span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb23-29"><a href="#cb23-29" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;events&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb23-30"><a href="#cb23-30" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb23-31"><a href="#cb23-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;user.login&quot;</span><span class="fu">,</span></span>
<span id="cb23-32"><a href="#cb23-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;payload&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;userId&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;timestamp&quot;</span><span class="fu">:</span> <span class="st">&quot;Date&quot;</span><span class="fu">,</span> <span class="dt">&quot;ip&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span> <span class="fu">}</span></span>
<span id="cb23-33"><a href="#cb23-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb23-34"><a href="#cb23-34" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb23-35"><a href="#cb23-35" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;user.logout&quot;</span><span class="fu">,</span></span>
<span id="cb23-36"><a href="#cb23-36" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;payload&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;userId&quot;</span><span class="fu">:</span> <span class="st">&quot;string&quot;</span><span class="fu">,</span> <span class="dt">&quot;timestamp&quot;</span><span class="fu">:</span> <span class="st">&quot;Date&quot;</span> <span class="fu">}</span></span>
<span id="cb23-37"><a href="#cb23-37" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb23-38"><a href="#cb23-38" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb23-39"><a href="#cb23-39" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;endpoints&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb23-40"><a href="#cb23-40" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb23-41"><a href="#cb23-41" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;method&quot;</span><span class="fu">:</span> <span class="st">&quot;POST&quot;</span><span class="fu">,</span></span>
<span id="cb23-42"><a href="#cb23-42" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="st">&quot;/auth/login&quot;</span><span class="fu">,</span></span>
<span id="cb23-43"><a href="#cb23-43" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;Authentification par email/password&quot;</span><span class="fu">,</span></span>
<span id="cb23-44"><a href="#cb23-44" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;public&quot;</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb23-45"><a href="#cb23-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb23-46"><a href="#cb23-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">{</span></span>
<span id="cb23-47"><a href="#cb23-47" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;method&quot;</span><span class="fu">:</span> <span class="st">&quot;POST&quot;</span><span class="fu">,</span></span>
<span id="cb23-48"><a href="#cb23-48" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;path&quot;</span><span class="fu">:</span> <span class="st">&quot;/auth/refresh&quot;</span><span class="fu">,</span></span>
<span id="cb23-49"><a href="#cb23-49" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;description&quot;</span><span class="fu">:</span> <span class="st">&quot;RafraÃ®chissement du token JWT&quot;</span><span class="fu">,</span></span>
<span id="cb23-50"><a href="#cb23-50" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;public&quot;</span><span class="fu">:</span> <span class="kw">true</span></span>
<span id="cb23-51"><a href="#cb23-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb23-52"><a href="#cb23-52" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb23-53"><a href="#cb23-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb23-54"><a href="#cb23-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-55"><a href="#cb23-55" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;consumes&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb23-56"><a href="#cb23-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;events&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;user.created&quot;</span><span class="ot">,</span> <span class="st">&quot;user.updated&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb23-57"><a href="#cb23-57" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;services&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;ConfigService&quot;</span><span class="ot">,</span> <span class="st">&quot;LoggerService&quot;</span><span class="ot">]</span></span>
<span id="cb23-58"><a href="#cb23-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb23-59"><a href="#cb23-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-60"><a href="#cb23-60" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;config&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb23-61"><a href="#cb23-61" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;JWT_SECRET&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;required&quot;</span><span class="fu">:</span> <span class="kw">true</span><span class="fu">,</span> <span class="dt">&quot;type&quot;</span><span class="fu">:</span> <span class="st">&quot;secret&quot;</span> <span class="fu">},</span></span>
<span id="cb23-62"><a href="#cb23-62" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;JWT_EXPIRY&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;required&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span> <span class="dt">&quot;default&quot;</span><span class="fu">:</span> <span class="st">&quot;1h&quot;</span> <span class="fu">},</span></span>
<span id="cb23-63"><a href="#cb23-63" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;OAUTH_ENABLED&quot;</span><span class="fu">:</span> <span class="fu">{</span> <span class="dt">&quot;required&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span> <span class="dt">&quot;default&quot;</span><span class="fu">:</span> <span class="kw">false</span> <span class="fu">}</span></span>
<span id="cb23-64"><a href="#cb23-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb23-65"><a href="#cb23-65" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-66"><a href="#cb23-66" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;health&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb23-67"><a href="#cb23-67" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;endpoint&quot;</span><span class="fu">:</span> <span class="st">&quot;/auth/health&quot;</span><span class="fu">,</span></span>
<span id="cb23-68"><a href="#cb23-68" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;interval&quot;</span><span class="fu">:</span> <span class="dv">30000</span></span>
<span id="cb23-69"><a href="#cb23-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb23-70"><a href="#cb23-70" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb23-71"><a href="#cb23-71" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;repository&quot;</span><span class="fu">:</span> <span class="st">&quot;https://github.com/lexorbital/auth-module&quot;</span><span class="fu">,</span></span>
<span id="cb23-72"><a href="#cb23-72" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;tags&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;auth&quot;</span><span class="ot">,</span> <span class="st">&quot;jwt&quot;</span><span class="ot">,</span> <span class="st">&quot;rbac&quot;</span><span class="ot">,</span> <span class="st">&quot;oauth2&quot;</span><span class="ot">]</span></span>
<span id="cb23-73"><a href="#cb23-73" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="champs-clÃ©s">Champs clÃ©s</h4>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 11%" />
<col style="width: 13%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr>
<th>Champ</th>
<th>Type</th>
<th>Obligatoire</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td>string</td>
<td>âœ…</td>
<td>Nom unique du module (kebab-case)</td>
</tr>
<tr>
<td><code>version</code></td>
<td>semver</td>
<td>âœ…</td>
<td>Version SemVer (ex: <code>1.2.0</code>)</td>
</tr>
<tr>
<td><code>orbit</code></td>
<td>0-3</td>
<td>âœ…</td>
<td>Anneau orbital (0=kernel, 1=core, 2=biz, 3=int)</td>
</tr>
<tr>
<td><code>dependencies</code></td>
<td>object</td>
<td>âœ…</td>
<td>Modules requis/optionnels</td>
</tr>
<tr>
<td><code>provides.services</code></td>
<td>array</td>
<td>âŒ</td>
<td>Services injectables exposÃ©s</td>
</tr>
<tr>
<td><code>provides.events</code></td>
<td>array</td>
<td>âŒ</td>
<td>Ã‰vÃ©nements Ã©mis par le module</td>
</tr>
<tr>
<td><code>provides.endpoints</code></td>
<td>array</td>
<td>âŒ</td>
<td>Routes HTTP exposÃ©es</td>
</tr>
<tr>
<td><code>consumes.events</code></td>
<td>array</td>
<td>âŒ</td>
<td>Ã‰vÃ©nements Ã©coutÃ©s</td>
</tr>
<tr>
<td><code>config</code></td>
<td>object</td>
<td>âŒ</td>
<td>Variables dâ€™environnement attendues</td>
</tr>
<tr>
<td><code>health.endpoint</code></td>
<td>string</td>
<td>âœ…</td>
<td>Endpoint de health check</td>
</tr>
</tbody>
</table>
<h3 id="rgpd-manifest.json-dÃ©claration-rgpd">2.2.
<code>rgpd-manifest.json</code> : dÃ©claration RGPD</h3>
<p>Ce manifeste dÃ©crit <strong>quelles donnÃ©es</strong> le module
traite, <strong>sur quelle base lÃ©gale</strong> et <strong>combien de
temps</strong> elles sont conservÃ©es.</p>
<h4 id="structure-complÃ¨te">Structure complÃ¨te</h4>
<div class="sourceCode" id="cb24"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;$schema&quot;</span><span class="fu">:</span> <span class="st">&quot;https://lexorbital.dev/schemas/rgpd-manifest.v1.json&quot;</span><span class="fu">,</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;module&quot;</span><span class="fu">:</span> <span class="st">&quot;auth-module&quot;</span><span class="fu">,</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;version&quot;</span><span class="fu">:</span> <span class="st">&quot;1.2.0&quot;</span><span class="fu">,</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;controller&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;name&quot;</span><span class="fu">:</span> <span class="st">&quot;Nom de l&#39;organisme&quot;</span><span class="fu">,</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;contact&quot;</span><span class="fu">:</span> <span class="st">&quot;dpo@example.com&quot;</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dataProcessed&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;category&quot;</span><span class="fu">:</span> <span class="st">&quot;IdentitÃ©&quot;</span><span class="fu">,</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;fields&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;email&quot;</span><span class="ot">,</span> <span class="st">&quot;nom&quot;</span><span class="ot">,</span> <span class="st">&quot;prÃ©nom&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;purpose&quot;</span><span class="fu">:</span> <span class="st">&quot;Authentification des utilisateurs&quot;</span><span class="fu">,</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;legalBasis&quot;</span><span class="fu">:</span> <span class="st">&quot;contract&quot;</span><span class="fu">,</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;retention&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;duration&quot;</span><span class="fu">:</span> <span class="st">&quot;5 ans aprÃ¨s dernier login&quot;</span><span class="fu">,</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;afterExpiry&quot;</span><span class="fu">:</span> <span class="st">&quot;anonymisation&quot;</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">},</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;recipients&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;Meta-Kernel (logs)&quot;</span><span class="ot">,</span> <span class="st">&quot;Audit Module&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;transfers&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;rights&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;access&quot;</span><span class="ot">,</span> <span class="st">&quot;rectification&quot;</span><span class="ot">,</span> <span class="st">&quot;deletion&quot;</span><span class="ot">,</span> <span class="st">&quot;portability&quot;</span><span class="ot">]</span></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span><span class="ot">,</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;category&quot;</span><span class="fu">:</span> <span class="st">&quot;DonnÃ©es de connexion&quot;</span><span class="fu">,</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;fields&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;adresse IP&quot;</span><span class="ot">,</span> <span class="st">&quot;user-agent&quot;</span><span class="ot">,</span> <span class="st">&quot;timestamp&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;purpose&quot;</span><span class="fu">:</span> <span class="st">&quot;TraÃ§abilitÃ© et sÃ©curitÃ© (Art. 6.1.f RGPD)&quot;</span><span class="fu">,</span></span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;legalBasis&quot;</span><span class="fu">:</span> <span class="st">&quot;legitimate_interest&quot;</span><span class="fu">,</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;retention&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;duration&quot;</span><span class="fu">:</span> <span class="st">&quot;1 an&quot;</span><span class="fu">,</span></span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;afterExpiry&quot;</span><span class="fu">:</span> <span class="st">&quot;suppression&quot;</span></span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>      <span class="fu">},</span></span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;recipients&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;Audit Module&quot;</span><span class="ot">,</span> <span class="st">&quot;Logger Module&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;transfers&quot;</span><span class="fu">:</span> <span class="kw">null</span><span class="fu">,</span></span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;rights&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;access&quot;</span><span class="ot">,</span> <span class="st">&quot;deletion&quot;</span><span class="ot">]</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dataSharing&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;with&quot;</span><span class="fu">:</span> <span class="st">&quot;audit-module&quot;</span><span class="fu">,</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;what&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;userId&quot;</span><span class="ot">,</span> <span class="st">&quot;timestamp&quot;</span><span class="ot">,</span> <span class="st">&quot;action&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;why&quot;</span><span class="fu">:</span> <span class="st">&quot;Logs d&#39;audit immuables&quot;</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;securityMeasures&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Hashage bcrypt des mots de passe (coÃ»t 12)&quot;</span><span class="ot">,</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Tokens JWT signÃ©s (RS256)&quot;</span><span class="ot">,</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Rate limiting sur /auth/login (10 req/min)&quot;</span><span class="ot">,</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Logs d&#39;accÃ¨s anonymisÃ©s (IP masquÃ©e aprÃ¨s 24h)&quot;</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dpia&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;required&quot;</span><span class="fu">:</span> <span class="kw">false</span><span class="fu">,</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;reason&quot;</span><span class="fu">:</span> <span class="st">&quot;Pas de traitement Ã  grande Ã©chelle de donnÃ©es sensibles&quot;</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">},</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;lastUpdated&quot;</span><span class="fu">:</span> <span class="st">&quot;2025-11-22&quot;</span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="bases-lÃ©gales-rgpd-enum">Bases lÃ©gales RGPD (enum)</h4>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 14%" />
<col style="width: 53%" />
</colgroup>
<thead>
<tr>
<th>Valeur</th>
<th>Art. RGPD</th>
<th>Usage LexOrbital</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>consent</code></td>
<td>6.1.a</td>
<td>Inscription newsletter, cookies non-essentiels</td>
</tr>
<tr>
<td><code>contract</code></td>
<td>6.1.b</td>
<td>DonnÃ©es nÃ©cessaires au service</td>
</tr>
<tr>
<td><code>legal_obligation</code></td>
<td>6.1.c</td>
<td>Conservation factures (obligation lÃ©gale)</td>
</tr>
<tr>
<td><code>vital_interest</code></td>
<td>6.1.d</td>
<td>Rarement utilisÃ© (urgence vitale)</td>
</tr>
<tr>
<td><code>public_interest</code></td>
<td>6.1.e</td>
<td>Missions de service public</td>
</tr>
<tr>
<td><code>legitimate_interest</code></td>
<td>6.1.f</td>
<td>Logs de sÃ©curitÃ©, dÃ©tection fraude</td>
</tr>
</tbody>
</table>
<h2 id="implications-techniques-3">3. Implications techniques</h2>
<h3 id="validation-au-chargement-meta-kernel">3.1. Validation au
chargement (Meta-Kernel)</h3>
<p>Lors du <code>onModuleInit()</code>, le Meta-Kernel :</p>
<ol type="1">
<li><strong>Parse le manifeste</strong> et vÃ©rifie la prÃ©sence des
champs obligatoires</li>
<li><strong>VÃ©rifie les dÃ©pendances</strong> : tous les modules
<code>required</code> sont-ils chargÃ©s ?</li>
<li><strong>Valide le schÃ©ma JSON</strong> avec JSON Schema
($schema)</li>
<li><strong>Enregistre les services/Ã©vÃ©nements</strong> dans le registre
global</li>
<li><strong>Configure le health check</strong> (polling du
endpoint)</li>
</ol>
<div class="sourceCode" id="cb25"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">// meta-kernel/src/core/module-loader.service.ts</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">loadModule</span>(modulePath<span class="op">:</span> <span class="dt">string</span>) {</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> manifest <span class="op">=</span> <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">readFileSync</span>(<span class="vs">`</span><span class="sc">${</span>modulePath<span class="sc">}</span><span class="vs">/lexorbital.module.json`</span><span class="op">,</span> <span class="st">&#39;utf-8&#39;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  )<span class="op">;</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Validation</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>manifest<span class="op">.</span><span class="at">name</span> <span class="op">||</span> <span class="op">!</span>manifest<span class="op">.</span><span class="at">version</span> <span class="op">||</span> <span class="op">!</span>manifest<span class="op">.</span><span class="at">orbit</span>) {</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="vs">`Manifeste invalide pour </span><span class="sc">${</span>modulePath<span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="co">// VÃ©rification dÃ©pendances</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> dep <span class="kw">of</span> manifest<span class="op">.</span><span class="at">dependencies</span><span class="op">.</span><span class="at">required</span>) {</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="at">loadedModules</span><span class="op">.</span><span class="fu">has</span>(dep)) {</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">throw</span> <span class="kw">new</span> <span class="bu">Error</span>(<span class="vs">`DÃ©pendance manquante : </span><span class="sc">${</span>dep<span class="sc">}</span><span class="vs"> requis par </span><span class="sc">${</span>manifest<span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Chargement dynamique</span></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> <span class="im">module</span> = <span class="dt">await</span> <span class="dt">import</span>(<span class="vs">`</span><span class="sc">${</span>modulePath<span class="sc">}</span><span class="vs">/src/index.ts`</span>)<span class="op">;</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">loadedModules</span><span class="op">.</span><span class="fu">set</span>(manifest<span class="op">.</span><span class="at">name</span><span class="op">,</span> { manifest<span class="op">,</span> <span class="im">module</span> })<span class="op">;</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Enregistrement health check</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">healthService</span><span class="op">.</span><span class="fu">register</span>(manifest<span class="op">.</span><span class="at">name</span><span class="op">,</span> manifest<span class="op">.</span><span class="at">health</span><span class="op">.</span><span class="at">endpoint</span>)<span class="op">;</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="gÃ©nÃ©ration-automatique-de-documentation">3.2. GÃ©nÃ©ration
automatique de documentation</h3>
<p>Les manifestes sont utilisÃ©s pour gÃ©nÃ©rer :</p>
<ul>
<li><strong>Graphe de dÃ©pendances</strong> (Mermaid) â†’ via
<code>dependencies</code></li>
<li><strong>Registre RGPD</strong> (PDF/JSON) â†’ via
<code>rgpd-manifest.json</code></li>
<li><strong>API REST</strong> (Swagger) â†’ via
<code>provides.endpoints</code></li>
<li><strong>Matrice Pub/Sub</strong> â†’ via <code>provides.events</code>
+ <code>consumes.events</code></li>
</ul>
<p>Exemple de script de gÃ©nÃ©ration :</p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">// scripts/generate-dependency-graph.ts</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { readdirSync<span class="op">,</span> readFileSync } <span class="im">from</span> <span class="st">&#39;fs&#39;</span><span class="op">;</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> modules <span class="op">=</span> <span class="fu">readdirSync</span>(<span class="st">&#39;modules/&#39;</span>)<span class="op">.</span><span class="fu">map</span>(dir <span class="kw">=&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="bu">JSON</span><span class="op">.</span><span class="fu">parse</span>(<span class="fu">readFileSync</span>(<span class="vs">`modules/</span><span class="sc">${</span>dir<span class="sc">}</span><span class="vs">/lexorbital.module.json`</span><span class="op">,</span> <span class="st">&#39;utf-8&#39;</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)<span class="op">;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;```mermaid</span><span class="sc">\n</span><span class="st">graph TD&#39;</span>)<span class="op">;</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>modules<span class="op">.</span><span class="fu">forEach</span>(m <span class="kw">=&gt;</span> {</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  m<span class="op">.</span><span class="at">dependencies</span><span class="op">?.</span><span class="at">required</span><span class="op">?.</span><span class="fu">forEach</span>(dep <span class="kw">=&gt;</span> {</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="vs">`  </span><span class="sc">${</span>dep<span class="sc">}</span><span class="vs"> --&gt; </span><span class="sc">${</span>m<span class="op">.</span><span class="at">name</span><span class="sc">}</span><span class="vs">`</span>)<span class="op">;</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a><span class="bu">console</span><span class="op">.</span><span class="fu">log</span>(<span class="st">&#39;```&#39;</span>)<span class="op">;</span></span></code></pre></div>
<h2 id="checklist-de-mise-en-Å“uvre-2">4. Checklist de mise en Å“uvre</h2>
<h3 id="pour-crÃ©er-un-nouveau-module">Pour crÃ©er un nouveau module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Copier le template depuis
<code>lexorbital-template-module</code></label></li>
<li><label><input type="checkbox" />Remplir
<code>lexorbital.module.json</code> (name, version, orbit,
dependencies)</label></li>
<li><label><input type="checkbox" />Remplir
<code>rgpd-manifest.json</code> (dataProcessed, legalBasis,
retention)</label></li>
<li><label><input type="checkbox" />Valider les manifestes avec JSON
Schema (<code>npm run validate:manifests</code>)</label></li>
<li><label><input type="checkbox" />ImplÃ©menter le endpoint de health
check (<code>/health</code>)</label></li>
<li><label><input type="checkbox" />Tester le chargement dans le
Meta-Kernel</label></li>
</ul>
<h3 id="pour-le-meta-kernel">Pour le Meta-Kernel</h3>
<ul class="task-list">
<li><label><input type="checkbox" />ImplÃ©menter
<code>ModuleLoader.loadModule()</code> avec validation de
manifeste</label></li>
<li><label><input type="checkbox" />CrÃ©er le registre global des
services/Ã©vÃ©nements</label></li>
<li><label><input type="checkbox" />ImplÃ©menter le health check
aggregator</label></li>
<li><label><input type="checkbox" />GÃ©nÃ©rer la doc automatique depuis
les manifestes (CI)</label></li>
</ul>
<h2 id="Ã -retenir-2">5. Ã€ retenir</h2>
<ul>
<li><strong>Deux manifestes obligatoires</strong> :
<code>lexorbital.module.json</code> +
<code>rgpd-manifest.json</code></li>
<li>Le Meta-Kernel <strong>valide</strong> les manifestes au chargement
(fail-fast)</li>
<li>Les manifestes sont la <strong>source de vÃ©ritÃ©</strong> pour la doc
et les diagrammes</li>
<li>La conformitÃ© RGPD est <strong>dÃ©clarative</strong> (pas de code Ã 
Ã©crire)</li>
<li>Les manifestes permettent lâ€™<strong>auto-dÃ©couverte</strong> des
modules (plugâ€™nâ€™play)</li>
</ul>
<h2 id="liens-connexes-4">6. Liens connexes</h2>
<ul>
<li>[[01_architecture-orbitale]] : RÃ´le du Meta-Kernel dans
lâ€™orchestration</li>
<li>[[03_documentation-et-diagrammes-vivants]] : GÃ©nÃ©ration doc depuis
manifestes</li>
<li>[[05_rgpd-by-design]] : Patterns techniques RGPD</li>
<li>[[06_template-module]] : Template de module avec manifestes
prÃ©-remplis</li>
</ul>
<h1 id="fiche-5-rgpd-by-design">Fiche nÂ°5 : RGPD by design â€“ patterns
techniques</h1>
<blockquote>
<p>La conformitÃ© RGPD nâ€™est pas une couche ajoutÃ©e a posteriori, mais
<strong>intÃ©grÃ©e nativement</strong> dans lâ€™architecture LexOrbital via
des patterns techniques rÃ©utilisables (audit immutable, anonymisation,
retention policies).</p>
</blockquote>
<h2 id="objectif-de-la-fiche-5">1. Objectif de la fiche</h2>
<p>PrÃ©senter les patterns techniques concrets pour implÃ©menter le RGPD
by design dans les modules LexOrbital : traÃ§abilitÃ©, pseudonymisation,
durÃ©es de rÃ©tention, droits des personnes (DSAR).</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-4">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="principe-privacy-by-design-by-default">2.1. Principe : Privacy
by Design &amp; by Default</h3>
<p><strong>Privacy by Design</strong> (Art. 25 RGPD) : intÃ©grer la
protection des donnÃ©es <strong>dÃ¨s la conception</strong> du systÃ¨me,
pas en retrofit.</p>
<p><strong>Privacy by Default</strong> : les paramÃ¨tres par dÃ©faut
doivent minimiser le traitement de donnÃ©es (principe de
minimisation).</p>
<h3 id="les-7-piliers-rgpd-de-lexorbital">2.2. Les 7 piliers RGPD de
LexOrbital</h3>
<table>
<colgroup>
<col style="width: 31%" />
<col style="width: 68%" />
</colgroup>
<thead>
<tr>
<th>Principe RGPD</th>
<th>ImplÃ©mentation LexOrbital</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>LicÃ©itÃ©</strong></td>
<td>Base lÃ©gale dÃ©clarÃ©e dans <code>rgpd-manifest.json</code></td>
</tr>
<tr>
<td><strong>Minimisation</strong></td>
<td>Collecte uniquement les champs nÃ©cessaires</td>
</tr>
<tr>
<td><strong>Exactitude</strong></td>
<td>Validation + droit de rectification</td>
</tr>
<tr>
<td><strong>Limitation de conservation</strong></td>
<td>Retention policies automatiques</td>
</tr>
<tr>
<td><strong>IntÃ©gritÃ©/ConfidentialitÃ©</strong></td>
<td>Chiffrement + audit logs</td>
</tr>
<tr>
<td><strong>Transparence</strong></td>
<td>Registre RGPD gÃ©nÃ©rÃ© automatiquement</td>
</tr>
<tr>
<td><strong>Droits des personnes</strong></td>
<td>API DSAR (accÃ¨s, rectification, suppression)</td>
</tr>
</tbody>
</table>
<h2 id="patterns-techniques">3. Patterns techniques</h2>
<h3 id="audit-immutable-event-sourcing">3.1. Audit immutable (Event
Sourcing)</h3>
<p>Chaque action sur une donnÃ©e personnelle gÃ©nÃ¨re un <strong>Ã©vÃ©nement
immuable</strong> stockÃ© dans le module <code>audit-module</code>.</p>
<h4 id="exemple-login-utilisateur">Exemple : login utilisateur</h4>
<div class="sourceCode" id="cb27"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">// auth-module/src/auth.service.ts</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">login</span>(email<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> password<span class="op">:</span> <span class="dt">string</span><span class="op">,</span> context<span class="op">:</span> RequestContext) {</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Logique d&#39;authentification</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> user <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">validateCredentials</span>(email<span class="op">,</span> password)<span class="op">;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Ã‰mission d&#39;un Ã©vÃ©nement d&#39;audit</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">eventBus</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;gdpr.data_access&#39;</span><span class="op">,</span> {</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>    timestamp<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    userId<span class="op">:</span> user<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>    action<span class="op">:</span> <span class="st">&#39;login&#39;</span><span class="op">,</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>    dataSubject<span class="op">:</span> user<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    legalBasis<span class="op">:</span> <span class="st">&#39;contract&#39;</span><span class="op">,</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    module<span class="op">:</span> <span class="st">&#39;auth-module&#39;</span><span class="op">,</span></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    ip<span class="op">:</span> context<span class="op">.</span><span class="at">ip</span><span class="op">,</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    userAgent<span class="op">:</span> context<span class="op">.</span><span class="at">userAgent</span><span class="op">,</span></span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="fu">generateTokens</span>(user)<span class="op">;</span></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="stockage-dans-audit-module">Stockage dans
<code>audit-module</code></h4>
<div class="sourceCode" id="cb28"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">// audit-module/src/audit.service.ts</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>@<span class="fu">OnEvent</span>(<span class="st">&#39;gdpr.data_access&#39;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">handleDataAccess</span>(event<span class="op">:</span> GDPREvent) {</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Insertion dans table append-only (jamais de UPDATE/DELETE)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="at">auditRepository</span><span class="op">.</span><span class="fu">insert</span>({</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    id<span class="op">:</span> <span class="fu">uuidv4</span>()<span class="op">,</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    timestamp<span class="op">:</span> <span class="bu">event</span><span class="op">.</span><span class="at">timestamp</span><span class="op">,</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    userId<span class="op">:</span> <span class="bu">event</span><span class="op">.</span><span class="at">userId</span><span class="op">,</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    action<span class="op">:</span> <span class="bu">event</span><span class="op">.</span><span class="at">action</span><span class="op">,</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    module<span class="op">:</span> <span class="bu">event</span><span class="op">.</span><span class="at">module</span><span class="op">,</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>    ip<span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="fu">pseudonymize</span>(<span class="bu">event</span><span class="op">.</span><span class="at">ip</span>)<span class="op">,</span> <span class="co">// Pseudonymisation IP</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>PropriÃ©tÃ©s</strong> : - âœ… Table <strong>append-only</strong>
(pas de UPDATE/DELETE possible) - âœ… Hash de chaÃ®nage pour dÃ©tecter les
modifications (blockchain-like) - âœ… RÃ©tention automatique (archive
aprÃ¨s 1 an, suppression aprÃ¨s 5 ans)</p>
<h3 id="pseudonymisation-anonymisation">3.2. Pseudonymisation &amp;
Anonymisation</h3>
<h4 id="pseudonymisation-rÃ©versible">Pseudonymisation (rÃ©versible)</h4>
<p>Remplacer lâ€™identifiant rÃ©el par un hash <strong>rÃ©versible</strong>
(avec clÃ© secrÃ¨te).</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co">// crypto.service.ts</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { createHmac } <span class="im">from</span> <span class="st">&#39;crypto&#39;</span><span class="op">;</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pseudonymize</span>(value<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> <span class="dt">string</span> {</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> secret <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">configService</span><span class="op">.</span><span class="fu">get</span>(<span class="st">&#39;PSEUDONYMIZATION_SECRET&#39;</span>)<span class="op">;</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> <span class="fu">createHmac</span>(<span class="st">&#39;sha256&#39;</span><span class="op">,</span> secret)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">update</span>(value)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">digest</span>(<span class="st">&#39;hex&#39;</span>)<span class="op">;</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Usage</strong> : logs, analytics, reporting (on peut
re-identifier si besoin lÃ©gal).</p>
<h4 id="anonymisation-irrÃ©versible">Anonymisation (irrÃ©versible)</h4>
<p>Supprimer toute possibilitÃ© de rÃ©-identification.</p>
<div class="sourceCode" id="cb30"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anonymize</span>(user<span class="op">:</span> User)<span class="op">:</span> AnonymizedUser {</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>    id<span class="op">:</span> <span class="st">&#39;anonymized-&#39;</span> <span class="op">+</span> <span class="fu">uuidv4</span>()<span class="op">,</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>    email<span class="op">:</span> <span class="dt">null</span><span class="op">,</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    nom<span class="op">:</span> <span class="dt">null</span><span class="op">,</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    prÃ©nom<span class="op">:</span> <span class="dt">null</span><span class="op">,</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    dateCreation<span class="op">:</span> user<span class="op">.</span><span class="at">dateCreation</span><span class="op">.</span><span class="fu">toISOString</span>()<span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="dv">7</span>)<span class="op">,</span> <span class="co">// &quot;2025-11&quot; (mois seulement)</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ...</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><strong>Usage</strong> : aprÃ¨s expiration de la durÃ©e de
rÃ©tention.</p>
<h3 id="retention-policies-automatiques">3.3. Retention Policies
automatiques</h3>
<p>Chaque module dÃ©clare ses durÃ©es de rÃ©tention dans
<code>rgpd-manifest.json</code>, et un <strong>cron job</strong>
applique les politiques.</p>
<h4 id="dÃ©claration-dans-le-manifeste">DÃ©claration dans le
manifeste</h4>
<div class="sourceCode" id="cb31"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;dataProcessed&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">{</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;category&quot;</span><span class="fu">:</span> <span class="st">&quot;Dossiers clients&quot;</span><span class="fu">,</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">&quot;retention&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;duration&quot;</span><span class="fu">:</span> <span class="st">&quot;10 ans aprÃ¨s clÃ´ture du dossier&quot;</span><span class="fu">,</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>        <span class="dt">&quot;afterExpiry&quot;</span><span class="fu">:</span> <span class="st">&quot;archivage&quot;</span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">}</span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">}</span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4 id="implÃ©mentation-du-cron">ImplÃ©mentation du cron</h4>
<div class="sourceCode" id="cb32"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co">// retention-policy.service.ts</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Cron</span>(<span class="st">&#39;0 2 * * *&#39;</span>) <span class="co">// Tous les jours Ã  2h du matin</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">applyRetentionPolicies</span>() {</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> modules <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="at">metaKernel</span><span class="op">.</span><span class="fu">getLoadedModules</span>()<span class="op">;</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> <span class="im">module</span> <span class="dt">of</span> <span class="dt">modules</span>) {</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> manifest <span class="op">=</span> module<span class="op">.</span><span class="at">rgpdManifest</span><span class="op">;</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (<span class="kw">const</span> data <span class="kw">of</span> manifest<span class="op">.</span><span class="at">dataProcessed</span>) {</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>      <span class="kw">const</span> expiryDate <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">calculateExpiryDate</span>(data<span class="op">.</span><span class="at">retention</span><span class="op">.</span><span class="at">duration</span>)<span class="op">;</span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span> (data<span class="op">.</span><span class="at">retention</span><span class="op">.</span><span class="at">afterExpiry</span> <span class="op">===</span> <span class="st">&#39;deletion&#39;</span>) {</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">deleteExpiredData</span>(module<span class="op">.</span><span class="at">name</span><span class="op">,</span> data<span class="op">.</span><span class="at">category</span><span class="op">,</span> expiryDate)<span class="op">;</span></span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (data<span class="op">.</span><span class="at">retention</span><span class="op">.</span><span class="at">afterExpiry</span> <span class="op">===</span> <span class="st">&#39;anonymisation&#39;</span>) {</span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">anonymizeExpiredData</span>(module<span class="op">.</span><span class="at">name</span><span class="op">,</span> data<span class="op">.</span><span class="at">category</span><span class="op">,</span> expiryDate)<span class="op">;</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>      } <span class="cf">else</span> <span class="cf">if</span> (data<span class="op">.</span><span class="at">retention</span><span class="op">.</span><span class="at">afterExpiry</span> <span class="op">===</span> <span class="st">&#39;archivage&#39;</span>) {</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">archiveExpiredData</span>(module<span class="op">.</span><span class="at">name</span><span class="op">,</span> data<span class="op">.</span><span class="at">category</span><span class="op">,</span> expiryDate)<span class="op">;</span></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="dsar-api-data-subject-access-rights">3.4. DSAR API (Data Subject
Access Rights)</h3>
<p>API unifiÃ©e pour les <strong>droits des personnes</strong> (accÃ¨s,
rectification, suppression, portabilitÃ©).</p>
<h4 id="endpoint-droit-daccÃ¨s-art.-15-rgpd">Endpoint : Droit dâ€™accÃ¨s
(Art. 15 RGPD)</h4>
<div class="sourceCode" id="cb33"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">// gdpr.controller.ts</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Get</span>(<span class="st">&#39;/gdpr/my-data&#39;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>@<span class="fu">UseGuards</span>(JwtAuthGuard)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">getMyData</span>(@<span class="fu">CurrentUser</span>() user<span class="op">:</span> User) {</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> data <span class="op">=</span> {}<span class="op">;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">// AgrÃ©gation des donnÃ©es depuis tous les modules</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> modules <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="at">metaKernel</span><span class="op">.</span><span class="fu">getLoadedModules</span>()<span class="op">;</span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> <span class="im">module</span> <span class="dt">of</span> <span class="dt">modules</span>) {</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> moduleData <span class="op">=</span> <span class="cf">await</span> module<span class="op">.</span><span class="at">instance</span><span class="op">.</span><span class="fu">getPersonalData</span>(user<span class="op">.</span><span class="at">id</span>)<span class="op">;</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    data[module<span class="op">.</span><span class="at">name</span>] <span class="op">=</span> moduleData<span class="op">;</span></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Audit de l&#39;accÃ¨s</span></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">eventBus</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;gdpr.data_access_request&#39;</span><span class="op">,</span> {</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    userId<span class="op">:</span> user<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>    timestamp<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span></span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>    modules<span class="op">:</span> modules<span class="op">.</span><span class="fu">map</span>(m <span class="kw">=&gt;</span> m<span class="op">.</span><span class="at">name</span>)<span class="op">,</span></span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> {</span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a>    user<span class="op">:</span> user<span class="op">,</span></span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    data<span class="op">:</span> data<span class="op">,</span></span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a>    exportedAt<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a>    format<span class="op">:</span> <span class="st">&#39;JSON&#39;</span><span class="op">,</span></span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>  }<span class="op">;</span></span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h4 id="endpoint-droit-Ã -leffacement-art.-17-rgpd">Endpoint : Droit Ã 
lâ€™effacement (Art. 17 RGPD)</h4>
<div class="sourceCode" id="cb34"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>@<span class="fu">Delete</span>(<span class="st">&#39;/gdpr/delete-my-data&#39;</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>@<span class="fu">UseGuards</span>(JwtAuthGuard)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">async</span> <span class="fu">deleteMyData</span>(@<span class="fu">CurrentUser</span>() user<span class="op">:</span> User) {</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">// VÃ©rification : peut-on supprimer ? (obligation lÃ©gale ?)</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> canDelete <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="fu">checkDeletionEligibility</span>(user<span class="op">.</span><span class="at">id</span>)<span class="op">;</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="op">!</span>canDelete) {</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">throw</span> <span class="kw">new</span> <span class="fu">ForbiddenException</span>(<span class="st">&#39;Suppression impossible (obligation lÃ©gale de conservation)&#39;</span>)<span class="op">;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Suppression cascadÃ©e dans tous les modules</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> modules <span class="op">=</span> <span class="cf">await</span> <span class="kw">this</span><span class="op">.</span><span class="at">metaKernel</span><span class="op">.</span><span class="fu">getLoadedModules</span>()<span class="op">;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (<span class="kw">const</span> <span class="im">module</span> <span class="dt">of</span> <span class="dt">modules</span>) {</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> module<span class="op">.</span><span class="at">instance</span><span class="op">.</span><span class="fu">deletePersonalData</span>(user<span class="op">.</span><span class="at">id</span>)<span class="op">;</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="co">// Audit de la suppression</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="kw">this</span><span class="op">.</span><span class="at">eventBus</span><span class="op">.</span><span class="fu">emit</span>(<span class="st">&#39;gdpr.data_deletion&#39;</span><span class="op">,</span> {</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>    userId<span class="op">:</span> user<span class="op">.</span><span class="at">id</span><span class="op">,</span></span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>    timestamp<span class="op">:</span> <span class="kw">new</span> <span class="bu">Date</span>()<span class="op">,</span></span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> { success<span class="op">:</span> <span class="kw">true</span><span class="op">,</span> message<span class="op">:</span> <span class="st">&#39;DonnÃ©es supprimÃ©es avec succÃ¨s&#39;</span> }<span class="op">;</span></span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h3 id="chiffrement-des-donnÃ©es-sensibles">3.5. Chiffrement des donnÃ©es
sensibles</h3>
<h4 id="chiffrement-au-repos-database">Chiffrement au repos
(Database)</h4>
<p>Utiliser les fonctionnalitÃ©s natives de PostgreSQL :</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode sql"><code class="sourceCode sql"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co">-- Activer pgcrypto</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> EXTENSION <span class="cf">IF</span> <span class="kw">NOT</span> <span class="kw">EXISTS</span> pgcrypto;</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="co">-- Chiffrer une colonne</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="kw">CREATE</span> <span class="kw">TABLE</span> users (</span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">id</span> UUID <span class="kw">PRIMARY</span> <span class="kw">KEY</span>,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>  email TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>  password_hash TEXT <span class="kw">NOT</span> <span class="kw">NULL</span>,</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>  ssn TEXT, <span class="co">-- NumÃ©ro de sÃ©curitÃ© sociale (sensible)</span></span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  ssn_encrypted BYTEA <span class="kw">GENERATED</span> ALWAYS <span class="kw">AS</span> (</span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>    pgp_sym_encrypt(ssn, current_setting(<span class="st">&#39;app.encryption_key&#39;</span>))</span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  ) STORED</span>
<span id="cb35-13"><a href="#cb35-13" aria-hidden="true" tabindex="-1"></a>);</span></code></pre></div>
<h4 id="chiffrement-en-transit">Chiffrement en transit</h4>
<ul>
<li><strong>TLS 1.3</strong> obligatoire pour toutes les connexions
HTTP</li>
<li><strong>Mutual TLS</strong> pour les communications entre modules
(si externalisation future)</li>
</ul>
<h4 id="chiffrement-applicatif-pour-donnÃ©es-trÃ¨s-sensibles">Chiffrement
applicatif (pour donnÃ©es trÃ¨s sensibles)</h4>
<div class="sourceCode" id="cb36"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { createCipheriv<span class="op">,</span> createDecipheriv<span class="op">,</span> randomBytes } <span class="im">from</span> <span class="st">&#39;crypto&#39;</span><span class="op">;</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> EncryptionService {</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> algorithm <span class="op">=</span> <span class="st">&#39;aes-256-gcm&#39;</span><span class="op">;</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="kw">private</span> key <span class="op">=</span> <span class="bu">Buffer</span><span class="op">.</span><span class="fu">from</span>(<span class="bu">process</span><span class="op">.</span><span class="at">env</span><span class="op">.</span><span class="at">ENCRYPTION_KEY</span><span class="op">,</span> <span class="st">&#39;hex&#39;</span>)<span class="op">;</span> <span class="co">// 32 bytes</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">encrypt</span>(plaintext<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> <span class="dt">string</span> {</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> iv <span class="op">=</span> <span class="fu">randomBytes</span>(<span class="dv">16</span>)<span class="op">;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> cipher <span class="op">=</span> <span class="fu">createCipheriv</span>(<span class="kw">this</span><span class="op">.</span><span class="at">algorithm</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">key</span><span class="op">,</span> iv)<span class="op">;</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> encrypted <span class="op">=</span> cipher<span class="op">.</span><span class="fu">update</span>(plaintext<span class="op">,</span> <span class="st">&#39;utf8&#39;</span><span class="op">,</span> <span class="st">&#39;hex&#39;</span>)<span class="op">;</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    encrypted <span class="op">+=</span> cipher<span class="op">.</span><span class="fu">final</span>(<span class="st">&#39;hex&#39;</span>)<span class="op">;</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> authTag <span class="op">=</span> cipher<span class="op">.</span><span class="fu">getAuthTag</span>()<span class="op">;</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="vs">`</span><span class="sc">${</span>iv<span class="op">.</span><span class="fu">toString</span>(<span class="st">&#39;hex&#39;</span>)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span>authTag<span class="op">.</span><span class="fu">toString</span>(<span class="st">&#39;hex&#39;</span>)<span class="sc">}</span><span class="vs">:</span><span class="sc">${</span>encrypted<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">decrypt</span>(ciphertext<span class="op">:</span> <span class="dt">string</span>)<span class="op">:</span> <span class="dt">string</span> {</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> [ivHex<span class="op">,</span> authTagHex<span class="op">,</span> encrypted] <span class="op">=</span> ciphertext<span class="op">.</span><span class="fu">split</span>(<span class="st">&#39;:&#39;</span>)<span class="op">;</span></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> iv <span class="op">=</span> <span class="bu">Buffer</span><span class="op">.</span><span class="fu">from</span>(ivHex<span class="op">,</span> <span class="st">&#39;hex&#39;</span>)<span class="op">;</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> authTag <span class="op">=</span> <span class="bu">Buffer</span><span class="op">.</span><span class="fu">from</span>(authTagHex<span class="op">,</span> <span class="st">&#39;hex&#39;</span>)<span class="op">;</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> decipher <span class="op">=</span> <span class="fu">createDecipheriv</span>(<span class="kw">this</span><span class="op">.</span><span class="at">algorithm</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">key</span><span class="op">,</span> iv)<span class="op">;</span></span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>    decipher<span class="op">.</span><span class="fu">setAuthTag</span>(authTag)<span class="op">;</span></span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>    <span class="kw">let</span> decrypted <span class="op">=</span> decipher<span class="op">.</span><span class="fu">update</span>(encrypted<span class="op">,</span> <span class="st">&#39;hex&#39;</span><span class="op">,</span> <span class="st">&#39;utf8&#39;</span>)<span class="op">;</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>    decrypted <span class="op">+=</span> decipher<span class="op">.</span><span class="fu">final</span>(<span class="st">&#39;utf8&#39;</span>)<span class="op">;</span></span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> decrypted<span class="op">;</span></span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<h2 id="checklist-de-mise-en-Å“uvre-3">4. Checklist de mise en Å“uvre</h2>
<h3 id="pour-chaque-module">Pour chaque module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />DÃ©clarer les donnÃ©es traitÃ©es dans
<code>rgpd-manifest.json</code></label></li>
<li><label><input type="checkbox" />Ã‰mettre un Ã©vÃ©nement
<code>gdpr.*</code> pour chaque accÃ¨s/modification de donnÃ©es
perso</label></li>
<li><label><input type="checkbox" />ImplÃ©menter
<code>getPersonalData(userId)</code> pour le droit dâ€™accÃ¨s</label></li>
<li><label><input type="checkbox" />ImplÃ©menter
<code>deletePersonalData(userId)</code> pour le droit Ã 
lâ€™effacement</label></li>
<li><label><input type="checkbox" />Configurer les retention policies
(cron ou manuel)</label></li>
<li><label><input type="checkbox" />Chiffrer les donnÃ©es sensibles
(AES-256-GCM)</label></li>
</ul>
<h3 id="pour-le-meta-kernel-1">Pour le Meta-Kernel</h3>
<ul class="task-list">
<li><label><input type="checkbox" />CrÃ©er le <code>GDPRService</code>
centralisant les DSAR</label></li>
<li><label><input type="checkbox" />ImplÃ©menter le cron de retention
policies</label></li>
<li><label><input type="checkbox" />Configurer lâ€™audit module (event
sourcing)</label></li>
<li><label><input type="checkbox" />GÃ©nÃ©rer le registre RGPD automatique
(PDF export)</label></li>
</ul>
<h3 id="pour-la-conformitÃ©">Pour la conformitÃ©</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Mapper chaque traitement Ã  une base
lÃ©gale (Art. 6 RGPD)</label></li>
<li><label><input type="checkbox" />VÃ©rifier les durÃ©es de rÃ©tention
(lÃ©gales + mÃ©tier)</label></li>
<li><label><input type="checkbox" />Tester les endpoints DSAR (accÃ¨s,
suppression, portabilitÃ©)</label></li>
<li><label><input type="checkbox" />RÃ©aliser une DPIA si traitement Ã 
risque Ã©levÃ©</label></li>
</ul>
<h2 id="Ã -retenir-3">5. Ã€ retenir</h2>
<ul>
<li><strong>Audit immutable</strong> : tout accÃ¨s Ã  une donnÃ©e perso
gÃ©nÃ¨re un Ã©vÃ©nement</li>
<li><strong>Pseudonymisation</strong> : rÃ©versible (HMAC-SHA256 avec
clÃ©)</li>
<li><strong>Anonymisation</strong> : irrÃ©versible (aprÃ¨s expiration
rÃ©tention)</li>
<li><strong>Retention policies</strong> : automatiques via cron
(dÃ©clarÃ©es dans manifeste)</li>
<li><strong>DSAR API</strong> : endpoints unifiÃ©s pour les droits des
personnes</li>
<li><strong>Chiffrement</strong> : TLS 1.3 + AES-256-GCM pour donnÃ©es
sensibles</li>
</ul>
<h2 id="liens-connexes-5">6. Liens connexes</h2>
<ul>
<li>[[04_manifestes-lexorbital]] : Format du
<code>rgpd-manifest.json</code></li>
<li>[[03_documentation-et-diagrammes-vivants]] : GÃ©nÃ©ration du registre
RGPD</li>
<li>[[08_modules-types]] : Module <code>audit-module</code> (event
sourcing)</li>
</ul>
<h1 id="fiche-6-template-module">Fiche nÂ°6 : Template module (Husky,
commits, SemVer)</h1>
<blockquote>
<p>Le <strong>template LexOrbital</strong>
(<code>lexorbital-template-module</code>) fournit une structure
standardisÃ©e pour crÃ©er des modules : configuration Git (Husky), commits
conventionnels, tests, CI/CD et manifestes RGPD prÃ©-configurÃ©s.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-6">1. Objectif de la fiche</h2>
<p>DÃ©crire la structure et lâ€™outillage du template de module LexOrbital,
permettant aux dÃ©veloppeurs de dÃ©marrer rapidement tout en respectant
les standards de qualitÃ© (linting, tests, commits, versioning).</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-5">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="pourquoi-un-template">2.1. Pourquoi un template ?</h3>
<h4 id="problÃ¨mes-sans-template">ProblÃ¨mes sans template</h4>
<ul>
<li>ğŸ”„ <strong>Duplication de configuration</strong> : chaque module
rÃ©invente la roue (ESLint, Prettier, Husky)</li>
<li>ğŸ“ <strong>Commits incohÃ©rents</strong> : pas de standard de
messages (debug, fix bug, etc.)</li>
<li>ğŸ› <strong>QualitÃ© variable</strong> : certains modules ont des
tests, dâ€™autres non</li>
<li>ğŸ“¦ <strong>Versioning anarchique</strong> : 1.0.0 â†’ 2.5.3 sans
justification</li>
</ul>
<h4 id="avantages-du-template-lexorbital">Avantages du template
LexOrbital</h4>
<ul>
<li>âœ… <strong>Standardisation</strong> : tous les modules ont la mÃªme
structure</li>
<li>âœ… <strong>Quality gates</strong> : impossible de commit sans
lint/tests</li>
<li>âœ… <strong>Versioning automatique</strong> : SemVer calculÃ© depuis
les commits</li>
<li>âœ… <strong>ConformitÃ© RGPD</strong> : manifeste prÃ©-configurÃ© Ã 
remplir</li>
</ul>
<h3 id="structure-du-template">2.2. Structure du template</h3>
<pre><code>lexorbital-template-module/
â”œâ”€â”€ .github/
â”‚   â””â”€â”€ workflows/
â”‚       â”œâ”€â”€ ci.yml                    # Tests + lint sur PR
â”‚       â”œâ”€â”€ release.yml               # Publication automatique (npm/GitHub)
â”‚       â””â”€â”€ docs.yml                  # GÃ©nÃ©ration doc Pandoc
â”œâ”€â”€ .husky/
â”‚   â”œâ”€â”€ pre-commit                    # Lint-staged (ESLint + Prettier)
â”‚   â”œâ”€â”€ commit-msg                    # Validation Conventional Commits
â”‚   â””â”€â”€ pre-push                      # Tests avant push
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ README.md                     # Documentation du module
â”‚   â”œâ”€â”€ 00_getting-started.md
â”‚   â”œâ”€â”€ 01_api-reference.md
â”‚   â””â”€â”€ templates/
â”‚       â”œâ”€â”€ lexorbital.html
â”‚       â””â”€â”€ pandoc.css
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.ts                      # Point d&#39;entrÃ©e principal
â”‚   â”œâ”€â”€ module.ts                     # Classe NestJS Module
â”‚   â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ controllers/
â”‚   â””â”€â”€ types/
â”œâ”€â”€ tests/
â”‚   â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ integration/
â”‚   â””â”€â”€ e2e/
â”œâ”€â”€ lexorbital.module.json            # Manifeste technique
â”œâ”€â”€ rgpd-manifest.json                # Manifeste RGPD
â”œâ”€â”€ package.json                      # DÃ©pendances + scripts
â”œâ”€â”€ tsconfig.json                     # Configuration TypeScript
â”œâ”€â”€ eslint.config.cjs                 # ESLint flat config
â”œâ”€â”€ .prettierrc                       # Prettier config
â”œâ”€â”€ commitlint.config.ts              # Commitlint (Conventional Commits)
â”œâ”€â”€ CHANGELOG.md                      # Changelog auto-gÃ©nÃ©rÃ©
â””â”€â”€ README.md                         # Documentation principale</code></pre>
<h2 id="implications-techniques-4">3. Implications techniques</h2>
<h3 id="git-hooks-avec-husky">3.1. Git Hooks avec Husky</h3>
<h4 id="installation">Installation</h4>
<div class="sourceCode" id="cb38"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install <span class="at">--save-dev</span> husky lint-staged</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> husky install</span></code></pre></div>
<h4
id="huskypre-commit-lint-format-avant-commit"><code>.husky/pre-commit</code>
: Lint + format avant commit</h4>
<div class="sourceCode" id="cb39"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span> <span class="st">&quot;</span><span class="va">$(</span><span class="fu">dirname</span> <span class="st">&quot;</span><span class="va">$0</span><span class="st">&quot;</span><span class="va">)</span><span class="st">/_/husky.sh&quot;</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> lint-staged</span></code></pre></div>
<p>Fichier <code>package.json</code> :</p>
<div class="sourceCode" id="cb40"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;lint-staged&quot;</span><span class="fu">:</span> <span class="fu">{</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;*.{ts,tsx}&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;eslint --fix&quot;</span><span class="ot">,</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;prettier --write&quot;</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span><span class="fu">,</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>    <span class="dt">&quot;*.{json,md}&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&quot;prettier --write&quot;</span></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>    <span class="ot">]</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">}</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<h4
id="huskycommit-msg-validation-conventional-commits"><code>.husky/commit-msg</code>
: Validation Conventional Commits</h4>
<div class="sourceCode" id="cb41"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span> <span class="st">&quot;</span><span class="va">$(</span><span class="fu">dirname</span> <span class="st">&quot;</span><span class="va">$0</span><span class="st">&quot;</span><span class="va">)</span><span class="st">/_/husky.sh&quot;</span></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="ex">npx</span> commitlint <span class="at">--edit</span> <span class="st">&quot;</span><span class="va">$1</span><span class="st">&quot;</span></span></code></pre></div>
<p>Fichier <code>commitlint.config.ts</code> :</p>
<div class="sourceCode" id="cb42"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> <span class="im">type</span> { UserConfig } <span class="im">from</span> <span class="st">&#39;@commitlint/types&#39;</span><span class="op">;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">const</span> config<span class="op">:</span> UserConfig <span class="op">=</span> {</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  extends<span class="op">:</span> [<span class="st">&#39;@commitlint/config-conventional&#39;</span>]<span class="op">,</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  rules<span class="op">:</span> {</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;type-enum&#39;</span><span class="op">:</span> [</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">,</span></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;always&#39;</span><span class="op">,</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>      [</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;feat&#39;</span><span class="op">,</span>     <span class="co">// Nouvelle fonctionnalitÃ©</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;fix&#39;</span><span class="op">,</span>      <span class="co">// Correction de bug</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;docs&#39;</span><span class="op">,</span>     <span class="co">// Documentation</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;style&#39;</span><span class="op">,</span>    <span class="co">// Formatage (pas de changement de code)</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;refactor&#39;</span><span class="op">,</span> <span class="co">// Refactoring (pas de feat ni fix)</span></span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;perf&#39;</span><span class="op">,</span>     <span class="co">// AmÃ©lioration de performance</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;test&#39;</span><span class="op">,</span>     <span class="co">// Ajout/modification de tests</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;chore&#39;</span><span class="op">,</span>    <span class="co">// TÃ¢ches de build, config, etc.</span></span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;ci&#39;</span><span class="op">,</span>       <span class="co">// Modification CI/CD</span></span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">&#39;revert&#39;</span><span class="op">,</span>   <span class="co">// Revert d&#39;un commit</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>      ]<span class="op">,</span></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="st">&#39;scope-enum&#39;</span><span class="op">:</span> [</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span><span class="op">,</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>      <span class="st">&#39;always&#39;</span><span class="op">,</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>      [<span class="st">&#39;auth&#39;</span><span class="op">,</span> <span class="st">&#39;audit&#39;</span><span class="op">,</span> <span class="st">&#39;core&#39;</span><span class="op">,</span> <span class="st">&#39;docs&#39;</span><span class="op">,</span> <span class="st">&#39;config&#39;</span><span class="op">,</span> <span class="st">&#39;deps&#39;</span>]<span class="op">,</span></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>    ]<span class="op">,</span></span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> config<span class="op">;</span></span></code></pre></div>
<h4 id="huskypre-push-tests-avant-push"><code>.husky/pre-push</code> :
Tests avant push</h4>
<div class="sourceCode" id="cb43"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/sh</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">.</span> <span class="st">&quot;</span><span class="va">$(</span><span class="fu">dirname</span> <span class="st">&quot;</span><span class="va">$0</span><span class="st">&quot;</span><span class="va">)</span><span class="st">/_/husky.sh&quot;</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> run test</span></code></pre></div>
<h3 id="conventional-commits-semver-automatique">3.2. Conventional
Commits â†’ SemVer automatique</h3>
<h4 id="format-des-commits">Format des commits</h4>
<pre><code>&lt;type&gt;(&lt;scope&gt;): &lt;subject&gt;

[optional body]

[optional footer]</code></pre>
<p><strong>Exemples</strong> :</p>
<pre><code>feat(auth): add OAuth2 support

Implements OAuth2 authorization code flow with PKCE.

BREAKING CHANGE: AuthService.login() signature changed</code></pre>
<pre><code>fix(audit): correct retention policy calculation

Fixes #123</code></pre>
<h4 id="gÃ©nÃ©ration-automatique-de-version-semantic-release">GÃ©nÃ©ration
automatique de version (semantic-release)</h4>
<div class="sourceCode" id="cb47"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="ex">npm</span> install <span class="at">--save-dev</span> semantic-release @semantic-release/changelog @semantic-release/git</span></code></pre></div>
<p>Fichier <code>.releaserc.json</code> :</p>
<div class="sourceCode" id="cb48"><pre
class="sourceCode json"><code class="sourceCode json"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;branches&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;main&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">&quot;plugins&quot;</span><span class="fu">:</span> <span class="ot">[</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;@semantic-release/commit-analyzer&quot;</span><span class="ot">,</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;@semantic-release/release-notes-generator&quot;</span><span class="ot">,</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;@semantic-release/changelog&quot;</span><span class="ot">,</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;@semantic-release/npm&quot;</span><span class="ot">,</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;@semantic-release/git&quot;</span><span class="ot">,</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;@semantic-release/github&quot;</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="ot">]</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="fu">}</span></span></code></pre></div>
<p><strong>RÃ¨gles de versioning</strong> : - <code>fix:</code> â†’
<strong>PATCH</strong> (1.0.0 â†’ 1.0.1) - <code>feat:</code> â†’
<strong>MINOR</strong> (1.0.0 â†’ 1.1.0) - <code>BREAKING CHANGE:</code> â†’
<strong>MAJOR</strong> (1.0.0 â†’ 2.0.0)</p>
<h4 id="workflow-github-actions-.githubworkflowsrelease.yml">Workflow
GitHub Actions (<code>.github/workflows/release.yml</code>)</h4>
<div class="sourceCode" id="cb49"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> Release</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> main</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">release</span><span class="kw">:</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">fetch-depth</span><span class="kw">:</span><span class="at"> </span><span class="dv">0</span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-node@v4</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">node-version</span><span class="kw">:</span><span class="at"> </span><span class="dv">20</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm ci</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm test</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npx semantic-release</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">env</span><span class="kw">:</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">GITHUB_TOKEN</span><span class="kw">:</span><span class="at"> ${{ secrets.GITHUB_TOKEN }}</span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">NPM_TOKEN</span><span class="kw">:</span><span class="at"> ${{ secrets.NPM_TOKEN }}</span></span></code></pre></div>
<h3 id="tests-automatisÃ©s">3.3. Tests automatisÃ©s</h3>
<h4 id="structure-des-tests">Structure des tests</h4>
<pre><code>tests/
â”œâ”€â”€ unit/
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â””â”€â”€ auth.service.spec.ts
â”‚   â””â”€â”€ controllers/
â”‚       â””â”€â”€ auth.controller.spec.ts
â”œâ”€â”€ integration/
â”‚   â””â”€â”€ auth-flow.spec.ts
â””â”€â”€ e2e/
    â””â”€â”€ auth.e2e-spec.ts</code></pre>
<h4 id="configuration-vitest-vitest.config.ts">Configuration Vitest
(<code>vitest.config.ts</code>)</h4>
<div class="sourceCode" id="cb51"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { defineConfig } <span class="im">from</span> <span class="st">&#39;vitest/config&#39;</span><span class="op">;</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">export</span> <span class="im">default</span> <span class="fu">defineConfig</span>({</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  test<span class="op">:</span> {</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    globals<span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    environment<span class="op">:</span> <span class="st">&#39;node&#39;</span><span class="op">,</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    coverage<span class="op">:</span> {</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>      provider<span class="op">:</span> <span class="st">&#39;v8&#39;</span><span class="op">,</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>      reporter<span class="op">:</span> [<span class="st">&#39;text&#39;</span><span class="op">,</span> <span class="st">&#39;json&#39;</span><span class="op">,</span> <span class="st">&#39;html&#39;</span>]<span class="op">,</span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>      exclude<span class="op">:</span> [<span class="st">&#39;**/node_modules/**&#39;</span><span class="op">,</span> <span class="st">&#39;**/tests/**&#39;</span>]<span class="op">,</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>      thresholds<span class="op">:</span> {</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>        lines<span class="op">:</span> <span class="dv">80</span><span class="op">,</span></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>        functions<span class="op">:</span> <span class="dv">80</span><span class="op">,</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        branches<span class="op">:</span> <span class="dv">75</span><span class="op">,</span></span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        statements<span class="op">:</span> <span class="dv">80</span><span class="op">,</span></span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>      }<span class="op">,</span></span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    }<span class="op">,</span></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>  }<span class="op">,</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h4 id="exemple-de-test-unitaire">Exemple de test unitaire</h4>
<div class="sourceCode" id="cb52"><pre
class="sourceCode typescript"><code class="sourceCode typescript"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">// tests/unit/services/auth.service.spec.ts</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { describe<span class="op">,</span> it<span class="op">,</span> expect<span class="op">,</span> beforeEach } <span class="im">from</span> <span class="st">&#39;vitest&#39;</span><span class="op">;</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> { AuthService } <span class="im">from</span> <span class="st">&#39;../../../src/services/auth.service&#39;</span><span class="op">;</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">describe</span>(<span class="st">&#39;AuthService&#39;</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">let</span> authService<span class="op">:</span> AuthService<span class="op">;</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">beforeEach</span>(() <span class="kw">=&gt;</span> {</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>    authService <span class="op">=</span> <span class="kw">new</span> <span class="fu">AuthService</span>()<span class="op">;</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">it</span>(<span class="st">&#39;should generate a valid JWT token&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">const</span> token <span class="op">=</span> <span class="cf">await</span> authService<span class="op">.</span><span class="fu">generateToken</span>({ userId<span class="op">:</span> <span class="st">&#39;123&#39;</span> })<span class="op">;</span></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expect</span>(token)<span class="op">.</span><span class="fu">toBeDefined</span>()<span class="op">;</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">expect</span>(<span class="kw">typeof</span> token)<span class="op">.</span><span class="fu">toBe</span>(<span class="st">&#39;string&#39;</span>)<span class="op">;</span></span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb52-17"><a href="#cb52-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-18"><a href="#cb52-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">it</span>(<span class="st">&#39;should throw UnauthorizedException for invalid credentials&#39;</span><span class="op">,</span> <span class="kw">async</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb52-19"><a href="#cb52-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">await</span> <span class="fu">expect</span>(</span>
<span id="cb52-20"><a href="#cb52-20" aria-hidden="true" tabindex="-1"></a>      authService<span class="op">.</span><span class="fu">login</span>(<span class="st">&#39;invalid@example.com&#39;</span><span class="op">,</span> <span class="st">&#39;wrong&#39;</span>)</span>
<span id="cb52-21"><a href="#cb52-21" aria-hidden="true" tabindex="-1"></a>    )<span class="op">.</span><span class="at">rejects</span><span class="op">.</span><span class="fu">toThrow</span>(<span class="st">&#39;Invalid credentials&#39;</span>)<span class="op">;</span></span>
<span id="cb52-22"><a href="#cb52-22" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb52-23"><a href="#cb52-23" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code></pre></div>
<h3 id="cicd-avec-github-actions">3.4. CI/CD avec GitHub Actions</h3>
<h4
id="githubworkflowsci.yml-tests-sur-chaque-pr"><code>.github/workflows/ci.yml</code>
: Tests sur chaque PR</h4>
<div class="sourceCode" id="cb53"><pre
class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">name</span><span class="kw">:</span><span class="at"> CI</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">on</span><span class="kw">:</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">pull_request</span><span class="kw">:</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">,</span><span class="at"> develop</span><span class="kw">]</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">push</span><span class="kw">:</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">branches</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">main</span><span class="kw">,</span><span class="at"> develop</span><span class="kw">]</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">jobs</span><span class="kw">:</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">test</span><span class="kw">:</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">runs-on</span><span class="kw">:</span><span class="at"> ubuntu-latest</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">strategy</span><span class="kw">:</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="fu">matrix</span><span class="kw">:</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">node-version</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="dv">18</span><span class="kw">,</span><span class="at"> </span><span class="dv">20</span><span class="kw">]</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">steps</span><span class="kw">:</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/checkout@v4</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Setup Node.js ${{ matrix.node-version }}</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> actions/setup-node@v4</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">node-version</span><span class="kw">:</span><span class="at"> ${{ matrix.node-version }}</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Install dependencies</span></span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm ci</span></span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Lint</span></span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm run lint</span></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Type check</span></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm run type-check</span></span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Run tests</span></span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">run</span><span class="kw">:</span><span class="at"> npm run test:ci</span></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="at">      </span></span>
<span id="cb53-36"><a href="#cb53-36" aria-hidden="true" tabindex="-1"></a><span class="at">      </span><span class="kw">-</span><span class="at"> </span><span class="fu">name</span><span class="kw">:</span><span class="at"> Upload coverage</span></span>
<span id="cb53-37"><a href="#cb53-37" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">uses</span><span class="kw">:</span><span class="at"> codecov/codecov-action@v3</span></span>
<span id="cb53-38"><a href="#cb53-38" aria-hidden="true" tabindex="-1"></a><span class="at">        </span><span class="fu">with</span><span class="kw">:</span></span>
<span id="cb53-39"><a href="#cb53-39" aria-hidden="true" tabindex="-1"></a><span class="at">          </span><span class="fu">files</span><span class="kw">:</span><span class="at"> ./coverage/coverage-final.json</span></span></code></pre></div>
<h2 id="checklist-de-mise-en-Å“uvre-4">4. Checklist de mise en Å“uvre</h2>
<h3 id="pour-crÃ©er-un-nouveau-module-1">Pour crÃ©er un nouveau
module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Cloner le template :
<code>git clone https://github.com/lexorbital/lexorbital-template-module my-module</code></label></li>
<li><label><input type="checkbox" />Initialiser Husky :
<code>npm install &amp;&amp; npx husky install</code></label></li>
<li><label><input type="checkbox" />Remplir
<code>lexorbital.module.json</code> (name, version, orbit)</label></li>
<li><label><input type="checkbox" />Remplir
<code>rgpd-manifest.json</code> (dataProcessed, legalBasis)</label></li>
<li><label><input type="checkbox" />Adapter les scopes Commitlint dans
<code>commitlint.config.ts</code></label></li>
<li><label><input type="checkbox" />Configurer GitHub Actions secrets
(NPM_TOKEN si publication npm)</label></li>
<li><label><input type="checkbox" />Ã‰crire les premiers tests (au moins
un test unitaire)</label></li>
<li><label><input type="checkbox" />Premier commit :
<code>git commit -m "feat(core): initial module setup"</code></label></li>
</ul>
<h3 id="pour-contribuer-Ã -un-module-existant">Pour contribuer Ã  un
module existant</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Installer les dÃ©pendances :
<code>npm install</code></label></li>
<li><label><input type="checkbox" />VÃ©rifier que Husky est actif : les
hooks doivent se dÃ©clencher</label></li>
<li><label><input type="checkbox" />CrÃ©er une branche feature :
<code>git checkout -b feat/my-feature</code></label></li>
<li><label><input type="checkbox" />Ã‰crire les tests avant le code
(TDD)</label></li>
<li><label><input type="checkbox" />Commit avec Conventional Commits :
<code>git commit -m "feat(auth): add 2FA support"</code></label></li>
<li><label><input type="checkbox" />Pousser et ouvrir une PR : les tests
CI doivent passer</label></li>
</ul>
<h2 id="Ã -retenir-4">5. Ã€ retenir</h2>
<ul>
<li><strong>Husky</strong> : hooks Git automatiques (lint, tests,
commits)</li>
<li><strong>Conventional Commits</strong> : format standardisÃ©
(<code>feat:</code>, <code>fix:</code>, etc.)</li>
<li><strong>Semantic Release</strong> : versioning SemVer
automatique</li>
<li><strong>Tests obligatoires</strong> : coverage minimum 80%
(configurÃ© dans Vitest)</li>
<li><strong>CI/CD</strong> : GitHub Actions pour tests + release
automatique</li>
</ul>
<h2 id="liens-connexes-6">6. Liens connexes</h2>
<ul>
<li>[[04_manifestes-lexorbital]] : Format des manifestes Ã  remplir</li>
<li>[[07_workflow-subtree]] : Comment amarrer un module via git
subtree</li>
<li>[[08_modules-types]] : Catalogue des modules existants</li>
<li>[[03_documentation-et-diagrammes-vivants]] : GÃ©nÃ©ration doc avec
Pandoc</li>
</ul>
<h1 id="fiche-7-workflow-subtree">Fiche nÂ°7 : Workflow git subtree &amp;
scripts dâ€™amarrage</h1>
<blockquote>
<p>LexOrbital utilise <strong>git subtree</strong> pour amarrer des
modules externes (dÃ©pÃ´ts Git indÃ©pendants) dans le monorepo
<code>lexorbital-core</code>, tout en conservant lâ€™historique Git et la
possibilitÃ© de contribuer upstream.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-7">1. Objectif de la fiche</h2>
<p>Expliquer le workflow de gestion des modules via git subtree, les
avantages par rapport Ã  git submodule, et fournir les scripts
dâ€™amarrage/mise Ã  jour/contribution pour les dÃ©veloppeurs.</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-6">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="git-subtree-vs-git-submodule">2.1. Git subtree vs Git
submodule</h3>
<h4 id="problÃ¨mes-des-submodules">ProblÃ¨mes des submodules</h4>
<ul>
<li>âŒ <strong>ComplexitÃ©</strong> : <code>git submodule init</code>,
<code>git submodule update --recursive</code>, etc.</li>
<li>âŒ <strong>Ã‰tat dÃ©tachÃ©</strong> : les submodules sont souvent en
HEAD dÃ©tachÃ© (detached HEAD)</li>
<li>âŒ <strong>Friction pour les contributeurs</strong> : oubli frÃ©quent
de <code>--recurse-submodules</code></li>
<li>âŒ <strong>Commits fantÃ´mes</strong> : rÃ©fÃ©rences de commits qui
peuvent disparaÃ®tre</li>
</ul>
<h4 id="avantages-des-subtrees">Avantages des subtrees</h4>
<ul>
<li>âœ… <strong>Transparence</strong> : le code du module est
<strong>physiquement prÃ©sent</strong> dans le repo</li>
<li>âœ… <strong>Clone simple</strong> : <code>git clone</code> suffit,
pas de commande supplÃ©mentaire</li>
<li>âœ… <strong>Historique prÃ©servÃ©</strong> : lâ€™historique du module
externe est fusionnÃ©</li>
<li>âœ… <strong>Contribution upstream facile</strong> :
<code>git subtree push</code> renvoie les commits vers le module</li>
</ul>
<h3 id="architecture-du-monorepo-avec-subtrees">2.2. Architecture du
monorepo avec subtrees</h3>
<pre><code>lexorbital-core/
â”œâ”€â”€ backend/
â”‚   â””â”€â”€ src/
â”‚       â”œâ”€â”€ meta-kernel/
â”‚       â””â”€â”€ modules/
â”‚           â”œâ”€â”€ auth-module/          â† git subtree de lexorbital-auth-module
â”‚           â”œâ”€â”€ audit-module/         â† git subtree de lexorbital-audit-module
â”‚           â”œâ”€â”€ dossiers-module/      â† git subtree de lexorbital-dossiers-module
â”‚           â””â”€â”€ ...
â”œâ”€â”€ frontend/
â””â”€â”€ modules/                          â† Aussi des subtrees (modules standalone)</code></pre>
<p>Chaque module sous <code>modules/</code> est un subtree dâ€™un dÃ©pÃ´t
Git externe (ex:
<code>https://github.com/lexorbital/lexorbital-auth-module</code>).</p>
<h2 id="implications-techniques-5">3. Implications techniques</h2>
<h3 id="ajouter-un-module-amarrage-initial">3.1. Ajouter un module
(amarrage initial)</h3>
<h4 id="commande-manuelle">Commande manuelle</h4>
<div class="sourceCode" id="cb55"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Ajouter le remote du module</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote add auth-module https://github.com/lexorbital/lexorbital-auth-module.git</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Ajouter le subtree</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> subtree add <span class="at">--prefix</span><span class="op">=</span>modules/auth-module auth-module main <span class="at">--squash</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. (Optionnel) Supprimer le remote si on ne veut pas polluer</span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote remove auth-module</span></code></pre></div>
<p><strong>Explication des flags</strong> : -
<code>--prefix=modules/auth-module</code> : oÃ¹ placer le module dans le
monorepo - <code>auth-module</code> : nom du remote (peut Ãªtre lâ€™URL
directement) - <code>main</code> : branche du module Ã  ajouter -
<code>--squash</code> : fusionner lâ€™historique en un seul commit
(recommandÃ© pour Ã©viter pollution)</p>
<h4 id="script-damarrage-scriptsadd-module.sh">Script dâ€™amarrage
(<code>scripts/add-module.sh</code>)</h4>
<div class="sourceCode" id="cb56"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_NAME</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_REPO</span><span class="op">=</span><span class="va">$2</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_BRANCH</span><span class="op">=</span><span class="va">${3</span><span class="op">:-</span>main<span class="va">}</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="va">TARGET_DIR</span><span class="op">=</span><span class="st">&quot;modules/</span><span class="va">${MODULE_NAME}</span><span class="st">&quot;</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$MODULE_NAME</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$MODULE_REPO</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Usage: ./scripts/add-module.sh &lt;module-name&gt; &lt;repo-url&gt; [branch]&quot;</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Exemple: ./scripts/add-module.sh auth-module https://github.com/lexorbital/lexorbital-auth-module.git&quot;</span></span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;ğŸ›°ï¸  Amarrage du module </span><span class="va">${MODULE_NAME}</span><span class="st">...&quot;</span></span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter le remote temporaire</span></span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote add <span class="at">-f</span> <span class="st">&quot;</span><span class="va">${MODULE_NAME}</span><span class="st">-remote&quot;</span> <span class="st">&quot;</span><span class="va">$MODULE_REPO</span><span class="st">&quot;</span></span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter le subtree</span></span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> subtree add <span class="at">--prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$TARGET_DIR</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">${MODULE_NAME}</span><span class="st">-remote&quot;</span> <span class="st">&quot;</span><span class="va">$MODULE_BRANCH</span><span class="st">&quot;</span> <span class="at">--squash</span></span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Nettoyer le remote</span></span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote remove <span class="st">&quot;</span><span class="va">${MODULE_NAME}</span><span class="st">-remote&quot;</span></span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;âœ… Module </span><span class="va">${MODULE_NAME}</span><span class="st"> amarrÃ© avec succÃ¨s dans </span><span class="va">${TARGET_DIR}</span><span class="st">&quot;</span></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;ğŸ“ N&#39;oubliez pas de mettre Ã  jour lexorbital.module.json si nÃ©cessaire.&quot;</span></span></code></pre></div>
<p><strong>Usage</strong> :</p>
<div class="sourceCode" id="cb57"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chmod</span> +x scripts/add-module.sh</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/add-module.sh</span> auth-module https://github.com/lexorbital/lexorbital-auth-module.git</span></code></pre></div>
<h3 id="mettre-Ã -jour-un-module-pull-upstream">3.2. Mettre Ã  jour un
module (pull upstream)</h3>
<h4 id="commande-manuelle-1">Commande manuelle</h4>
<div class="sourceCode" id="cb58"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Ajouter le remote si pas dÃ©jÃ  fait</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote add auth-module https://github.com/lexorbital/lexorbital-auth-module.git</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Pull les changements upstream</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> subtree pull <span class="at">--prefix</span><span class="op">=</span>modules/auth-module auth-module main <span class="at">--squash</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. RÃ©soudre les conflits si nÃ©cessaire</span></span></code></pre></div>
<h4 id="script-de-mise-Ã -jour-scriptsupdate-module.sh">Script de mise Ã 
jour (<code>scripts/update-module.sh</code>)</h4>
<div class="sourceCode" id="cb59"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_NAME</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_REPO</span><span class="op">=</span><span class="va">$2</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_BRANCH</span><span class="op">=</span><span class="va">${3</span><span class="op">:-</span>main<span class="va">}</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="va">TARGET_DIR</span><span class="op">=</span><span class="st">&quot;modules/</span><span class="va">${MODULE_NAME}</span><span class="st">&quot;</span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$MODULE_NAME</span><span class="st">&quot;</span> <span class="bu">]</span> <span class="kw">||</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$MODULE_REPO</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Usage: ./scripts/update-module.sh &lt;module-name&gt; &lt;repo-url&gt; [branch]&quot;</span></span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb59-13"><a href="#cb59-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-14"><a href="#cb59-14" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;ğŸ”„ Mise Ã  jour du module </span><span class="va">${MODULE_NAME}</span><span class="st">...&quot;</span></span>
<span id="cb59-15"><a href="#cb59-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Ajouter le remote temporaire</span></span>
<span id="cb59-17"><a href="#cb59-17" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote add <span class="at">-f</span> <span class="st">&quot;</span><span class="va">${MODULE_NAME}</span><span class="st">-remote&quot;</span> <span class="st">&quot;</span><span class="va">$MODULE_REPO</span><span class="st">&quot;</span> <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb59-18"><a href="#cb59-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-19"><a href="#cb59-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Pull les changements</span></span>
<span id="cb59-20"><a href="#cb59-20" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> subtree pull <span class="at">--prefix</span><span class="op">=</span><span class="st">&quot;</span><span class="va">$TARGET_DIR</span><span class="st">&quot;</span> <span class="st">&quot;</span><span class="va">${MODULE_NAME}</span><span class="st">-remote&quot;</span> <span class="st">&quot;</span><span class="va">$MODULE_BRANCH</span><span class="st">&quot;</span> <span class="at">--squash</span></span>
<span id="cb59-21"><a href="#cb59-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-22"><a href="#cb59-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Nettoyer le remote</span></span>
<span id="cb59-23"><a href="#cb59-23" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote remove <span class="st">&quot;</span><span class="va">${MODULE_NAME}</span><span class="st">-remote&quot;</span> <span class="dv">2</span><span class="op">&gt;</span>/dev/null <span class="kw">||</span> <span class="fu">true</span></span>
<span id="cb59-24"><a href="#cb59-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-25"><a href="#cb59-25" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;âœ… Module </span><span class="va">${MODULE_NAME}</span><span class="st"> mis Ã  jour avec succÃ¨s&quot;</span></span></code></pre></div>
<p><strong>Usage</strong> :</p>
<div class="sourceCode" id="cb60"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/update-module.sh</span> auth-module https://github.com/lexorbital/lexorbital-auth-module.git</span></code></pre></div>
<h3 id="contribuer-Ã -un-module-push-upstream">3.3. Contribuer Ã  un
module (push upstream)</h3>
<p>Si vous modifiez un module dans le monorepo et voulez renvoyer les
changements vers le dÃ©pÃ´t du module :</p>
<h4 id="commande-manuelle-2">Commande manuelle</h4>
<div class="sourceCode" id="cb61"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Ajouter le remote du module</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> remote add auth-module https://github.com/lexorbital/lexorbital-auth-module.git</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Push uniquement les commits concernant ce module</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> subtree push <span class="at">--prefix</span><span class="op">=</span>modules/auth-module auth-module main</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. CrÃ©er une PR sur le dÃ©pÃ´t du module</span></span></code></pre></div>
<p><strong>Note</strong> : <code>git subtree push</code> peut Ãªtre
<strong>lent</strong> (il doit filtrer lâ€™historique). Alternative :
travailler directement dans le dÃ©pÃ´t du module, puis pull dans le
monorepo.</p>
<h4 id="workflow-recommandÃ©-pour-contributions-importantes">Workflow
recommandÃ© pour contributions importantes</h4>
<ol type="1">
<li><p><strong>Cloner le module</strong> indÃ©pendamment :</p>
<div class="sourceCode" id="cb62"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/lexorbital/lexorbital-auth-module.git</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">cd</span> lexorbital-auth-module</span></code></pre></div></li>
<li><p><strong>DÃ©velopper</strong> dans le module (avec tests, lint,
etc.)</p></li>
<li><p><strong>Push</strong> et crÃ©er une PR sur le dÃ©pÃ´t du
module</p></li>
<li><p><strong>Une fois mergÃ©</strong>, mettre Ã  jour le subtree dans le
monorepo :</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/update-module.sh</span> auth-module https://github.com/lexorbital/lexorbital-auth-module.git</span></code></pre></div></li>
</ol>
<h3 id="dÃ©samarrer-un-module-suppression">3.4. DÃ©samarrer un module
(suppression)</h3>
<div class="sourceCode" id="cb64"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co">#!/bin/bash</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scripts/remove-module.sh</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="bu">set</span> <span class="at">-e</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="va">MODULE_NAME</span><span class="op">=</span><span class="va">$1</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="va">TARGET_DIR</span><span class="op">=</span><span class="st">&quot;modules/</span><span class="va">${MODULE_NAME}</span><span class="st">&quot;</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="bu">[</span> <span class="ot">-z</span> <span class="st">&quot;</span><span class="va">$MODULE_NAME</span><span class="st">&quot;</span> <span class="bu">]</span><span class="kw">;</span> <span class="cf">then</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="bu">echo</span> <span class="st">&quot;Usage: ./scripts/remove-module.sh &lt;module-name&gt;&quot;</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="bu">exit</span> 1</span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="cf">fi</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;ğŸ—‘ï¸  DÃ©samarrage du module </span><span class="va">${MODULE_NAME}</span><span class="st">...&quot;</span></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Supprimer le rÃ©pertoire</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> rm <span class="at">-r</span> <span class="st">&quot;</span><span class="va">$TARGET_DIR</span><span class="st">&quot;</span></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Commit</span></span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> commit <span class="at">-m</span> <span class="st">&quot;chore(modules): remove </span><span class="va">${MODULE_NAME}</span><span class="st">&quot;</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a><span class="bu">echo</span> <span class="st">&quot;âœ… Module </span><span class="va">${MODULE_NAME}</span><span class="st"> dÃ©samarrÃ© avec succÃ¨s&quot;</span></span></code></pre></div>
<h2 id="checklist-de-mise-en-Å“uvre-5">4. Checklist de mise en Å“uvre</h2>
<h3 id="pour-ajouter-un-module-externe">Pour ajouter un module
externe</h3>
<ul class="task-list">
<li><label><input type="checkbox" />VÃ©rifier que le module a un
<code>lexorbital.module.json</code> valide</label></li>
<li><label><input type="checkbox" />ExÃ©cuter
<code>./scripts/add-module.sh &lt;nom&gt; &lt;url-repo&gt;</code></label></li>
<li><label><input type="checkbox" />VÃ©rifier que le Meta-Kernel charge
bien le module (dÃ©marrer lâ€™app)</label></li>
<li><label><input type="checkbox" />Commit et push</label></li>
</ul>
<h3 id="pour-mettre-Ã -jour-un-module">Pour mettre Ã  jour un module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />ExÃ©cuter
<code>./scripts/update-module.sh &lt;nom&gt; &lt;url-repo&gt;</code></label></li>
<li><label><input type="checkbox" />VÃ©rifier les breaking changes (lire
CHANGELOG du module)</label></li>
<li><label><input type="checkbox" />ExÃ©cuter les tests du monorepo :
<code>npm test</code></label></li>
<li><label><input type="checkbox" />Commit et push</label></li>
</ul>
<h3 id="pour-contribuer-Ã -un-module">Pour contribuer Ã  un module</h3>
<ul class="task-list">
<li><label><input type="checkbox" /><strong>Option 1 (petits
changements)</strong> : modifier dans <code>modules/</code>, puis
<code>git subtree push</code></label></li>
<li><label><input type="checkbox" /><strong>Option 2 (gros
changements)</strong> : cloner le module sÃ©parÃ©ment, dÃ©velopper, PR,
puis update subtree</label></li>
</ul>
<h3 id="pour-dÃ©samarrer-un-module">Pour dÃ©samarrer un module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />VÃ©rifier quâ€™aucun autre module ne
dÃ©pend de lui (check <code>dependencies</code> des
manifestes)</label></li>
<li><label><input type="checkbox" />ExÃ©cuter
<code>./scripts/remove-module.sh &lt;nom&gt;</code></label></li>
<li><label><input type="checkbox" />Supprimer les rÃ©fÃ©rences au module
dans la config du Meta-Kernel</label></li>
</ul>
<h2 id="Ã -retenir-5">5. Ã€ retenir</h2>
<ul>
<li><strong>Git subtree</strong> : modules externes intÃ©grÃ©s dans le
monorepo (transparence totale)</li>
<li><strong>Amarrage</strong> :
<code>git subtree add --prefix=modules/X &lt;repo&gt; main --squash</code></li>
<li><strong>Mise Ã  jour</strong> :
<code>git subtree pull --prefix=modules/X &lt;repo&gt; main --squash</code></li>
<li><strong>Contribution</strong> : <code>git subtree push</code> (lent)
OU dÃ©velopper dans le repo du module</li>
<li><strong>Scripts fournis</strong> : <code>add-module.sh</code>,
<code>update-module.sh</code>, <code>remove-module.sh</code></li>
</ul>
<h2 id="liens-connexes-7">6. Liens connexes</h2>
<ul>
<li>[[06_template-module]] : Structure standard des modules Ã 
amarrer</li>
<li>[[01_architecture-orbitale]] : Comment le Meta-Kernel charge les
modules</li>
<li>[[04_manifestes-lexorbital]] : Manifestes requis pour
lâ€™amarrage</li>
<li>[[08_modules-types]] : Catalogue des modules disponibles</li>
</ul>
<h1 id="fiche-8-modules-types">Fiche nÂ°8 : Modules types (auth, audit,
CI, infraâ€¦)</h1>
<blockquote>
<p>Catalogue des modules LexOrbital par anneau orbital, avec
description, responsabilitÃ©s et dÃ©pendances. Cette fiche sert de
rÃ©fÃ©rence pour comprendre lâ€™Ã©cosystÃ¨me modulaire de la station.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-8">1. Objectif de la fiche</h2>
<p>Lister et dÃ©crire les modules standards de LexOrbital, leur
positionnement dans les anneaux orbitaux, leurs responsabilitÃ©s et leurs
interactions. Cette fiche est la carte stellaire de lâ€™architecture
modulaire.</p>
<h2 id="modules-par-anneau-orbital">2. Modules par anneau orbital</h2>
<h3 id="anneau-0-meta-kernel-noyau">2.1. Anneau 0 : Meta-Kernel
(noyau)</h3>
<h4 id="meta-kernel-core"><code>meta-kernel</code> (Core)</h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Orchestration centrale de tous les
modules</li>
<li><strong>Technologies</strong> : NestJS, Bull (queues), TypeORM</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Chargement dynamique des modules (ESM)</li>
<li>Event bus inter-modules (pub/sub)</li>
<li>Configuration centralisÃ©e (env, Vault)</li>
<li>Health check aggregator</li>
<li>Injection de dÃ©pendances globale</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : Aucune (câ€™est le noyau)</li>
<li><strong>Endpoint</strong> : <code>/health</code> (statut de tous les
modules)</li>
</ul>
<h4 id="config-module"><code>config-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Gestion de la configuration
applicative</li>
<li><strong>Technologies</strong> : NestJS Config, Vault (secrets)</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Variables dâ€™environnement par module</li>
<li>Secrets management (intÃ©gration Vault/K8s)</li>
<li>Feature flags dynamiques</li>
<li>Hot reload de config (sans redÃ©marrage)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>meta-kernel</code></li>
<li><strong>Endpoint</strong> : <code>/config</code> (lecture config par
module)</li>
</ul>
<h3 id="anneau-1-core-services-services-transverses">2.2. Anneau 1 :
Core Services (services transverses)</h3>
<h4 id="auth-module"><code>auth-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Authentification et
autorisation</li>
<li><strong>Technologies</strong> : Passport.js, JWT, OAuth2</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Login/logout (email/password)</li>
<li>JWT + refresh tokens</li>
<li>OAuth2 (Google, Microsoft)</li>
<li>RBAC (Role-Based Access Control)</li>
<li>2FA (TOTP via Authenticator)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>config-module</code>,
<code>logger-module</code></li>
<li><strong>Ã‰vÃ©nements Ã©mis</strong> : <code>user.login</code>,
<code>user.logout</code>, <code>token.refreshed</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> : <code>user.created</code>,
<code>user.deleted</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /auth/login</code></li>
<li><code>POST /auth/refresh</code></li>
<li><code>POST /auth/logout</code></li>
<li><code>GET /auth/me</code></li>
</ul></li>
</ul>
<h4 id="audit-module"><code>audit-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Event sourcing et logs dâ€™audit
RGPD</li>
<li><strong>Technologies</strong> : EventStoreDB, PostgreSQL
(append-only)</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Stockage immutable de tous les Ã©vÃ©nements <code>gdpr.*</code></li>
<li>GÃ©nÃ©ration du registre RGPD (Art. 30)</li>
<li>Recherche/export dâ€™audit trails</li>
<li>Hash de chaÃ®nage (blockchain-like)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>config-module</code>,
<code>logger-module</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> : <code>gdpr.*</code> (tous
les Ã©vÃ©nements RGPD)</li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>GET /audit/events?userId=X</code></li>
<li><code>GET /audit/export?format=pdf</code></li>
<li><code>GET /audit/gdpr-register</code></li>
</ul></li>
</ul>
<h4 id="logger-module"><code>logger-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Logs structurÃ©s applicatifs</li>
<li><strong>Technologies</strong> : Winston, Loki (ou ELK Stack)</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Logs structurÃ©s JSON</li>
<li>Niveaux : debug, info, warn, error</li>
<li>CorrÃ©lation par request (trace ID)</li>
<li>AgrÃ©gation centralisÃ©e (Loki/Grafana)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>config-module</code></li>
<li><strong>Endpoints</strong> : Aucun (service interne uniquement)</li>
</ul>
<h4 id="notification-module"><code>notification-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Notifications multi-canaux</li>
<li><strong>Technologies</strong> : Nodemailer (email), Twilio (SMS),
OneSignal (push)</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Envoi dâ€™emails transactionnels (templates)</li>
<li>SMS (codes 2FA, alertes)</li>
<li>Push notifications (web + mobile)</li>
<li>Queue dâ€™envoi avec retry</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>config-module</code>,
<code>logger-module</code>, <code>audit-module</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> : <code>user.login</code>,
<code>dossier.created</code>, <code>document.signed</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /notifications/send</code></li>
<li><code>GET /notifications/templates</code></li>
</ul></li>
</ul>
<h3 id="anneau-2-business-logic-mÃ©tier">2.3. Anneau 2 : Business Logic
(mÃ©tier)</h3>
<h4 id="dossiers-module"><code>dossiers-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Gestion des dossiers
juridiques</li>
<li><strong>Technologies</strong> : NestJS, TypeORM, PostgreSQL</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>CRUD dossiers (crÃ©ation, consultation, clÃ´ture)</li>
<li>Association clients/dossiers</li>
<li>Workflow de statuts (brouillon, actif, archivÃ©, clÃ´turÃ©)</li>
<li>Recherche full-text (ElasticSearch)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>auth-module</code>,
<code>audit-module</code>, <code>documents-module</code></li>
<li><strong>Ã‰vÃ©nements Ã©mis</strong> : <code>dossier.created</code>,
<code>dossier.updated</code>, <code>dossier.closed</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> : <code>document.added</code>,
<code>user.deleted</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /dossiers</code></li>
<li><code>GET /dossiers/:id</code></li>
<li><code>PATCH /dossiers/:id</code></li>
<li><code>DELETE /dossiers/:id</code></li>
<li><code>POST /dossiers/:id/close</code></li>
</ul></li>
</ul>
<h4 id="documents-module"><code>documents-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Gestion documentaire (versionning,
signatures)</li>
<li><strong>Technologies</strong> : NestJS, S3 (stockage), PDFKit,
DocuSign</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Upload/download de documents</li>
<li>Versionning automatique (Git-like)</li>
<li>Signature Ã©lectronique (intÃ©gration DocuSign)</li>
<li>OCR (extraction de texte via Tesseract)</li>
<li>GÃ©nÃ©ration PDF (templates)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>auth-module</code>,
<code>audit-module</code>, <code>dossiers-module</code></li>
<li><strong>Ã‰vÃ©nements Ã©mis</strong> : <code>document.uploaded</code>,
<code>document.signed</code>, <code>document.downloaded</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> :
<code>dossier.created</code>, <code>dossier.closed</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /documents/upload</code></li>
<li><code>GET /documents/:id/download</code></li>
<li><code>POST /documents/:id/sign</code></li>
<li><code>GET /documents/:id/versions</code></li>
</ul></li>
</ul>
<h4 id="workflow-module"><code>workflow-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Orchestration de processus mÃ©tier
(BPMN)</li>
<li><strong>Technologies</strong> : Camunda, NestJS</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>DÃ©finition de workflows (BPMN 2.0)</li>
<li>ExÃ©cution de processus (Ã©tats, transitions)</li>
<li>TÃ¢ches humaines (assignation, validation)</li>
<li>Timers et escalades automatiques</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>auth-module</code>,
<code>audit-module</code>, <code>notification-module</code></li>
<li><strong>Ã‰vÃ©nements Ã©mis</strong> : <code>workflow.started</code>,
<code>task.assigned</code>, <code>workflow.completed</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> :
<code>dossier.created</code>, <code>document.signed</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /workflows/start</code></li>
<li><code>GET /workflows/:id/tasks</code></li>
<li><code>POST /workflows/tasks/:id/complete</code></li>
</ul></li>
</ul>
<h4 id="facturation-module"><code>facturation-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Facturation et comptabilitÃ©</li>
<li><strong>Technologies</strong> : NestJS, Stripe, PDF generation</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>GÃ©nÃ©ration de factures (templates)</li>
<li>Paiements en ligne (Stripe)</li>
<li>Export comptable (CSV, FEC)</li>
<li>Gestion de la TVA</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>auth-module</code>,
<code>audit-module</code>, <code>dossiers-module</code></li>
<li><strong>Ã‰vÃ©nements Ã©mis</strong> : <code>invoice.created</code>,
<code>payment.received</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> :
<code>dossier.closed</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /invoices</code></li>
<li><code>GET /invoices/:id/pdf</code></li>
<li><code>POST /invoices/:id/pay</code></li>
</ul></li>
</ul>
<h3 id="anneau-3-intÃ©grations-apis-externes">2.4. Anneau 3 :
IntÃ©grations (APIs externes)</h3>
<h4 id="api-gateway-module"><code>api-gateway-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Exposition REST/GraphQL
unifiÃ©e</li>
<li><strong>Technologies</strong> : NestJS, Apollo (GraphQL)</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Routage vers les modules mÃ©tier</li>
<li>Rate limiting (par utilisateur/IP)</li>
<li>API versioning (<code>/v1</code>, <code>/v2</code>)</li>
<li>Swagger/OpenAPI automatique</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>auth-module</code>,
<code>logger-module</code></li>
<li><strong>Endpoints</strong> : Tous les endpoints publics passent par
ici</li>
</ul>
<h4 id="webhooks-module"><code>webhooks-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : IntÃ©grations tierces (webhooks
sortants/entrants)</li>
<li><strong>Technologies</strong> : NestJS, Bull (queues)</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Webhooks sortants (notifier des services externes)</li>
<li>Webhooks entrants (Stripe, DocuSign, Twilio)</li>
<li>Retry automatique avec backoff exponentiel</li>
<li>Validation de signatures (HMAC)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>auth-module</code>,
<code>audit-module</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> : tous (peut relayer vers
externe)</li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /webhooks/stripe</code></li>
<li><code>POST /webhooks/docusign</code></li>
</ul></li>
</ul>
<h4 id="export-module"><code>export-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : GÃ©nÃ©ration de rapports et
exports</li>
<li><strong>Technologies</strong> : Puppeteer (PDF), ExcelJS,
Pandoc</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Export PDF (dossiers, factures, audits)</li>
<li>Export Excel (donnÃ©es tabulaires)</li>
<li>Export Word (templates de contrats)</li>
<li>GÃ©nÃ©ration asynchrone (queue)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>dossiers-module</code>,
<code>documents-module</code>, <code>audit-module</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> :
<code>export.requested</code></li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>POST /exports/pdf</code></li>
<li><code>POST /exports/excel</code></li>
<li><code>GET /exports/:id/download</code></li>
</ul></li>
</ul>
<h4 id="search-module"><code>search-module</code></h4>
<ul>
<li><strong>ResponsabilitÃ©</strong> : Recherche full-text avancÃ©e</li>
<li><strong>Technologies</strong> : ElasticSearch, NestJS</li>
<li><strong>FonctionnalitÃ©s</strong> :
<ul>
<li>Indexation de dossiers, documents, clients</li>
<li>Recherche avec filtres et facettes</li>
<li>AutocomplÃ©tion</li>
<li>Recherche phonÃ©tique (noms propres)</li>
</ul></li>
<li><strong>DÃ©pendances</strong> : <code>dossiers-module</code>,
<code>documents-module</code></li>
<li><strong>Ã‰vÃ©nements consommÃ©s</strong> :
<code>dossier.created</code>, <code>document.uploaded</code>
(rÃ©indexation)</li>
<li><strong>Endpoints</strong> :
<ul>
<li><code>GET /search?q=contrat&amp;type=dossier</code></li>
<li><code>GET /search/suggest?q=dupon</code></li>
</ul></li>
</ul>
<h2 id="matrice-de-dÃ©pendances">3. Matrice de dÃ©pendances</h2>
<pre class="mermaid"><code>graph TD
    MetaKernel[Meta-Kernel]
    Config[config-module]
    Auth[auth-module]
    Audit[audit-module]
    Logger[logger-module]
    Notif[notification-module]
    Dossiers[dossiers-module]
    Docs[documents-module]
    Workflow[workflow-module]
    Factu[facturation-module]
    Gateway[api-gateway-module]
    Webhooks[webhooks-module]
    Export[export-module]
    Search[search-module]
    
    Config --&gt; MetaKernel
    Logger --&gt; Config
    Auth --&gt; Config
    Auth --&gt; Logger
    Audit --&gt; Config
    Audit --&gt; Logger
    Notif --&gt; Config
    Notif --&gt; Logger
    Notif --&gt; Audit
    
    Dossiers --&gt; Auth
    Dossiers --&gt; Audit
    Docs --&gt; Auth
    Docs --&gt; Audit
    Docs --&gt; Dossiers
    Workflow --&gt; Auth
    Workflow --&gt; Audit
    Workflow --&gt; Notif
    Factu --&gt; Auth
    Factu --&gt; Audit
    Factu --&gt; Dossiers
    
    Gateway --&gt; Auth
    Gateway --&gt; Logger
    Webhooks --&gt; Auth
    Webhooks --&gt; Audit
    Export --&gt; Dossiers
    Export --&gt; Docs
    Export --&gt; Audit
    Search --&gt; Dossiers
    Search --&gt; Docs</code></pre>
<h2 id="checklist-de-mise-en-Å“uvre-6">4. Checklist de mise en Å“uvre</h2>
<h3 id="pour-ajouter-un-nouveau-module-Ã -la-station">Pour ajouter un
nouveau module Ã  la station</h3>
<ul class="task-list">
<li><label><input type="checkbox" />DÃ©terminer lâ€™anneau orbital (0, 1,
2, ou 3)</label></li>
<li><label><input type="checkbox" />Cloner le template :
<code>lexorbital-template-module</code></label></li>
<li><label><input type="checkbox" />Remplir
<code>lexorbital.module.json</code> (name, orbit,
dependencies)</label></li>
<li><label><input type="checkbox" />Remplir
<code>rgpd-manifest.json</code> (si traite des donnÃ©es
perso)</label></li>
<li><label><input type="checkbox" />ImplÃ©menter les services et
controllers</label></li>
<li><label><input type="checkbox" />DÃ©finir les Ã©vÃ©nements
Ã©mis/consommÃ©s</label></li>
<li><label><input type="checkbox" />Ã‰crire les tests (unit +
integration)</label></li>
<li><label><input type="checkbox" />Amarrer via git subtree :
<code>./scripts/add-module.sh</code></label></li>
<li><label><input type="checkbox" />Mettre Ã  jour cette fiche
(08_modules-types.md)</label></li>
</ul>
<h3 id="pour-retirer-un-module">Pour retirer un module</h3>
<ul class="task-list">
<li><label><input type="checkbox" />VÃ©rifier quâ€™aucun module ne dÃ©pend
de lui (matrice de dÃ©pendances)</label></li>
<li><label><input type="checkbox" />DÃ©samarrer via
<code>./scripts/remove-module.sh</code></label></li>
<li><label><input type="checkbox" />Mettre Ã  jour la doc (supprimer de
cette fiche)</label></li>
</ul>
<h2 id="Ã -retenir-6">5. Ã€ retenir</h2>
<ul>
<li><strong>4 anneaux</strong> : Kernel (0), Core (1), Business (2),
IntÃ©grations (3)</li>
<li><strong>Modules Core</strong> : auth, audit, logger, notification
(transverses)</li>
<li><strong>Modules Business</strong> : dossiers, documents, workflow,
facturation (mÃ©tier)</li>
<li><strong>Modules IntÃ©grations</strong> : api-gateway, webhooks,
export, search (externe)</li>
<li><strong>Communication</strong> : event bus (pub/sub) + appels
directs via Meta-Kernel</li>
</ul>
<h2 id="liens-connexes-8">6. Liens connexes</h2>
<ul>
<li>[[01_architecture-orbitale]] : DÃ©tails des anneaux orbitaux</li>
<li>[[04_manifestes-lexorbital]] : Format des manifestes de modules</li>
<li>[[06_template-module]] : Template pour crÃ©er un nouveau module</li>
<li>[[07_workflow-subtree]] : Comment amarrer un module via git
subtree</li>
</ul>
<h1 id="fiche-9-console-de-controle">Fiche nÂ°9 : Console de contrÃ´le
&amp; design diÃ©gÃ©tique</h1>
<blockquote>
<p>La <strong>Console de ContrÃ´le LexOrbital</strong> est une interface
web immersive inspirÃ©e des stations spatiales, permettant de visualiser
lâ€™Ã©tat des modules, gÃ©rer les amarrages/dÃ©samarrages et auditer les flux
de donnÃ©es en temps rÃ©el.</p>
</blockquote>
<h2 id="objectif-de-la-fiche-9">1. Objectif de la fiche</h2>
<p>PrÃ©senter le design, lâ€™UX et les fonctionnalitÃ©s de la Console de
ContrÃ´le LexOrbital, avec focus sur le design diÃ©gÃ©tique (interface
narrative, cohÃ©rente avec la mÃ©taphore spatiale) et les outils de
monitoring/debug.</p>
<h2 id="concepts-et-dÃ©cisions-clÃ©s-7">2. Concepts et dÃ©cisions clÃ©s</h2>
<h3 id="quest-ce-que-le-design-diÃ©gÃ©tique">2.1. Quâ€™est-ce que le design
diÃ©gÃ©tique ?</h3>
<p><strong>DÃ©finition</strong> : Le design diÃ©gÃ©tique (du grec
<em>diÃ©gÃ¨sis</em>, â€œnarrationâ€) est une approche dâ€™interface oÃ¹ les
Ã©lÃ©ments UI sont <strong>intÃ©grÃ©s dans lâ€™univers narratif</strong> du
produit, plutÃ´t que dâ€™Ãªtre de simples widgets gÃ©nÃ©riques.</p>
<p><strong>Exemples cÃ©lÃ¨bres</strong> : - <em>Dead Space</em> : lâ€™UI
(vie, munitions) est affichÃ©e sur le personnage lui-mÃªme (pas de HUD
externe) - <em>Iron Man</em> : lâ€™interface holographique de Jarvis fait
partie de lâ€™univers technologique - <em>Star Citizen</em> : les consoles
de vaisseaux sont des objets 3D interactifs</p>
<h3 id="pourquoi-pour-lexorbital">2.2. Pourquoi pour LexOrbital ?</h3>
<h4 id="problÃ¨mes-des-dashboards-gÃ©nÃ©riques">ProblÃ¨mes des dashboards
gÃ©nÃ©riques</h4>
<ul>
<li>ğŸ¥± <strong>Ennuyeux</strong> : tableaux de bord Grafana/Kibana =
grilles de graphiques sans Ã¢me</li>
<li>ğŸ¤· <strong>DÃ©connectÃ©s</strong> : pas de lien narratif avec
lâ€™architecture (pourquoi des â€œmodulesâ€ ?)</li>
<li>ğŸ“Š <strong>SurchargÃ©s</strong> : trop dâ€™infos, difficile de voir
lâ€™essentiel dâ€™un coup dâ€™Å“il</li>
</ul>
<h4 id="avantages-du-design-diÃ©gÃ©tique">Avantages du design
diÃ©gÃ©tique</h4>
<ul>
<li>âœ¨ <strong>Engagement</strong> : lâ€™interface raconte une histoire
(vous pilotez une station orbitale)</li>
<li>ğŸ¯ <strong>ClartÃ©</strong> : la mÃ©taphore spatiale rend
lâ€™architecture comprÃ©hensible visuellement</li>
<li>ğŸš€ <strong>MÃ©morabilitÃ©</strong> : expÃ©rience marquante,
diffÃ©renciation forte</li>
</ul>
<h3 id="mÃ©taphore-console-de-station-orbitale">2.3. MÃ©taphore : Console
de station orbitale</h3>
<p>La Console LexOrbital sâ€™inspire des <strong>centres de contrÃ´le
NASA</strong> et des <strong>interfaces de science-fiction</strong>
(Interstellar, The Expanse).</p>
<h4 id="Ã©lÃ©ments-narratifs">Ã‰lÃ©ments narratifs</h4>
<ul>
<li><strong>Vue 3D de la station</strong> : visualisation des modules
amarrÃ©s aux anneaux</li>
<li><strong>Panneaux holographiques</strong> : widgets flottants avec
infos temps rÃ©el</li>
<li><strong>Alarmes et notifications</strong> : alertes
visuelles/sonores (comme dans une station)</li>
<li><strong>Logs dÃ©filants</strong> : console de commande style terminal
spatial</li>
<li><strong>Orbites animÃ©es</strong> : les modules gravitent autour du
Meta-Kernel</li>
</ul>
<h2 id="implications-techniques-6">3. Implications techniques</h2>
<h3 id="stack-technique-1">3.1. Stack technique</h3>
<table>
<colgroup>
<col style="width: 21%" />
<col style="width: 25%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th>Composant</th>
<th>Technologie</th>
<th>Justification</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Framework</strong></td>
<td>React + TypeScript</td>
<td>Standard frontend, typage fort</td>
</tr>
<tr>
<td><strong>3D Engine</strong></td>
<td>Three.js + React Three Fiber</td>
<td>Visualisation 3D des modules/orbites</td>
</tr>
<tr>
<td><strong>UI Components</strong></td>
<td>Tailwind CSS + shadcn/ui</td>
<td>Composants modernes, customisables</td>
</tr>
<tr>
<td><strong>Ã‰tat global</strong></td>
<td>Zustand</td>
<td>Plus simple que Redux, performant</td>
</tr>
<tr>
<td><strong>Temps rÃ©el</strong></td>
<td>WebSockets (Socket.io)</td>
<td>Mise Ã  jour live des statuts modules</td>
</tr>
<tr>
<td><strong>Graphiques</strong></td>
<td>Recharts + D3.js</td>
<td>Visualisations de donnÃ©es Ã©lÃ©gantes</td>
</tr>
<tr>
<td><strong>Animations</strong></td>
<td>Framer Motion</td>
<td>Animations fluides (transitions, micro-interactions)</td>
</tr>
</tbody>
</table>
<h3 id="architecture-de-la-console">3.2. Architecture de la Console</h3>
<pre><code>frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ Station3D/
â”‚   â”‚   â”‚   â”œâ”€â”€ Station3D.tsx           # Rendu 3D principal (Three.js)
â”‚   â”‚   â”‚   â”œâ”€â”€ Module3D.tsx            # ReprÃ©sentation 3D d&#39;un module
â”‚   â”‚   â”‚   â”œâ”€â”€ OrbitRing.tsx           # Anneaux orbitaux
â”‚   â”‚   â”‚   â””â”€â”€ Camera.tsx              # ContrÃ´les camÃ©ra
â”‚   â”‚   â”œâ”€â”€ Panels/
â”‚   â”‚   â”‚   â”œâ”€â”€ ModuleStatusPanel.tsx   # Ã‰tat d&#39;un module (health, logs)
â”‚   â”‚   â”‚   â”œâ”€â”€ EventLogPanel.tsx       # Flux d&#39;Ã©vÃ©nements temps rÃ©el
â”‚   â”‚   â”‚   â”œâ”€â”€ GDPRPanel.tsx           # Tableau de bord RGPD
â”‚   â”‚   â”‚   â””â”€â”€ PerformancePanel.tsx    # MÃ©triques (CPU, RAM, latence)
â”‚   â”‚   â”œâ”€â”€ Controls/
â”‚   â”‚   â”‚   â”œâ”€â”€ ModuleSelector.tsx      # SÃ©lection d&#39;un module
â”‚   â”‚   â”‚   â”œâ”€â”€ DockingControl.tsx      # Amarrage/dÃ©samarrage
â”‚   â”‚   â”‚   â””â”€â”€ CommandLine.tsx         # Console de commandes
â”‚   â”‚   â””â”€â”€ UI/
â”‚   â”‚       â”œâ”€â”€ HologramPanel.tsx       # Conteneur &quot;holographique&quot;
â”‚   â”‚       â”œâ”€â”€ Alert.tsx               # Alertes spatiales
â”‚   â”‚       â””â”€â”€ LoadingSpinner.tsx      # Animation chargement
â”‚   â”œâ”€â”€ stores/
â”‚   â”‚   â”œâ”€â”€ stationStore.ts             # Ã‰tat global de la station
â”‚   â”‚   â””â”€â”€ socketStore.ts              # Connexion WebSocket
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â”œâ”€â”€ useModules.ts               # RÃ©cupÃ©ration modules
â”‚   â”‚   â”œâ”€â”€ useEvents.ts                # Flux Ã©vÃ©nements temps rÃ©el
â”‚   â”‚   â””â”€â”€ useHealthChecks.ts          # Polling health checks
â”‚   â””â”€â”€ App.tsx
â””â”€â”€ public/
    â”œâ”€â”€ sounds/
    â”‚   â”œâ”€â”€ dock.mp3                    # Son d&#39;amarrage
    â”‚   â”œâ”€â”€ alert.mp3                   # Alerte
    â”‚   â””â”€â”€ ambient.mp3                 # Ambiance station
    â””â”€â”€ models/
        â””â”€â”€ station-module.glb          # ModÃ¨le 3D (optionnel)</code></pre>
<h3 id="vue-3d-de-la-station-three.js">3.3. Vue 3D de la station
(Three.js)</h3>
<h4 id="composant-principal-station3d.tsx">Composant principal
(<code>Station3D.tsx</code>)</h4>
<pre class="tsx"><code>import { Canvas } from &#39;@react-three/fiber&#39;;
import { OrbitControls, Stars } from &#39;@react-three/drei&#39;;
import { useModules } from &#39;@/hooks/useModules&#39;;
import Module3D from &#39;./Module3D&#39;;
import OrbitRing from &#39;./OrbitRing&#39;;

export default function Station3D() {
  const { modules } = useModules();

  return (
    &lt;Canvas camera={{ position: [0, 0, 50], fov: 60 }}&gt;
      {/* Fond Ã©toilÃ© */}
      &lt;Stars radius={300} depth={60} count={5000} factor={7} /&gt;

      {/* LumiÃ¨res */}
      &lt;ambientLight intensity={0.3} /&gt;
      &lt;pointLight position={[0, 0, 0]} intensity={1.5} color=&quot;#4a9eff&quot; /&gt;

      {/* Meta-Kernel (sphÃ¨re centrale) */}
      &lt;mesh position={[0, 0, 0]}&gt;
        &lt;sphereGeometry args={[2, 32, 32]} /&gt;
        &lt;meshStandardMaterial 
          color=&quot;#2563eb&quot; 
          emissive=&quot;#1d4ed8&quot; 
          emissiveIntensity={0.5} 
        /&gt;
      &lt;/mesh&gt;

      {/* Anneaux orbitaux */}
      &lt;OrbitRing radius={8} orbit={0} /&gt;
      &lt;OrbitRing radius={15} orbit={1} /&gt;
      &lt;OrbitRing radius={25} orbit={2} /&gt;
      &lt;OrbitRing radius={35} orbit={3} /&gt;

      {/* Modules (positionnÃ©s sur les anneaux) */}
      {modules.map((module, index) =&gt; (
        &lt;Module3D 
          key={module.name} 
          module={module} 
          angle={(index / modules.length) * Math.PI * 2}
        /&gt;
      ))}

      {/* ContrÃ´les camÃ©ra (rotation, zoom) */}
      &lt;OrbitControls 
        enableDamping 
        dampingFactor={0.05}
        minDistance={20}
        maxDistance={80}
      /&gt;
    &lt;/Canvas&gt;
  );
}</code></pre>
<h4 id="composant-module3d">Composant Module3D</h4>
<pre class="tsx"><code>import { useRef, useState } from &#39;react&#39;;
import { useFrame } from &#39;@react-three/fiber&#39;;
import { Module } from &#39;@/types&#39;;

interface Module3DProps {
  module: Module;
  angle: number;
}

export default function Module3D({ module, angle }: Module3DProps) {
  const meshRef = useRef&lt;THREE.Mesh&gt;(null);
  const [hovered, setHovered] = useState(false);

  // Animation : rotation autour du Meta-Kernel
  useFrame((state) =&gt; {
    if (meshRef.current) {
      const radius = module.orbit * 10;
      const speed = 0.0001 * (4 - module.orbit); // Plus proche = plus rapide
      const time = state.clock.elapsedTime;
      
      meshRef.current.position.x = Math.cos(angle + time * speed) * radius;
      meshRef.current.position.z = Math.sin(angle + time * speed) * radius;
      
      // Rotation du module sur lui-mÃªme
      meshRef.current.rotation.y += 0.01;
    }
  });

  // Couleur selon le statut (healthy, warning, error)
  const color = module.health === &#39;healthy&#39; ? &#39;#10b981&#39; : 
                module.health === &#39;warning&#39; ? &#39;#f59e0b&#39; : &#39;#ef4444&#39;;

  return (
    &lt;mesh
      ref={meshRef}
      onPointerOver={() =&gt; setHovered(true)}
      onPointerOut={() =&gt; setHovered(false)}
      scale={hovered ? 1.2 : 1}
    &gt;
      &lt;boxGeometry args={[1.5, 1.5, 1.5]} /&gt;
      &lt;meshStandardMaterial 
        color={color} 
        emissive={color} 
        emissiveIntensity={hovered ? 0.8 : 0.3} 
      /&gt;
    &lt;/mesh&gt;
  );
}</code></pre>
<h3 id="panneaux-holographiques-hud">3.4. Panneaux holographiques
(HUD)</h3>
<h4 id="composant-hologrampanel">Composant HologramPanel</h4>
<pre class="tsx"><code>import { motion } from &#39;framer-motion&#39;;
import { ReactNode } from &#39;react&#39;;

interface HologramPanelProps {
  title: string;
  children: ReactNode;
  position?: &#39;top-left&#39; | &#39;top-right&#39; | &#39;bottom-left&#39; | &#39;bottom-right&#39;;
}

export default function HologramPanel({ title, children, position = &#39;top-left&#39; }: HologramPanelProps) {
  const positionClasses = {
    &#39;top-left&#39;: &#39;top-4 left-4&#39;,
    &#39;top-right&#39;: &#39;top-4 right-4&#39;,
    &#39;bottom-left&#39;: &#39;bottom-4 left-4&#39;,
    &#39;bottom-right&#39;: &#39;bottom-4 right-4&#39;,
  };

  return (
    &lt;motion.div
      className={`absolute ${positionClasses[position]} w-96 bg-slate-900/80 backdrop-blur-md border-2 border-cyan-500/50 rounded-lg p-4 shadow-2xl`}
      initial={{ opacity: 0, y: -20 }}
      animate={{ opacity: 1, y: 0 }}
      transition={{ duration: 0.5 }}
    &gt;
      &lt;div className=&quot;flex items-center gap-2 mb-3 pb-2 border-b border-cyan-500/30&quot;&gt;
        &lt;div className=&quot;w-2 h-2 bg-cyan-400 rounded-full animate-pulse&quot; /&gt;
        &lt;h3 className=&quot;text-cyan-300 font-mono text-sm tracking-wider uppercase&quot;&gt;
          {title}
        &lt;/h3&gt;
      &lt;/div&gt;
      &lt;div className=&quot;text-slate-200 text-sm font-mono&quot;&gt;
        {children}
      &lt;/div&gt;
    &lt;/motion.div&gt;
  );
}</code></pre>
<h4 id="utilisation">Utilisation</h4>
<pre class="tsx"><code>&lt;HologramPanel title=&quot;Module Status&quot; position=&quot;top-right&quot;&gt;
  &lt;div className=&quot;space-y-2&quot;&gt;
    &lt;div className=&quot;flex justify-between&quot;&gt;
      &lt;span&gt;Health:&lt;/span&gt;
      &lt;span className=&quot;text-green-400&quot;&gt;OPERATIONAL&lt;/span&gt;
    &lt;/div&gt;
    &lt;div className=&quot;flex justify-between&quot;&gt;
      &lt;span&gt;Uptime:&lt;/span&gt;
      &lt;span&gt;42h 17m&lt;/span&gt;
    &lt;/div&gt;
    &lt;div className=&quot;flex justify-between&quot;&gt;
      &lt;span&gt;CPU:&lt;/span&gt;
      &lt;span&gt;23%&lt;/span&gt;
    &lt;/div&gt;
  &lt;/div&gt;
&lt;/HologramPanel&gt;</code></pre>
<h3 id="flux-dÃ©vÃ©nements-temps-rÃ©el-websocket">3.5. Flux dâ€™Ã©vÃ©nements
temps rÃ©el (WebSocket)</h3>
<h4 id="hook-useevents">Hook <code>useEvents</code></h4>
<pre class="tsx"><code>import { useEffect, useState } from &#39;react&#39;;
import { io } from &#39;socket.io-client&#39;;

interface Event {
  id: string;
  timestamp: string;
  module: string;
  type: string;
  message: string;
}

export function useEvents() {
  const [events, setEvents] = useState&lt;Event[]&gt;([]);

  useEffect(() =&gt; {
    const socket = io(&#39;ws://localhost:3000&#39;);

    socket.on(&#39;event&#39;, (event: Event) =&gt; {
      setEvents(prev =&gt; [event, ...prev].slice(0, 100)); // Garder 100 derniers
    });

    return () =&gt; {
      socket.disconnect();
    };
  }, []);

  return { events };
}</code></pre>
<h4 id="composant-eventlogpanel">Composant EventLogPanel</h4>
<pre class="tsx"><code>import { useEvents } from &#39;@/hooks/useEvents&#39;;
import HologramPanel from &#39;@/components/UI/HologramPanel&#39;;

export default function EventLogPanel() {
  const { events } = useEvents();

  return (
    &lt;HologramPanel title=&quot;Event Log&quot; position=&quot;bottom-left&quot;&gt;
      &lt;div className=&quot;h-64 overflow-y-auto space-y-1 text-xs&quot;&gt;
        {events.map(event =&gt; (
          &lt;div key={event.id} className=&quot;flex gap-2 hover:bg-cyan-500/10 p-1 rounded&quot;&gt;
            &lt;span className=&quot;text-slate-500&quot;&gt;
              {new Date(event.timestamp).toLocaleTimeString()}
            &lt;/span&gt;
            &lt;span className=&quot;text-cyan-400&quot;&gt;[{event.module}]&lt;/span&gt;
            &lt;span className=&quot;text-slate-300&quot;&gt;{event.message}&lt;/span&gt;
          &lt;/div&gt;
        ))}
      &lt;/div&gt;
    &lt;/HologramPanel&gt;
  );
}</code></pre>
<h3 id="effets-sonores-immersion">3.6. Effets sonores (immersion)</h3>
<pre class="tsx"><code>// hooks/useSoundEffects.ts
import { useRef } from &#39;react&#39;;

export function useSoundEffects() {
  const dockSound = useRef(new Audio(&#39;/sounds/dock.mp3&#39;));
  const alertSound = useRef(new Audio(&#39;/sounds/alert.mp3&#39;));

  const playDock = () =&gt; dockSound.current.play();
  const playAlert = () =&gt; alertSound.current.play();

  return { playDock, playAlert };
}</code></pre>
<p>Usage lors dâ€™un amarrage :</p>
<pre class="tsx"><code>const { playDock } = useSoundEffects();

async function dockModule(moduleName: string) {
  await api.post(&#39;/modules/dock&#39;, { name: moduleName });
  playDock(); // Son d&#39;amarrage
}</code></pre>
<h2 id="checklist-de-mise-en-Å“uvre-7">4. Checklist de mise en Å“uvre</h2>
<h3 id="phase-1-fondations">Phase 1 : Fondations</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Setup React + TypeScript +
Vite</label></li>
<li><label><input type="checkbox" />Installer Three.js + React Three
Fiber</label></li>
<li><label><input type="checkbox" />CrÃ©er la scÃ¨ne 3D de base
(Meta-Kernel + anneaux)</label></li>
<li><label><input type="checkbox" />ImplÃ©menter les composants
<code>HologramPanel</code> et <code>Module3D</code></label></li>
</ul>
<h3 id="phase-2-fonctionnalitÃ©s">Phase 2 : FonctionnalitÃ©s</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Connexion WebSocket pour Ã©vÃ©nements
temps rÃ©el</label></li>
<li><label><input type="checkbox" />Panel de statut des modules (health,
uptime, CPU)</label></li>
<li><label><input type="checkbox" />Panel de logs dÃ©filants
(EventLogPanel)</label></li>
<li><label><input type="checkbox" />Panel RGPD (registre,
audits)</label></li>
<li><label><input type="checkbox" />ContrÃ´les
dâ€™amarrage/dÃ©samarrage</label></li>
</ul>
<h3 id="phase-3-polish-ux">Phase 3 : Polish &amp; UX</h3>
<ul class="task-list">
<li><label><input type="checkbox" />Ajouter les effets sonores
(amarrage, alertes)</label></li>
<li><label><input type="checkbox" />Animations Framer Motion
(transitions fluides)</label></li>
<li><label><input type="checkbox" />Responsive design (fonctionnel sur
tablette)</label></li>
<li><label><input type="checkbox" />Mode sombre/clair (optionnel, thÃ¨me
spatial par dÃ©faut)</label></li>
<li><label><input type="checkbox" />Documentation utilisateur (tooltips,
tour guidÃ©)</label></li>
</ul>
<h2 id="Ã -retenir-7">5. Ã€ retenir</h2>
<ul>
<li><strong>Design diÃ©gÃ©tique</strong> : lâ€™UI raconte lâ€™histoire de la
station orbitale</li>
<li><strong>Vue 3D</strong> : Three.js pour visualiser les modules en
orbite</li>
<li><strong>Panneaux holographiques</strong> : style futuriste avec
bordures cyan + backdrop blur</li>
<li><strong>Temps rÃ©el</strong> : WebSocket pour flux dâ€™Ã©vÃ©nements
live</li>
<li><strong>Effets sonores</strong> : amarrages, alertes
(immersion)</li>
<li><strong>Stack</strong> : React + Three.js + Framer Motion +
Tailwind</li>
</ul>
<h2 id="liens-connexes-9">6. Liens connexes</h2>
<ul>
<li>[[01_architecture-orbitale]] : Comprendre les anneaux et modules Ã 
visualiser</li>
<li>[[08_modules-types]] : Catalogue des modules Ã  afficher dans la
console</li>
<li>[[03_documentation-et-diagrammes-vivants]] : Diagrammes
complÃ©mentaires</li>
</ul>
</main>

<footer class="lexorbital-footer">
  <div class="footer-content">
    <p>
      <strong>LexOrbital</strong> â€“ Station orbitale d'architecture logicielle
    </p>
    <p>
      Documentation gÃ©nÃ©rÃ©e avec <a href="https://pandoc.org">Pandoc</a>
    </p>
    <p class="footer-license">
      Licence MIT â€¢ Version 1.0.0 â€¢ 2025
    </p>
  </div>
</footer>


<script>
// Smooth scroll pour les ancres
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener('click', function (e) {
    e.preventDefault();
    const target = document.querySelector(this.getAttribute('href'));
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
});

// Animation du logo (rotation subtile)
const logo = document.querySelector('.logo svg');
if (logo) {
  let rotation = 0;
  setInterval(() => {
    rotation += 0.5;
    logo.style.transform = `rotate(deg)`;
  }, 50);
}
</script>

</body>
</html>

